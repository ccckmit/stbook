<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="陳鍾誠" />
  <title>機率統計 -- 使用 R 軟體</title>
  <style type="text/css">code{white-space: pre;}</style>
  <style type="text/css">
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; }
code > span.dt { color: #902000; }
code > span.dv { color: #40a070; }
code > span.bn { color: #40a070; }
code > span.fl { color: #40a070; }
code > span.ch { color: #4070a0; }
code > span.st { color: #4070a0; }
code > span.co { color: #60a0b0; font-style: italic; }
code > span.ot { color: #007020; }
code > span.al { color: #ff0000; font-weight: bold; }
code > span.fu { color: #06287e; }
code > span.er { color: #ff0000; font-weight: bold; }
  </style>
  <link rel="stylesheet" href="../css/book.css" type="text/css" />
</head>
<body>
<div id="header_wrap">
  <h1><a href="book.html">機率統計-使用 R 軟體實作</a></h1>
  <table id="bar" border="0" style="border:0;"><tr style="border:0;">
    <td style="text-align:left;border:0;"> <a href="book.html">目錄</a> | <a href="download.html">下載</a> | <a href="course.html">課程</a> | <a href="forum.html">討論</a> | <a href="exam.html">測驗</a></td>
    <td style="text-align:right;border:0;"><a href="http://ccckmit.wikidot.com/">陳鍾誠</a> 於 <a href="http://www.nqu.edu.tw/">金門大學</a></td>
  </tr></table>
</div>
<div id="content">
<div id="header">
<h1 class="title">機率統計 -- 使用 R 軟體</h1>
<h2 class="author">陳鍾誠</h2>
<h3 class="date">2013 年 3 月</h3>
</div>
<div id="TOC">
<ul>
<li><a href="#前言">前言</a><ul>
<li><a href="#序">序</a></li>
<li><a href="#授權聲明">授權聲明</a></li>
</ul></li>
<li><a href="#機率與統計">機率與統計</a><ul>
<li><a href="#簡介">簡介</a></li>
<li><a href="#機率理論">機率理論</a></li>
<li><a href="#統計理論">統計理論</a></li>
<li><a href="#應用">應用</a></li>
<li><a href="#r-軟體實作簡介與基本操作">R 軟體實作：簡介與基本操作</a></li>
<li><a href="#參考文獻">參考文獻</a></li>
</ul></li>
<li><a href="#機率的概念">機率的概念</a><ul>
<li><a href="#樣本空間">樣本空間</a></li>
<li><a href="#事件">事件</a></li>
<li><a href="#機率的詮釋方法">機率的詮釋方法</a></li>
<li><a href="#機率公理">機率公理</a></li>
<li><a href="#機率模型">機率模型</a></li>
<li><a href="#條件機率">條件機率</a></li>
<li><a href="#獨立事件">獨立事件</a></li>
<li><a href="#貝氏定理">貝氏定理</a></li>
<li><a href="#條件獨立">條件獨立</a></li>
<li><a href="#習題牙疼的診斷問題">習題：牙疼的診斷問題</a></li>
</ul></li>
<li><a href="#隨機變數">隨機變數</a><ul>
<li><a href="#隨機變數簡介">隨機變數簡介</a></li>
<li><a href="#離散與連續">離散與連續</a></li>
<li><a href="#機率密度函數-probabilistic-density-function">機率密度函數 (Probabilistic Density Function)</a></li>
<li><a href="#累加分配函數-cumulative-distribution-function">累加分配函數 (Cumulative Distribution Function)</a></li>
<li><a href="#隨機變數的代數運算">隨機變數的代數運算</a></li>
<li><a href="#結語">結語</a></li>
</ul></li>
<li><a href="#機率分布">機率分布</a><ul>
<li><a href="#簡介-2">簡介</a></li>
<li><a href="#伯努力試驗-bernoulli-trial">伯努力試驗 (Bernoulli trial)</a></li>
<li><a href="#二項分布-binomial-distribution">二項分布 (Binomial distribution)</a></li>
<li><a href="#幾何分布-geometric-distribution">幾何分布 (Geometric distribution)</a></li>
<li><a href="#負二項分布">負二項分布</a></li>
<li><a href="#布瓦松分布-poisson-distribution">布瓦松分布 (Poisson distribution)</a></li>
<li><a href="#均勻分布-uniform-distribution">均勻分布 (Uniform distribution)</a></li>
<li><a href="#常態分布-normal-distribution">常態分布 (Normal Distribution)</a></li>
<li><a href="#附件離散型機率分布表格整理">附件：離散型機率分布表格整理</a></li>
<li><a href="#附件連續型機率分布表格整理">附件：連續型機率分布表格整理</a></li>
</ul></li>
<li><a href="#期望值與動差生成函數">期望值與動差生成函數</a><ul>
<li><a href="#期望值">期望值</a></li>
<li><a href="#變異數">變異數</a></li>
<li><a href="#期望值的函數">期望值的函數</a></li>
<li><a href="#k-階動差-kth-ordinary-moment">k 階動差 (Kth Ordinary Moment)</a></li>
<li><a href="#動差生成函數">動差生成函數</a></li>
<li><a href="#結語-1">結語</a></li>
</ul></li>
<li><a href="#聯合分布">聯合分布</a><ul>
<li><a href="#聯合密度函數">聯合密度函數</a></li>
<li><a href="#邊際密度函數">邊際密度函數</a></li>
<li><a href="#聯合分配的期望值">聯合分配的期望值</a></li>
<li><a href="#共變異數-covariance-協方差">共變異數 (Covariance, 協方差)</a></li>
<li><a href="#相關係數-correlation">相關係數 (Correlation)</a></li>
<li><a href="#多變數聯合分布的情況">多變數聯合分布的情況</a></li>
<li><a href="#結語-2">結語</a></li>
</ul></li>
<li><a href="#抽樣與敘述統計">抽樣與敘述統計</a><ul>
<li><a href="#隨機抽樣">隨機抽樣</a></li>
<li><a href="#單組樣本的敘述統計">單組樣本的敘述統計</a></li>
<li><a href="#繪製統計圖">繪製統計圖</a></li>
<li><a href="#共變異數兩組樣本的相關度統計">共變異數、兩組樣本的相關度統計</a></li>
</ul></li>
<li><a href="#中央極限定理">中央極限定理</a><ul>
<li><a href="#大數法則">大數法則</a></li>
<li><a href="#柴比雪夫不等式">柴比雪夫不等式</a></li>
<li><a href="#中央極限定理簡介">中央極限定理簡介</a></li>
<li><a href="#中央極限定理的用途">中央極限定理的用途</a></li>
<li><a href="#r-程式範例驗證中央極限定理">R 程式範例：驗證中央極限定理</a></li>
<li><a href="#結語-3">結語</a></li>
<li><a href="#參考文獻-1">參考文獻</a></li>
</ul></li>
<li><a href="#平均值的估計與檢定">平均值的估計與檢定</a><ul>
<li><a href="#信賴區間">信賴區間</a></li>
<li><a href="#常態分布的信賴區間">常態分布的信賴區間</a></li>
<li><a href="#平均值的信賴區間">平均值的信賴區間</a></li>
<li><a href="#t-分佈與平均值的檢定">T 分佈與平均值的檢定</a></li>
<li><a href="#檢定的概念">檢定的概念</a></li>
<li><a href="#檢定的圖形">檢定的圖形</a></li>
<li><a href="#習題-4">習題</a></li>
<li><a href="#參考文獻-2">參考文獻</a></li>
</ul></li>
<li><a href="#再論估計與檢定">再論估計與檢定</a><ul>
<li><a href="#檢定的分類">檢定的分類</a></li>
<li><a href="#右尾檢定左尾檢定與雙尾檢定">右尾檢定、左尾檢定與雙尾檢定</a></li>
<li><a href="#比例-p-的檢定">比例 p 的檢定</a></li>
<li><a href="#中位數-m-的檢定">中位數 M 的檢定</a></li>
<li><a href="#兩組樣本的平均值檢定">兩組樣本的平均值檢定</a></li>
<li><a href="#變異數服從甚麼分布">變異數服從甚麼分布？</a></li>
<li><a href="#兩組樣本的變異數檢定">兩組樣本的變異數檢定</a></li>
<li><a href="#兩組樣本的比例檢定">兩組樣本的比例檢定</a></li>
<li><a href="#兩組樣本的中位數檢定">兩組樣本的中位數檢定</a></li>
<li><a href="#結語-4">結語</a></li>
<li><a href="#參考文獻-3">參考文獻</a></li>
</ul></li>
<li><a href="#變異數分析-anova">變異數分析 (ANOVA)</a><ul>
<li><a href="#簡介-3">簡介</a></li>
<li><a href="#檢定兩樣本群的平均值是否相同">檢定兩樣本群的平均值是否相同</a></li>
<li><a href="#變異數分析-analysis-of-variance-anova">變異數分析 (Analysis of Variance, ANOVA)</a></li>
<li><a href="#兩兩之間的均值比較">兩兩之間的均值比較</a></li>
<li><a href="#結語-5">結語</a></li>
<li><a href="#參考文獻-4">參考文獻</a></li>
</ul></li>
<li><a href="#迴歸分析">迴歸分析</a><ul>
<li><a href="#簡介-4">簡介</a></li>
<li><a href="#r-軟體中的-lm-函數">R 軟體中的 lm() 函數</a></li>
<li><a href="#單一自變數的迴歸分析完全線性無誤差值">單一自變數的迴歸分析：完全線性，無誤差值</a></li>
<li><a href="#單一自變數的迴歸分析有誤差值">單一自變數的迴歸分析：有誤差值</a></li>
<li><a href="#數學原理">數學原理</a></li>
<li><a href="#兩組自變數的迴歸分析完全線性無誤差值">兩組自變數的迴歸分析：完全線性，無誤差值</a></li>
<li><a href="#兩組自變數的迴歸分析有誤差值">兩組自變數的迴歸分析：有誤差值</a></li>
<li><a href="#結語-6">結語</a></li>
<li><a href="#參考文獻-5">參考文獻</a></li>
</ul></li>
<li><a href="#主成分分析與因子分析">主成分分析與因子分析</a><ul>
<li><a href="#簡介-5">簡介</a></li>
<li><a href="#主成分分析範例-1-rank2">主成分分析範例 1 (Rank=2)</a></li>
<li><a href="#主成分分析範例-2-rank3">主成分分析範例 2 (Rank=3)</a></li>
<li><a href="#主成分分析範例-3-rank3-加上隨機誤差">主成分分析範例 3 (Rank=3 加上隨機誤差)</a></li>
<li><a href="#因子分析">因子分析</a></li>
<li><a href="#結語-7">結語</a></li>
<li><a href="#參考文獻-6">參考文獻</a></li>
</ul></li>
<li><a href="#附錄-a常見的機率分布">附錄 A：常見的機率分布</a><ul>
<li><a href="#二項分布-binomial-distribution-1">二項分布 (Binomial distribution)</a></li>
<li><a href="#負二項分布-netative-binomial-distribution">負二項分布 (Netative binomial distribution)</a></li>
<li><a href="#幾何分布-geometric-distribution-1">幾何分布 (Geometric distribution)</a></li>
<li><a href="#超幾何分布-hypergeometric-distribution">超幾何分布 (Hypergeometric distribution)</a></li>
<li><a href="#布瓦松分布-poisson-distribution-1">布瓦松分布 (Poisson distribution)</a></li>
<li><a href="#均勻分布-uniform-distribution-1">均勻分布 (Uniform distribution)</a></li>
<li><a href="#常態分布-normal-distribution-1">常態分布 (Normal Distribution)</a></li>
</ul></li>
</ul>
</div>
<h1 id="前言"><a href="#前言">前言</a></h1>
<h2 id="序"><a href="#序">序</a></h2>
<p>機率統計是「自然科學」與「社會科學」都共同需要的數學語言，傳統上許多學校都會採用商用的 SPSS 或 SAS 等軟體作為課程實作的工具。但是這些軟體都是商用軟體，學生在家中很難合法安裝。</p>
<p>事實上，開放原始碼領域的「R軟體」比起 SPSS 或 SAS 毫不遜色，而且具有相當多的開放資源，已經成為學習機率統計的重要工具。在本書中，我們將使用 「R 軟體」進行機率統計的實作，讓學習者能以「實作印證理論」，加深學習的效果。</p>
<p>R 軟體當中預設就包含了各式各樣的機率模型，以及各種統計工具，可以讓讀者一邊學習，一邊用簡單的指令進行機率統計的實驗。透過這種學習方式，讀者可以透過程式實際體會理論的意義。舉例而言，當我們看到常態分配的機率模型時，我們可以直接使用下列指令來畫出常態分布，並且用程式產生符合常態分布模型的樣本，以便進行某種互動式的學習，用實驗體會常態分布的意義。</p>
<p>我很喜歡用武俠小說中的「氣宗與劍宗」與學術中的「理論與實務」相對比。氣宗的人一開始就學習一堆理論，直到內力充足以後才慢慢了解實務操作；而劍宗的人則是直接拿起劍就找人比試，在不了解理論的情況下直接出招，一開始進步很快，但到後來就會發現內功不夠深厚，遇到高手時總要吃虧的。</p>
<p>雖然我的求學過程比較像是氣宗的教育方式，但是最後寫出來的書卻往往像是劍宗的教材，或許這就是一種內心矛盾的反射，因為理論念得多了，就發現自己在實務上一竅不通，所以寫出來之後往往從實務出發，最後才回到理論進行印證。</p>
<p>在本書中，我們將採用「理論=&gt;實務=&gt;理論=&gt;實務...」的循環，交替的說明原理與實務，我們會先給大家看一大堆「圖片」、「影片」甚至是「程式」，然後再回過頭來講解原理，透過這種方式，希望大家都能達到「氣劍合一」的境界。</p>
<p>陳鍾誠 2012/10/23 於 金門大學 資訊工程系</p>
<h2 id="授權聲明"><a href="#授權聲明">授權聲明</a></h2>
<p>本書由 <a href="http://ccckmit.wikidot.com/">金門大學</a> 創建，期中部分內容與圖片來自 <a href="http://zh.wikipedia.org">維基百科</a>，因此採用 <a href="http://creativecommons.org/licenses/by-sa/3.0/tw/">創作共用：姓名標示、相同方式分享</a> 之授權。</p>
<p>若您想要修改本書產生衍生著作時，至少應該遵守下列授權條件：</p>
<ol style="list-style-type: decimal">
<li>標示原作者姓名為 <a href="http://ccckmit.wikidot.com/">陳鍾誠</a> 衍生自 <a href="http://zh.wikipedia.org">維基百科</a> 的作品。</li>
<li>採用 <a href="http://creativecommons.org/licenses/by-sa/3.0/tw/">創作共用：姓名標示、相同方式分享</a> 的方式公開衍生著作。</li>
</ol>
<h1 id="機率與統計"><a href="#機率與統計">機率與統計</a></h1>
<h2 id="簡介"><a href="#簡介">簡介</a></h2>
<p>在現實的生活當中，有許多我們無法準確描述的現象，這些現象的出現包含了某種程度的隨機性。舉例而言，我們無法精確的預知明天是否會下雨、股票會漲或者會跌、匯率會如何波動，人會不會生病等等。</p>
<p>但是當這些現象出現的總體量很多的時候，我們就可以「統計」出該事件發生的「機率」，於是我們的天氣預報可以預測明天下雨的機率、我們也可以統計出股票漲跌的機率、人們生病的機率、或者某人買了一張彩券後中獎的機率等等。</p>
<p>因此，機率與統計可以說是一體的兩面，當我們知道某個基本事件的先驗機率1時，我們可以根據此一機率計算某個組合事件發生的機率。例如我們可以知道兩顆公平的骰子同時出現 6 點的機率是 1/36 ，而連續投擲公平的銅版五次，每次都是正面的機率為 1/32等。</p>
<p>但是當我們不知道基本事件的發生機率時，我們該怎麼辦呢？此時統計的價值就顯現出來了，我們可以先進行很多次的實驗，以便透過計算的方式算出某個「事件」的機率，這種統計方法就稱為「敘述統計」。接著我們可以根據這個統計的結果，推論出某些衍生事件的機率，或者推算出此一事件是否「可信」，這樣的統計就稱為「推論統計」。</p>
<p>如果用更數學化的語言來說，我們可以透過已知的「母體模型」，以及某些「母體參數」計算某個事件的機率，或者用電腦隨機產生這些事件。這種用參數與模型產生隨機事件的過程，可以用電腦的方是透過程式模擬產生，此時電腦其實是以機率的角度在模擬母體的運作方式，這樣的電腦模擬方法稱為「蒙地卡羅法」。</p>
<p>但是如果我們是在是先取得一群樣本之後，開始計算樣本的某個統計量是多少，這種計算就稱為「敘述統計」。如果我們進一步透過「敘述統計」的「統計量」去推估「母體的某個參數值應該是多少？」，這樣的推估方法就稱為「推論統計」。</p>
<p>下圖顯示了「母體、參數、樣本與統計量」之間的關係。</p>
<div class="figure">
<img src="../img/ProbAndStatistics.png" alt="機率與統計之關係" /><p class="caption">機率與統計之關係</p>
</div>
<p>如果我們精確知道母體的機率模型與參數，我們就完全掌握了母體的機率分布，這就是從機率角度的看法。但是在很多情況下我們無法清楚的知道母體的模型與參數，此時我們就可以採用「抽樣的方式」，從母體中取得或觀察到某些「樣本」，再透過這些樣本去計算出某些「敘述統計量」，接著再用這些統計量去推估母體的參數。</p>
<h2 id="機率理論"><a href="#機率理論">機率理論</a></h2>
<p>舉例而言，假如我們已經某個銅版是公平的，也就是兩面的機率都是 1/2 ，那麼我們就可以直接透過「機率法則」計算某個序列，例如連續五次都投出正面的機率為 <img src="../timg/2ccbafe5cc8a.jpg" /> 。</p>
<p>但是如果我們不知到銅版「正反面的機率」，那麼我們就必須改用「統計的方法」，例如連續投擲該銅版一千次，然後計算「正面與反面各為多少次」，接著再透過這些「正反面次數的統計量」，去推估某事件的出現機率。</p>
<p>假如我們投擲該銅版一千次的結果，發現正面出現 508 次，反面出現 492 次，那麼我們就可以推估「正面的機率為 0.508」，而「反面出現的機率為 0.492」，接著再去推估連續出現五次正面的機率為 <img src="../timg/c2a23b13d83a.jpg" /> 。</p>
<p>當然，機率的模型並不是都像擲骰子或銅版那樣簡單的，有時機率模型本身就有點困難。舉例而言，布瓦松 (Poisson) 分布是用來描述「一段連續時間內」某個隨機事件發生的次數，其離散機率密度函數如下所示。</p>
<div class="figure">
<img src="../timg/61b487bb9f31.jpg" />
</div>
<p>如果沒有學過機率的話，相信一般人很難看懂該機率分布的意義。因此在本書的後序章節中，我們將會先介紹機率的法則與模型，以便讓讀者能先對這些機率模型所代表的意義有清楚的認識，然後再進入「敘述統計」與「推論統計」的數學世界，希望透過這樣的方法，讀者能更清楚的理解整個機率統計的數學理論，並且能用 R 程式的實作來印證這些理論。</p>
<h2 id="統計理論"><a href="#統計理論">統計理論</a></h2>
<p>同樣的，統計理論也不只是算算出現次數這麼簡單的。舉例而言，當我們想知道某一組統計量是否「合理」時，我們會採用「信賴區間」的方式描述該組統計量的合理的母體參數範圍，以下是一個範例。</p>
<p>請計算出以下列樣本序列的「平均值之 95% 信賴區間」：</p>
<pre><code>3.6146570 4.1440593 2.5726955 5.2325581 2.0635500 
2.6294660 2.8541827 2.4816312 1.5836851 3.2193062 
2.8205306 3.5037204 2.6107131 4.1870588 2.4506509 
2.4849244 4.5343839 0.7606934 3.5219675 1.7019120</code></pre>
<p>這樣的計算顯然不是簡單的「計算出現次數」而已。要能進行「信賴區間」的計算，顯然我們必須學習更多的數學理論，才能知道如何計算，也才能清楚的掌握計算結果的意義。</p>
<h2 id="應用"><a href="#應用">應用</a></h2>
<p>機率統計的應用涵蓋面非常的廣，從社會科學到自然科學都會用到，這是一門有著極強實用性的數學，很少數學像機率統計一樣有著如此強大的實用性。</p>
<p>在社會科學當中，我們會用機率統計來檢驗某個抽樣調查是否可信，某個抽樣調查顯示了何種意義等等？甚至像是社會科學領域的經典，塗爾幹的自殺論當中，即是採用機率統計的方法檢驗哪些因子會造成自殺現象的增加或減少等等，這些都是機率統計在社會科學上很明顯的應用案例。</p>
<p>在自然科學當中，學習生物或醫學的研究者也會透過機率統計來計算並研究某個藥物是否對特定疾病具有療效，或者某個檢測結果是否顯示該病人已經得到某種疾病。而學習電腦的程式設計者則可以透過機率統計模型進行「蒙地卡羅式的隨機模擬」，以便計算某個現象的機率。或者透過像「貝氏網路」這樣的機率模型以進行事件的機率計算，甚至是透過像「隱馬可夫鏈算法」(Hidden Markov Model) 或 EM 學習法 (Expectation-Maximization Algorithm) 等方法來學習某個機率模型與參數，以便讓程式能根據輸入樣本得到預測某些事件的能力。這些都是機率統計在自然科學上典型的應用案例。</p>
<h2 id="r-軟體實作簡介與基本操作"><a href="#r-軟體實作簡介與基本操作">R 軟體實作：簡介與基本操作</a></h2>
<h3 id="簡介-1"><a href="#簡介-1">簡介</a></h3>
<p>R 軟體是專門為了機率統計而設計的一種開放原始碼軟體，是免費的自由軟體。</p>
<p>市面上有許多與 R 類似的商用軟體，像是 SPSS, SAS, MINITAB, S-PLUS 等，但是這些軟體是要花錢買的。</p>
<p>R 軟體所使用的程式語言，被稱為 R 語言。</p>
<p>R 語言 與 S-PLUS 所使用的語言很類似，兩者都衍生自貝爾實驗室 Rick Becker, Allan Wilks, John Chambers 所創造的 S 語言，R 語言基本上是 GNU 所實作的 S 語言版本。</p>
<p>筆者篆寫此文時，R 所採用的 S 語言演化到了第四版，因此稱為 S4。</p>
<h3 id="安裝"><a href="#安裝">安裝</a></h3>
<p>R 軟體的官方網站為 <a href="http://www.r-project.org/">http://www.r-project.org/</a> ，其中有個相當重要的子網站稱為 CRAN (Comprehensive R Archive Network)，其網址為 <a href="http://cran.r-project.org/">http://cran.r-project.org/</a> ，您可以從這個網站中下載 R 軟體。</p>
<p>舉例而言，筆者使用的是 Windows作業系統，因此可以從以下網址下載到最新版的 R 軟體。</p>
<ul>
<li><a href="http://cran.r-project.org/bin/windows/base/">http://cran.r-project.org/bin/windows/base/</a></li>
</ul>
<div class="figure">
<img src="../img/R_download_page.jpg" alt="R 軟體下載頁面" /><p class="caption">R 軟體下載頁面</p>
</div>
<p>舉例而言，筆者點選時為 Download R 2.15.2 for Windows 這個連結， 這會下載位於下列網址的檔案：</p>
<ul>
<li><a href="http://cran.r-project.org/bin/windows/base/R-2.15.2-win.exe">http://cran.r-project.org/bin/windows/base/R-2.15.2-win.exe</a></li>
</ul>
<p>下載完畢後，請啟動該安裝檔，然後不斷按「下一步」就可以完成安裝了，過程非常簡單。</p>
<p>以下網址中的 Youtube 影片介紹了 R 軟體的下載、安裝、套件、網站、電子書等等，有興趣的朋友可以看看。</p>
<ul>
<li><a href="http://www.youtube.com/watch?v=AipnE4s8sKk">http://www.youtube.com/watch?v=AipnE4s8sKk</a></li>
</ul>
<h3 id="基本操作"><a href="#基本操作">基本操作</a></h3>
<p>為了說明 R 軟體的用法，並用以學習機率統計的概念，本系列文章將運用 R 來說明機率統計的理論，讓程式人可以透過實作學會機率統計，並且學會 R 軟體中的 S 語言。</p>
<p>為了避免太過枯燥，我們將不會先介紹 R 的基本語法，而是先用一系列的操作，讓讀者體會 R 的能力，然後再慢慢回到語言的教學上面。</p>
<p>以下是筆者用 R 軟體取樣後會出樣本統計圖的畫面，簡單的幾個指令就可以得到統計結果，是不是很棒呢？</p>
<div class="figure">
<img src="../img/R_run.jpg" alt="圖、R 軟體執行畫面" /><p class="caption">圖、R 軟體執行畫面</p>
</div>
<p>第一個指令 <code>?rnorm</code> 是要求 R 軟體查詢 rnorm 這個指令，R 軟體會顯示以下的說明網頁，您可以看到 rnorm 指令是與常態分部 (The Normal Distribution) 有關的。</p>
<div class="figure">
<img src="../img/R_run.jpg" alt="圖、R 軟體的說明網頁" /><p class="caption">圖、R 軟體的說明網頁</p>
</div>
<p>在 R 軟體中，對於任何一個機率分布 xxxx，都會實作出以 d, p, q, r 為字首的四種函數，例如對於常態分布 Normal Distribution (簡寫為 norm) 而言，就有 dnorm, pnorm, qnorm, rnorm 等四個函數，功能分別如下所示：</p>
<table>
<thead>
<tr class="header">
<th align="left">函數</th>
<th align="left">說明</th>
<th align="left">語法</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">dnorm</td>
<td align="left">常態分布的機密度函數</td>
<td align="left">dnorm(x, mean = 0, sd = 1, log = FALSE)</td>
</tr>
<tr class="even">
<td align="left">pnorm</td>
<td align="left">常態分布的機分布函數</td>
<td align="left">pnorm(q, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)</td>
</tr>
<tr class="odd">
<td align="left">qnorm</td>
<td align="left">常態分布的分位數函數</td>
<td align="left">qnorm(p, mean = 0, sd = 1, lower.tail = TRUE, log.p = FALSE)</td>
</tr>
<tr class="even">
<td align="left">rnorm</td>
<td align="left">常態分布隨機樣本函數</td>
<td align="left">rnorm(n, mean = 0, sd = 1)</td>
</tr>
</tbody>
</table>
<p>上表中的 mean 代表平均數，sd 代表 Standard Deviation (標準差)，n 是隨機產生的樣本個數，x 是隨機變數值，q 是累積值，p 是機率值，n 則是產生的樣本數。</p>
<p>您可以發現函數中，有些參數後面有 = 的指定 (像是 mean=0, sd=1, log=FALSE, ....)，有些卻沒有 (像是 x, q, p, n) 等，這些指定代表預設值，也就是如果您不指定這些參數的値，那麼將會自動代入預設值。</p>
<p>所以 <code>rnorm(100)</code> 代表 <code>rnorm(100, mean = 0, sd = 1)</code> 的意思，也就是該函數會產生平均數為 mean=0，標準差為 sd=1 的隨機樣本共 100 個。</p>
<p>關於這些函數的更詳細的說明如下表所示。</p>
<table>
<thead>
<tr class="header">
<th align="left">字首</th>
<th align="left">函數意義</th>
<th align="left">範例</th>
<th align="left">說明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">d</td>
<td align="left">機率密度函數</td>
<td align="left">dnorm(1.96)</td>
<td align="left">P(X=x)</td>
</tr>
<tr class="even">
<td align="left">p</td>
<td align="left">累積機率函數(CDF)</td>
<td align="left">pnorm(1.96)=0.975</td>
<td align="left">P(X≤x)</td>
</tr>
<tr class="odd">
<td align="left">q</td>
<td align="left">計算百分位數</td>
<td align="left">qnorm(0.975)=1.96</td>
<td align="left">q 系列為 p 系列的反函數; 所以 qnorm(pnorm(1.96)) = 1.96</td>
</tr>
<tr class="even">
<td align="left">r</td>
<td align="left">抽樣函數</td>
<td align="left">rnorm(100)</td>
<td align="left">傳回 100 個標準常態分布的樣本向量</td>
</tr>
</tbody>
</table>
<p>看懂這些函數之後，讓我們再度列出上圖的操作指令，仔細觀察看看每一個指令的意義。</p>
<pre class="sourceCode R"><code class="sourceCode r">?rnorm

x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">10000</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">4</span>)

<span class="kw">hist</span>(x)</code></pre>
<p>指令 <code>x = rnorm(10000, mean=5, sd=4)</code> 代表我們要用平均值為 5, 標準差為 4 的常態分布，隨機產生 10000 個樣本，然後將這些樣本存到 x 陣列當中。</p>
<p>指令 <code>hist(x)</code> 代表要用這些樣本畫出統計的直方圖 (Histogram)，於是就畫出了圖中的那個長條狀圖形。</p>
<p>現在、請讀者試著看看下列操作，看看您是否能夠讀懂這些操作的意義。</p>
<pre class="sourceCode R"><code class="sourceCode r"><span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dv">3</span>, <span class="dv">2</span>)
&gt;<span class="st"> </span>x
 [<span class="dv">1</span>] <span class="fl">2.5810213</span> <span class="fl">0.5399127</span> <span class="fl">5.0005020</span> <span class="fl">5.3402693</span> <span class="fl">2.7900723</span> <span class="fl">3.9638088</span> <span class="fl">5.2119685</span>
 [<span class="dv">8</span>] <span class="fl">2.2209882</span> <span class="fl">2.9935943</span> <span class="fl">7.0308419</span>
&gt;<span class="st"> </span>a=<span class="kw">dnorm</span>(<span class="fl">1.96</span>)
&gt;<span class="st"> </span>a
[<span class="dv">1</span>] <span class="fl">0.05844094</span>
&gt;<span class="st"> </span>b=<span class="kw">pnorm</span>(<span class="fl">1.96</span>)
&gt;<span class="st"> </span>b
[<span class="dv">1</span>] <span class="fl">0.9750021</span>
&gt;<span class="st"> </span>c=<span class="kw">qnorm</span>(b)
&gt;<span class="st"> </span>c
[<span class="dv">1</span>] <span class="fl">1.96</span>
&gt;<span class="st"> </span>d=<span class="kw">rnorm</span>(<span class="dv">10</span>)
&gt;<span class="st"> </span>d
 [<span class="dv">1</span>] -<span class="fl">0.32913677</span>  <span class="fl">0.77788306</span> -<span class="fl">1.80862496</span>  <span class="fl">0.16694598</span> -<span class="fl">0.65656254</span> -<span class="fl">1.76305925</span>
 [<span class="dv">7</span>]  <span class="fl">1.18237502</span>  <span class="fl">0.19651748</span> -<span class="fl">0.07898685</span>  <span class="fl">0.73970933</span>
&gt;<span class="st"> </span></code></pre>
<h2 id="參考文獻"><a href="#參考文獻">參考文獻</a></h2>
<ul>
<li><a href="http://zh.wikipedia.org/wiki/%E6%A6%82%E7%8E%87%E8%AE%BA">維基百科:機率論</a></li>
<li><a href="http://en.wikipedia.org/wiki/Probability_theory">Wikipedia:Probability Theory</a></li>
<li>機率密度函數 PDF (連續) -- <a href="http://en.wikipedia.org/wiki/Probability_density_function">http://en.wikipedia.org/wiki/Probability_density_function</a></li>
<li>機率質量函數 PMF (離散) -- <a href="http://en.wikipedia.org/wiki/Probability_mass_function">http://en.wikipedia.org/wiki/Probability_mass_function</a></li>
<li><a href="http://en.wikipedia.org/wiki/Statistics">http://en.wikipedia.org/wiki/Statistics</a></li>
<li><a href="http://en.wikipedia.org/wiki/Descriptive_statistics">http://en.wikipedia.org/wiki/Descriptive_statistics</a></li>
<li><a href="http://en.wikipedia.org/wiki/Inferential_statistics">http://en.wikipedia.org/wiki/Inferential_statistics</a></li>
<li><a href="http://en.wikipedia.org/wiki/Bayesian_Inference">http://en.wikipedia.org/wiki/Bayesian_Inference</a></li>
<li><a href="http://en.wikipedia.org/wiki/Correlation">http://en.wikipedia.org/wiki/Correlation</a></li>
<li><a href="http://en.wikipedia.org/wiki/Analysis_of_variance">http://en.wikipedia.org/wiki/Analysis_of_variance</a></li>
<li><a href="http://en.wikipedia.org/wiki/Design_of_experiments">http://en.wikipedia.org/wiki/Design_of_experiments</a></li>
<li><a href="http://en.wikipedia.org/wiki/Regression_analysis">http://en.wikipedia.org/wiki/Regression_analysis</a></li>
<li><a href="http://en.wikipedia.org/wiki/Student%27s_t-test">http://en.wikipedia.org/wiki/Student%27s_t-test</a></li>
</ul>
<h1 id="機率的概念"><a href="#機率的概念">機率的概念</a></h1>
<h2 id="樣本空間"><a href="#樣本空間">樣本空間</a></h2>
<p>機率論中，樣本空間是一個實驗或隨機試驗所有可能結果的集合，而隨機試驗中的每個可能結果稱為樣本點。通常用 S、Ω 或 U 表示。例如，如果拋擲一枚硬幣，那麼樣本空間就是集合{正面，反面}。如果投擲一個骰子，那麼樣本空間就是 {1,2,3,4,5,6} 。</p>
<h2 id="事件"><a href="#事件">事件</a></h2>
<p>一個事件是由樣本空間中的一個子集合，例如令 A 為骰子的點數為 {1, 3, 5} 的事件，其機率可以寫為 P(A) = P({1,3,5})。</p>
<h2 id="機率的詮釋方法"><a href="#機率的詮釋方法">機率的詮釋方法</a></h2>
<p>某個事件的發生率，機率很低代表該事件不太可能出現 (很罕見，但是並非不會出現)，機率很高代表該事件非常可能發生。</p>
<p>機率的詮釋方式可以分為下列三種方式。</p>
<p>詮釋 1. 個人方式：(Personal Approach) : 完全按照個人直覺的解釋方式 (不客觀)。</p>
<p>詮釋 2. 相對頻率方式 (Relative Frequency Approach) ： <img src="../timg/960a2d9715f9.jpg" /></p>
<ul>
<li>說明：f 為實驗中事件 A 出現的次數，n 為實驗進行的次數。 此方法乃是基於實驗觀察的結果的方式。</li>
</ul>
<p>詮釋 3. 古典方式 (Classical Approach) ： <img src="../timg/78ef1d6370cd.jpg" /></p>
<ul>
<li>說明： n(A) 為事件 A 可能出現的次數 N(S) 為實驗可能進行的次數。此方法乃是將將實驗的可能出像 (outcome) 假設為等可能發生 (equaly likely)。</li>
</ul>
<h2 id="機率公理"><a href="#機率公理">機率公理</a></h2>
<p>一般人學習數學的時候都是從直覺概念開始的，例如我們小學的時候透過算幾個蘋果學到加法，然後用好幾排的蘋果學到乘法，接著就會背誦九九乘法表，然後在中學的時候導入變數的觀念，於是學會了聯立方程式的解法。</p>
<p>但是數學家們看數學往往是從公理系統開始的，透過公理系統進行推論以建立定理，然後推論出整個數學體系。讓我們學習一下數學家的想法，先來看看機率的公理系統有何特色。</p>
<p>以下三條法則是機率的基本公理：</p>
<blockquote>
<p>公理 (1). <img src="../timg/76e21f1e70cf.jpg" /></p>
<p>公理 (2). <img src="../timg/5aa3d3366d9e.jpg" /></p>
<p>公理 (3). <img src="../timg/a3ff881fb598.jpg" /></p>
</blockquote>
<p>公理 (1) 中的 S 代表機率的樣本空間，也就是所有可能發生的事件所形成的集合，這個集合的發生機率為 1，意義是沒有任何事件落在樣本空間之外。</p>
<p>公理 (2) 中的 A 代表任一事件，而 <img src="../timg/5aa3d3366d9e.jpg" /> 則代表任何事件的發生機率必須是正的，沒有負的機率值。</p>
<p>公理 (3) 中的 A1, A2 代表任兩個事件，如果 A1 與 A2 沒有交集，那麼其聯集發生的機率將會是其機率的總和，也就是 <img src="../timg/b1e49f668dbe.jpg" /> 。</p>
<p>當這個公理系統確定下來之後，我們就可以透過這些法則進行一些基本的推論，舉例而言，我們應該可以很容易的證明以下這些定理。</p>
<blockquote>
<p>定理 1. <img src="../timg/e24e6e487325.jpg" /></p>
<p>定理 2. <img src="../timg/4abf1d2c2a0f.jpg" /></p>
<p>定理 3. <img src="../timg/09b395e50c7c.jpg" /></p>
</blockquote>
<p>但是，這些定理又代表甚麼意義呢？其實從下列凡氏圖上可以很清楚的看得出來這些定理的直覺意義。</p>
<div class="figure">
<img src="../img/VennsDiagramAB.jpg" alt="圖、兩個集合 A, B 的凡氏圖" /><p class="caption">圖、兩個集合 A, B 的凡氏圖</p>
</div>
<p>基本上，機率系統是建構在集合論之上的一門數學系統，所以我們可以用集合論的凡氏圖來理解這些公理與定理的意義。下圖左方是兩個集合 A,B 所形成的凡氏圖，而右方則是三個集合 A, B, C 所形成的凡氏圖。</p>
<div class="figure">
<img src="../img/VennsDiagram.png" alt="圖、三個集合 A, B, C 的凡氏圖" /><p class="caption">圖、三個集合 A, B, C 的凡氏圖</p>
</div>
<h3 id="習題機率定理的證明"><a href="#習題機率定理的證明">習題：機率定理的證明</a></h3>
<p>習題 1 :</p>
<blockquote>
<p>定理：證明 <img src="../timg/e24e6e487325.jpg" /></p>
<p>證明：</p>
<p><img src="../timg/ffe35554f2a8.jpg" /> ; 根據公理 (3)</p>
<p><img src="../timg/4b5ec717dd85.jpg" /> ; 根據集合論</p>
<p><img src="../timg/76e21f1e70cf.jpg" /> ; 根據公理 1</p>
<p><img src="../timg/351d9fe0b461.jpg" /> ; 根據集合論與公理 (3)</p>
<p>所以 <img src="../timg/01ccbcb87c9c.jpg" /></p>
</blockquote>
<p>習題 2 :</p>
<blockquote>
<p>定理：證明 P(A') = 1-P(A) ; 其中的 A' 代表 A 的補集，也就是 <img src="../timg/aaed3f31908e.jpg" /></p>
<p>證明：</p>
<p>因為 <img src="../timg/aaed3f31908e.jpg" /> ; 根據 A' 的定義</p>
<p><img src="../timg/cc770800913d.jpg" /> ; 根據公理 3</p>
<p><img src="../timg/8a292c1ccd78.jpg" /> ; 根據公理 3 與公理1</p>
<p>所以 <img src="../timg/4abf1d2c2a0f.jpg" /></p>
</blockquote>
<p>習題 3 :</p>
<blockquote>
<p>定理：證明 <img src="../timg/09b395e50c7c.jpg" /></p>
<p>證明：</p>
<p>因為 <img src="../timg/4ab3a63cbe91.jpg" /> ; 根據集合論 (用文氏圖可以理解其直覺意義)</p>
<p><img src="../timg/063358003e60.jpg" /> ; 根據集合論 (用文氏圖理解，只是為了方便)</p>
<p><img src="../timg/97fd6fcd3806.jpg" /> ; 根據公理 3</p>
<p>所以 <img src="../timg/6bf2a244e963.jpg" /></p>
<p>推論 <img src="../timg/f33bfbd970f7.jpg" /></p>
<p><img src="../timg/a18f46ea41a2.jpg" /> ;</p>
<p>所以 <img src="../timg/1b3bfc472925.jpg" /></p>
</blockquote>
<h2 id="機率模型"><a href="#機率模型">機率模型</a></h2>
<p>因此、只要指定了所有可能事件的發生率，我們就可以完整的描述一個機率模型，舉例而言，日常生活中最常見的機率模型，大概就是丟銅板和擲骰子了， 以下是我們對這兩個機率系統的描述。</p>
<p>範例 1：丟銅板</p>
<blockquote>
<p>在投擲銅板的機率過程中，其樣本空間 S={正, 反} ，</p>
<p>而其中一個常見的隨機變數 X ，是用來計算銅板的正面數量，</p>
<p>此時，P(正) = 0.5，而 P(反) = 0.5</p>
</blockquote>
<p>範例 2：擲骰子</p>
<blockquote>
<p>在投擲骰子的機率過程中，其樣本空間 S={1點,2點,3點,4點,5點,6點}，</p>
<p>此時，P(1點) = P(2點) = ... = P(6點) = 1/6。</p>
</blockquote>
<p>所以，在一次擲骰子中，得到 5 點或者 6 點的機率，可以圖示如下。</p>
<div class="figure">
<img src="../img/dice56prob.jpg" alt="圖、擲一次骰子 5 點或 6 點的機率" /><p class="caption">圖、擲一次骰子 5 點或 6 點的機率</p>
</div>
<h3 id="練習r-軟體與機率密度函數"><a href="#練習r-軟體與機率密度函數">練習：R 軟體與機率密度函數</a></h3>
<p>我們可以透過 R 軟體進一步瞭解機率密度函數的意義，舉例而言， R 當中有個 sample() 函數，我們只要使用該函數就可以模擬擲骰子或銅板的過程。</p>
<p>您可以用 「?函數」 的方式查詢某函數的功能，因此當我們在 R 軟體中鍵入 ?sample 時， R 軟體會輸出下列訊息：</p>
<pre><code>&gt; ?sample
starting httpd help server ... done</code></pre>
<p>然後就開啟下列的網頁畫面</p>
<div class="figure">
<img src="../img/sampleHelp.jpg" alt="圖、sample 函數的 Help 畫面" /><p class="caption">圖、sample 函數的 Help 畫面</p>
</div>
<p>您可以看到 sample 函數的原型為 <code>sample(x, size, replace = FALSE, prob = NULL)</code>，於是可以用下列指令模擬投擲骰子十次的行為。</p>
<pre><code>&gt; sample(1:6, 10)
錯誤在sample(1:6, 10) : 
  cannot take a sample larger than the population when &#39;replace = FALSE&#39;
&gt; sample(1:6, 10, replace=TRUE)
 [1] 3 2 4 4 4 2 6 3 3 3
&gt; </code></pre>
<p>您可以看到當我們用 <code>sample(1:6, 10, replace=TRUE)</code> 的指令時，可以正確的模擬出投擲骰子十次的隨機過程，得到 3 2 4 4 4 2 6 3 3 3 這個序列， 但是若我們沒有指定 replace=T (TRUE)，的時候，代表要採用取樣後不放回的方式，但是這種方式最多只能做六次，所以就得到失敗的結果。</p>
<p>不過如果我們指定的樣本數 k 在六個以下，那麼 sample(1:6, k) 是會成功的，以下是一個範例：</p>
<pre><code>&gt; sample(1:6, 6)
[1] 2 6 4 1 5 3</code></pre>
<p>同樣的，我們也可以用 sample 函數模擬投擲銅板的過程，只是由於同板只有兩個面 (正面與反面)，因此我們可以用以下的方式模擬：</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>face =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;正&quot;</span>, <span class="st">&quot;反&quot;</span>)
&gt;<span class="st"> </span><span class="kw">sample</span>(face, <span class="dv">10</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>)
 [<span class="dv">1</span>] <span class="st">&quot;正&quot;</span> <span class="st">&quot;反&quot;</span> <span class="st">&quot;正&quot;</span> <span class="st">&quot;反&quot;</span> <span class="st">&quot;反&quot;</span> <span class="st">&quot;正&quot;</span> <span class="st">&quot;反&quot;</span> <span class="st">&quot;正&quot;</span> <span class="st">&quot;正&quot;</span> <span class="st">&quot;反&quot;</span></code></pre>
<p>上述模擬中的第一個指令 <code>face = c(&quot;正&quot;, &quot;反&quot;)</code>，代表我們要建立一個有兩個字串元素 [ 正, 反] 的陣列。然後第二個指令 <code>sample(face, 10, replace=TRUE)</code> 是用這樣的陣列去產生 10 個樣本 (取後放回的方式)。</p>
<p>有時候，我們希望模擬的事物，其機率並非平均的，舉例而言，像是灌過鉛的骰子，或者是像台灣的廟裏面常見的「擲茭」， 其機率可能是不平均的，對這種情況我們就可以指定 <code>sample(x, size, replace = FALSE, prob = NULL)</code> 這個函數的第四個參數， 也就是 prob 來模擬。</p>
<p>舉例而言，假如「擲茭」的正面機率是 0.6，而反面機率是 0.4，那麼我們就可以用下列方式模擬「擲茭」十次的過程。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">sample</span>(face, <span class="dv">10</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>, <span class="kw">c</span>(<span class="fl">0.6</span>, <span class="fl">0.4</span>))
 [<span class="dv">1</span>] <span class="st">&quot;反&quot;</span> <span class="st">&quot;正&quot;</span> <span class="st">&quot;反&quot;</span> <span class="st">&quot;反&quot;</span> <span class="st">&quot;反&quot;</span> <span class="st">&quot;正&quot;</span> <span class="st">&quot;正&quot;</span> <span class="st">&quot;正&quot;</span> <span class="st">&quot;正&quot;</span> <span class="st">&quot;正&quot;</span></code></pre>
<h3 id="習題"><a href="#習題">習題</a></h3>
<p>習題 1 : 請模擬從班上隨機抽學生一萬次，看看誰與你最有緣 (抽到次數最多)</p>
<p>解答：假設班上有 59 人，那麼編為 1 到 59 號，於是我們可以用下列程式，進行 1 萬次抽樣， 並繪出統計圖。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x=<span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">59</span>, <span class="dv">10000</span>, <span class="ot">TRUE</span>)
&gt;<span class="st"> </span><span class="kw">hist</span>(x, <span class="dt">breaks=</span><span class="fl">0.5</span>:<span class="dv">60</span>)</code></pre>
<p>執行結果</p>
<div class="figure">
<img src="../img/classmate.jpg" alt="圖、最有緣的同學統計圖" /><p class="caption">圖、最有緣的同學統計圖</p>
</div>
<p>習題 2 : 感受中央極限定理</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x=<span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">6</span>, <span class="dv">10000</span>, T)
&gt;<span class="st"> </span>y=<span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">6</span>, <span class="dv">10000</span>, T)
&gt;<span class="st"> </span>z=<span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">6</span>, <span class="dv">10000</span>, T)
&gt;<span class="st"> </span><span class="kw">hist</span>(x, <span class="dt">breaks=</span><span class="fl">0.5</span>:<span class="dv">7</span>)
&gt;<span class="st"> </span><span class="kw">hist</span>(y, <span class="dt">breaks=</span><span class="fl">0.5</span>:<span class="dv">7</span>)
&gt;<span class="st"> </span><span class="kw">hist</span>(z, <span class="dt">breaks=</span><span class="fl">0.5</span>:<span class="dv">7</span>)
&gt;<span class="st"> </span><span class="kw">hist</span>(x+y, <span class="dt">breaks=</span><span class="fl">1.5</span>:<span class="dv">13</span>)
&gt;<span class="st"> </span><span class="kw">hist</span>(x+y+z, <span class="dt">breaks=</span><span class="fl">2.5</span>:<span class="dv">19</span>)</code></pre>
<p>執行結果</p>
<div class="figure">
<img src="../img/xyz.jpg" alt="圖、x+y+z 的分布圖" /><p class="caption">圖、x+y+z 的分布圖</p>
</div>
<h2 id="條件機率"><a href="#條件機率">條件機率</a></h2>
<blockquote>
<p><em>條件機率的定義</em>：</p>
<p>在 A 事件出現的情況下，B 事件出現的機率，稱為 P(B|A)。</p>
<div class="figure">
<img src="../timg/dd2e7c5d436f.jpg" />
</div>
</blockquote>
<p>範例 1：</p>
<blockquote>
<p>舉例而言，假如我們已知某投擲骰子的結果為偶數 (事件 A=偶數)，那麼結果為 3 點 (事件 B=3點) 的機率為多少？</p>
<p>這個條件機率可以用下列算式表示。</p>
<p>P(B|A) = P(3點|偶數)</p>
</blockquote>
<p>範例 2：</p>
<blockquote>
<p>當然、B 不一定要是 A 的子集合，舉例而言，假如 B 為「不大於 3 點」的事件，那麼我們就可以將條件機率表示如下：</p>
<p>P(B|A) = P(不大於3點|偶數)</p>
</blockquote>
<h2 id="獨立事件"><a href="#獨立事件">獨立事件</a></h2>
<blockquote>
<p><em>獨立事件的定義</em> :</p>
<p>事件 A 與 B 彼此獨立，則 A, B 兩事件同時出現的機率為</p>
<div class="figure">
<img src="../timg/0a3e7ee40db9.jpg" />
</div>
</blockquote>
<p>請注意數學中定義的意義，定義代表某種規定，是不需要證明的，只要不符合這種規定的，就不能用此一名詞描述，也就是不符合此定義。</p>
<p>因此、並非所有的事件 A, B 都會是獨立的，但若事件 A, B 符合上述規定的話，我們就稱這兩個事件彼此獨立。</p>
<p>舉例而言，假如對於一個公平的骰子而言，請問下列的 A,B 事件之間是否彼此獨立。</p>
<p>範例 1. 兩事件不獨立的情況</p>
<blockquote>
<p>問題：請問 「A=偶數, B=3點」這兩個事件是否獨立</p>
<p>解答：</p>
<p>P(A) = 3/6 = 1/2</p>
<p>P(B) = 1/6</p>
<p>P(A ∩ B) = 0</p>
<p>P(A) P(B) = 1/2 * 1/6 =1/12</p>
<p>由於 P(A B) P(A) P(B) ，所以這兩個事件彼此不獨立。</p>
</blockquote>
<p>範例 2. 兩事件獨立的情況</p>
<blockquote>
<p>問題：請問 「A=偶數, B=不大於 4 點」這兩個事件是否獨立</p>
<p>解答：</p>
<p>P(A) = 3/6 = 1/2</p>
<p>P(B) = 4/6 = 2/3</p>
<p>P(A ∩ B) = P({2點, 4點}) = 2/6 = 1/3</p>
<p>P(A) P(B) = 1/2 * 2/3 = 1/3</p>
<p>由於 P(A ∩ B) = P(A) P(B) ，所以這兩個事件彼此獨立。</p>
</blockquote>
<p>習題：請證明以下定理：</p>
<blockquote>
<p>定理 1. 若 A , B 彼此獨立，則 <img src="../timg/11bc562d4c5f.jpg" /></p>
<p>定理 2. <img src="../timg/31251b717bd5.jpg" /> 彼此獨立 &lt;=&gt; <img src="../timg/89076fbbf148.jpg" /></p>
<p>定理 3. 乘法規則： <img src="../timg/e9be7c980007.jpg" /></p>
</blockquote>
<p>習題 : 請舉出一組獨立事件的範例</p>
<h2 id="貝氏定理"><a href="#貝氏定理">貝氏定理</a></h2>
<blockquote>
<p><em>貝氏定理</em>： <img src="../timg/75ebef646fe3.jpg" /></p>
<p>證明：</p>
<p>由條件機率的定義可得 <img src="../timg/f0bc4197c8f3.jpg" /> ，也可以得到 <img src="../timg/2a1e464ca323.jpg" /></p>
<p>所以 <img src="../timg/500cd16c0697.jpg" /></p>
<p>於是得到 <img src="../timg/75ebef646fe3.jpg" /></p>
</blockquote>
<p>習題：</p>
<blockquote>
<p>習題 1. 請驗證 「A=偶數, B=3點」這兩個事件是否符合貝氏定理</p>
<p>習題 2. 請驗證 「A=偶數, B=不大於 4 點」這兩個事件是否符合貝氏定理</p>
</blockquote>
<h2 id="條件獨立"><a href="#條件獨立">條件獨立</a></h2>
<blockquote>
<p><em>條件獨立的定義</em>：</p>
<p>假如 A 與 B 在給定 C 的情況下條件獨立，那麼以下算式成立：</p>
<p><img src="../timg/6fad03b10e7b.jpg" /> ;</p>
</blockquote>
<p>習題：請證明以下定理：</p>
<blockquote>
<p>定理： <img src="../timg/1c5a6f46d329.jpg" /></p>
</blockquote>
<h2 id="習題牙疼的診斷問題"><a href="#習題牙疼的診斷問題">習題：牙疼的診斷問題</a></h2>
<p>本問題來自人工智慧的經典教科書 「Artificial Intelligence: A Modern Approach」第三版，475 頁。</p>
<p>問題描述：當病人來看牙醫時，該病人可能有蛀牙或沒蛀牙，也可能有牙痛或沒有牙痛，而牙醫可能會找到牙痛的原因或找不到。</p>
<p>因此有下列三個隨機變數</p>
<p>X:(蛀) 蛀牙與否 (Cavity) Y:(痛) 牙痛與否 (Toothache) Z:(找) 是否找到痛的牙 (Catch)</p>
<p>假如這個問題個統計機率都已經知道了，如下表所示。</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">牙痛 (Y=1)</th>
<th align="left"></th>
<th align="left">不牙痛 (Y=0)</th>
<th align="left"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left"></td>
<td align="left">找到 (Z=1)</td>
<td align="left">找不到 (Z=0)</td>
<td align="left">找到 (Z=1)</td>
<td align="left">找不到 (Z=0)</td>
</tr>
<tr class="even">
<td align="left">蛀牙(X=1)</td>
<td align="left">0.108</td>
<td align="left">0.012</td>
<td align="left">0.072</td>
<td align="left">0.008</td>
</tr>
<tr class="odd">
<td align="left">沒蛀牙 (X=0)</td>
<td align="left">0.016</td>
<td align="left">0.064</td>
<td align="left">0.144</td>
<td align="left">0.576</td>
</tr>
</tbody>
</table>
<p>請回答下列問題</p>
<ul>
<li>問題 1：請計算 P(沒痛) = ?</li>
<li>問題 2：請計算 P(找到 | 牙痛) = ?</li>
<li>問題 3：請問這是一個合理的機率分布嗎？</li>
<li>問題 4：請計算 P(找到 | 蛀牙) = ?</li>
<li>問題 5：請計算 P(找到, 牙痛) = ?</li>
<li>問題 6：請計算 P(蛀 | 找到), P(蛀), P(找到), P(找到 | 蛀) ，然後驗證下列貝氏定理是否成立。
<ul>
<li>P(找到|蛀) = P(蛀|找到) P(找到)/P(蛀)</li>
</ul></li>
</ul>
<p>解答</p>
<p>R 的 陣列是用以行為主的順序 (Column Major Order)，請看下列檔案中的說明：</p>
<ul>
<li><a href="http://cran.r-project.org/doc/manuals/R-lang.pdf">http://cran.r-project.org/doc/manuals/R-lang.pdf</a></li>
</ul>
<blockquote>
<p>2.2.2 The dim attribute is used to implement arrays. The content of the array is stored in a vector in column-major order and the dim attribute is a vector of integers specifying the respective extents of the array. R ensures that the length of the vector is the product of the lengths of the dimensions. The length of one or more dimensions may be zero.</p>
</blockquote>
<p>所以我們必須用以行為主的順序 (Column Major Order) 將機率列舉出來，如下表所示：</p>
<table>
<thead>
<tr class="header">
<th align="left">蛀 X</th>
<th align="left">痛 Y</th>
<th align="left">找 Z</th>
<th align="left">P(X,Y,Z)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0.576</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0</td>
<td align="left">0.008</td>
</tr>
<tr class="odd">
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0.064</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">1</td>
<td align="left">0</td>
<td align="left">0.012</td>
</tr>
<tr class="odd">
<td align="left">0</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0.144</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">0</td>
<td align="left">1</td>
<td align="left">0.072</td>
</tr>
<tr class="odd">
<td align="left">0</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">0.016</td>
</tr>
<tr class="even">
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">0.108</td>
</tr>
</tbody>
</table>
<p>而且 R 的陣列是從 1 開始算的，不像 C 語言是從 0 開始算的，因此還必須將上表修改如下：</p>
<table>
<thead>
<tr class="header">
<th align="left">蛀 X</th>
<th align="left">痛 Y</th>
<th align="left">找 Z</th>
<th align="left">P(X,Y,Z)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">0.576</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">1</td>
<td align="left">1</td>
<td align="left">0.008</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">2</td>
<td align="left">1</td>
<td align="left">0.064</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">2</td>
<td align="left">1</td>
<td align="left">0.012</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">0.144</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">1</td>
<td align="left">2</td>
<td align="left">0.072</td>
</tr>
<tr class="odd">
<td align="left">1</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left">0.016</td>
</tr>
<tr class="even">
<td align="left">2</td>
<td align="left">2</td>
<td align="left">2</td>
<td align="left">0.108</td>
</tr>
</tbody>
</table>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>p &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="kw">c</span>(<span class="fl">0.576</span>, <span class="fl">0.008</span>, <span class="fl">0.064</span>, <span class="fl">0.012</span>, <span class="fl">0.144</span>, <span class="fl">0.072</span>, <span class="fl">0.016</span>, <span class="fl">0.108</span>),<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))
&gt;<span class="st"> </span>p
, , <span class="dv">1</span>

      [,<span class="dv">1</span>]  [,<span class="dv">2</span>]
[<span class="dv">1</span>,] <span class="fl">0.576</span> <span class="fl">0.064</span>
[<span class="dv">2</span>,] <span class="fl">0.008</span> <span class="fl">0.012</span>

, , <span class="dv">2</span>

      [,<span class="dv">1</span>]  [,<span class="dv">2</span>]
[<span class="dv">1</span>,] <span class="fl">0.144</span> <span class="fl">0.016</span>
[<span class="dv">2</span>,] <span class="fl">0.072</span> <span class="fl">0.108</span>

&gt;<span class="st"> </span>p[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>]
[<span class="dv">1</span>] <span class="fl">0.576</span>
&gt;<span class="st"> </span>p[<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>]
[<span class="dv">1</span>] <span class="fl">0.008</span>
&gt;<span class="st"> </span>p[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>]
[<span class="dv">1</span>] <span class="fl">0.064</span>
&gt;<span class="st"> </span>p[<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>]
[<span class="dv">1</span>] <span class="fl">0.012</span>
&gt;<span class="st"> </span>p[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>]
[<span class="dv">1</span>] <span class="fl">0.144</span>
&gt;<span class="st"> </span>p[<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>]
[<span class="dv">1</span>] <span class="fl">0.072</span>
&gt;<span class="st"> </span>p[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>]
[<span class="dv">1</span>] <span class="fl">0.016</span>
&gt;<span class="st"> </span>p[<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>]
[<span class="dv">1</span>] <span class="fl">0.108</span>
&gt;<span class="st"> </span><span class="kw">dimnames</span>(p)[[<span class="dv">1</span>]] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;沒蛀&quot;</span>, <span class="st">&quot;蛀&quot;</span>)
&gt;<span class="st"> </span><span class="kw">dimnames</span>(p)[[<span class="dv">2</span>]] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;沒痛&quot;</span>, <span class="st">&quot;痛&quot;</span>)
&gt;<span class="st"> </span><span class="kw">dimnames</span>(p)[[<span class="dv">3</span>]] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;沒找&quot;</span>, <span class="st">&quot;找&quot;</span>)
&gt;<span class="st"> </span>p
, , 沒找

<span class="st">      </span>沒痛    痛
沒蛀 <span class="fl">0.576</span> <span class="fl">0.064</span>
蛀   <span class="fl">0.008</span> <span class="fl">0.012</span>

, , 找

<span class="st">      </span>沒痛    痛
沒蛀 <span class="fl">0.144</span> <span class="fl">0.016</span>
蛀   <span class="fl">0.072</span> <span class="fl">0.108</span></code></pre>
<p>解答1：P(沒痛) = 0.8 計算過程：</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>p[,<span class="st">&quot;沒痛&quot;</span>,]
      沒找<span class="st">    </span><span class="er">找</span>
沒蛀 <span class="fl">0.576</span> <span class="fl">0.144</span>
蛀   <span class="fl">0.008</span> <span class="fl">0.072</span>
&gt;<span class="st"> </span><span class="kw">sum</span>(p[,<span class="st">&quot;沒痛&quot;</span>,])
[<span class="dv">1</span>] <span class="fl">0.8</span></code></pre>
<p>解答2：P(找到 | 牙痛) = 0.62</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>p[,,<span class="st">&quot;找&quot;</span>]
      沒痛    痛
沒蛀 <span class="fl">0.144</span> <span class="fl">0.016</span>
蛀   <span class="fl">0.072</span> <span class="fl">0.108</span>
&gt;<span class="st"> </span><span class="kw">sum</span>(p[,,<span class="st">&quot;找&quot;</span>])
[<span class="dv">1</span>] <span class="fl">0.34</span>
&gt;<span class="st"> </span><span class="kw">sum</span>(p[,<span class="st">&quot;痛&quot;</span>,<span class="st">&quot;找&quot;</span>])
[<span class="dv">1</span>] <span class="fl">0.124</span>
&gt;<span class="st"> </span><span class="kw">sum</span>(p[,<span class="st">&quot;痛&quot;</span>,<span class="st">&quot;找&quot;</span>])/<span class="kw">sum</span>(<span class="kw">sum</span>(p[,<span class="st">&quot;痛&quot;</span>,]))
[<span class="dv">1</span>] <span class="fl">0.62</span></code></pre>
<p>解答3：請問這是一個合理的機率分布嗎？ (是的，因為總和為 1，而且每個機率直都介於 0 到1之間)</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">sum</span>(p)
[<span class="dv">1</span>] <span class="dv">1</span>
&gt;<span class="st"> </span><span class="dv">0</span>&lt;=p &amp;<span class="st"> </span>p &lt;=<span class="dv">1</span>
, , 沒找

<span class="st">     </span>沒痛   痛
沒蛀 <span class="ot">TRUE</span> <span class="ot">TRUE</span>
蛀   <span class="ot">TRUE</span> <span class="ot">TRUE</span>

, , 找

<span class="st">     </span>沒痛   痛
沒蛀 <span class="ot">TRUE</span> <span class="ot">TRUE</span>
蛀   <span class="ot">TRUE</span> <span class="ot">TRUE</span></code></pre>
<p>問題 4：請計算 P(找到 | 蛀牙) = ?</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st">  </span><span class="kw">sum</span>(p[<span class="st">&quot;蛀&quot;</span>,,<span class="st">&quot;找&quot;</span>])/<span class="kw">sum</span>(p[<span class="st">&quot;蛀&quot;</span>,,])
[<span class="dv">1</span>] <span class="fl">0.9</span></code></pre>
<p>問題 5：請計算 P(找到, 牙痛) = ?</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">sum</span>(p[,<span class="st">&quot;痛&quot;</span>,<span class="st">&quot;找&quot;</span>])
[<span class="dv">1</span>] <span class="fl">0.124</span></code></pre>
<p>解答6：請計算 P(蛀 | 找到), P(蛀), P(找到), P(找到 | 蛀) ，然後驗證下列貝氏定理是否成立。</p>
<blockquote>
<p>P(蛀 | 找到) = p(找到|蛀) * p(蛀)/p(找到)</p>
</blockquote>
<p>說明：</p>
<p>P(蛀 | 找到) = 0.5294118, P(蛀)=0.2, P(找到)=0.34, P(找到 | 蛀)=0.9</p>
<p>P(蛀 | 找到) = 0.5294118 = 0.9 * 0.2/0.34 = = p(找到|蛀) * p(蛀)/p(找到)</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>pab =<span class="st"> </span><span class="kw">sum</span>(p[<span class="st">&quot;蛀&quot;</span>,,<span class="st">&quot;找&quot;</span>])/<span class="kw">sum</span>(p[,,<span class="st">&quot;找&quot;</span>]) <span class="co"># pab = P(蛀 | 找到)</span>
&gt;<span class="st"> </span>pba =<span class="st"> </span><span class="kw">sum</span>(p[<span class="st">&quot;蛀&quot;</span>,,<span class="st">&quot;找&quot;</span>])/<span class="kw">sum</span>(p[<span class="st">&quot;蛀&quot;</span>,,]) <span class="co"># pba = P(找到 | 蛀)</span>
&gt;<span class="st"> </span>pa =<span class="st"> </span><span class="kw">sum</span>(p[<span class="st">&quot;蛀&quot;</span>,,]) <span class="co"># pa = P(蛀)</span>
&gt;<span class="st"> </span>pb =<span class="st"> </span><span class="kw">sum</span>(p[,,<span class="st">&quot;找&quot;</span>]) <span class="co"># pb = P(找到)</span>
&gt;<span class="st"> </span>pab
[<span class="dv">1</span>] <span class="fl">0.5294118</span>
&gt;<span class="st"> </span>pba
[<span class="dv">1</span>] <span class="fl">0.9</span>
&gt;<span class="st"> </span>pa
[<span class="dv">1</span>] <span class="fl">0.2</span>
&gt;<span class="st"> </span>pb
[<span class="dv">1</span>] <span class="fl">0.34</span>
&gt;<span class="st"> </span>pba*pa/pb
[<span class="dv">1</span>] <span class="fl">0.5294118</span>
&gt;<span class="st"> </span>pab-pba*pa/pb
[<span class="dv">1</span>] <span class="dv">0</span></code></pre>
<p>所以</p>
<pre class="sourceCode R"><code class="sourceCode r"><span class="kw">p</span>(蛀|<span class="er">找</span>) 
=<span class="st"> </span><span class="kw">sum</span>(p[<span class="st">&quot;蛀&quot;</span>,,<span class="st">&quot;找&quot;</span>])/<span class="kw">sum</span>(p[,,<span class="st">&quot;找&quot;</span>]) 
=<span class="st"> </span>pab 
=<span class="st"> </span>pba *<span class="st"> </span>pa /<span class="st"> </span>pb 
=<span class="st"> </span><span class="kw">p</span>(找<span class="er">|</span>蛀) *<span class="st"> </span><span class="kw">p</span>(蛀)/<span class="kw">p</span>(找) 
=<span class="st"> </span><span class="kw">sum</span>(p[<span class="st">&quot;蛀&quot;</span>,,<span class="st">&quot;找&quot;</span>])/<span class="kw">sum</span>(p[,,<span class="st">&quot;蛀&quot;</span>])*<span class="st"> </span><span class="kw">sum</span>(p[,,<span class="st">&quot;蛀&quot;</span>])/<span class="st"> </span><span class="kw">sum</span>(p[<span class="st">&quot;找&quot;</span>,,])</code></pre>
<p>完整的操作過程</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>p &lt;-<span class="st"> </span><span class="kw">array</span>(<span class="kw">c</span>(<span class="fl">0.576</span>, <span class="fl">0.008</span>, <span class="fl">0.064</span>, <span class="fl">0.012</span>, <span class="fl">0.144</span>, <span class="fl">0.072</span>, <span class="fl">0.016</span>, <span class="fl">0.108</span>),<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>))
&gt;<span class="st"> </span>p
, , <span class="dv">1</span>

      [,<span class="dv">1</span>]  [,<span class="dv">2</span>]
[<span class="dv">1</span>,] <span class="fl">0.576</span> <span class="fl">0.064</span>
[<span class="dv">2</span>,] <span class="fl">0.008</span> <span class="fl">0.012</span>

, , <span class="dv">2</span>

      [,<span class="dv">1</span>]  [,<span class="dv">2</span>]
[<span class="dv">1</span>,] <span class="fl">0.144</span> <span class="fl">0.016</span>
[<span class="dv">2</span>,] <span class="fl">0.072</span> <span class="fl">0.108</span>

&gt;<span class="st"> </span>p[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>]
[<span class="dv">1</span>] <span class="fl">0.576</span>
&gt;<span class="st"> </span>p[<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>]
[<span class="dv">1</span>] <span class="fl">0.008</span>
&gt;<span class="st"> </span>p[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">1</span>]
[<span class="dv">1</span>] <span class="fl">0.064</span>
&gt;<span class="st"> </span>p[<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>]
[<span class="dv">1</span>] <span class="fl">0.012</span>
&gt;<span class="st"> </span>p[<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>]
[<span class="dv">1</span>] <span class="fl">0.144</span>
&gt;<span class="st"> </span>p[<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">2</span>]
[<span class="dv">1</span>] <span class="fl">0.072</span>
&gt;<span class="st"> </span>p[<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>]
[<span class="dv">1</span>] <span class="fl">0.016</span>
&gt;<span class="st"> </span>p[<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>]
[<span class="dv">1</span>] <span class="fl">0.108</span>
&gt;<span class="st"> </span><span class="kw">dimnames</span>(p)[[<span class="dv">1</span>]] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;沒蛀&quot;</span>, <span class="st">&quot;蛀&quot;</span>)
&gt;<span class="st"> </span><span class="kw">dimnames</span>(p)[[<span class="dv">2</span>]] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;沒痛&quot;</span>, <span class="st">&quot;痛&quot;</span>)
&gt;<span class="st"> </span><span class="kw">dimnames</span>(p)[[<span class="dv">3</span>]] =<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;沒找&quot;</span>, <span class="st">&quot;找&quot;</span>)
&gt;<span class="st"> </span>p
, , 沒找

<span class="st">      </span>沒痛    痛
沒蛀 <span class="fl">0.576</span> <span class="fl">0.064</span>
蛀   <span class="fl">0.008</span> <span class="fl">0.012</span>

, , 找

<span class="st">      </span>沒痛    痛
沒蛀 <span class="fl">0.144</span> <span class="fl">0.016</span>
蛀   <span class="fl">0.072</span> <span class="fl">0.108</span>

&gt;<span class="st"> </span>p[,<span class="st">&quot;沒痛&quot;</span>,]
      沒找<span class="st">    </span><span class="er">找</span>
沒蛀 <span class="fl">0.576</span> <span class="fl">0.144</span>
蛀   <span class="fl">0.008</span> <span class="fl">0.072</span>
&gt;<span class="st"> </span>p[,,<span class="st">&quot;找&quot;</span>]
      沒痛    痛
沒蛀 <span class="fl">0.144</span> <span class="fl">0.016</span>
蛀   <span class="fl">0.072</span> <span class="fl">0.108</span>
&gt;<span class="st"> </span><span class="kw">sum</span>(p[,,<span class="st">&quot;找&quot;</span>])
[<span class="dv">1</span>] <span class="fl">0.34</span>
&gt;<span class="st"> </span><span class="kw">sum</span>(p[,<span class="st">&quot;痛&quot;</span>,<span class="st">&quot;找&quot;</span>])
[<span class="dv">1</span>] <span class="fl">0.124</span>
&gt;<span class="st"> </span><span class="kw">sum</span>(p[,<span class="st">&quot;痛&quot;</span>,<span class="st">&quot;找&quot;</span>])/<span class="kw">sum</span>(<span class="kw">sum</span>(p[,<span class="st">&quot;痛&quot;</span>,]))
[<span class="dv">1</span>] <span class="fl">0.62</span>
&gt;<span class="st"> </span><span class="kw">sum</span>(p)
[<span class="dv">1</span>] <span class="dv">1</span>
&gt;<span class="st"> </span><span class="dv">0</span>&lt;=p &amp;<span class="st"> </span>p &lt;=<span class="dv">1</span>
, , 沒找

<span class="st">     </span>沒痛   痛
沒蛀 <span class="ot">TRUE</span> <span class="ot">TRUE</span>
蛀   <span class="ot">TRUE</span> <span class="ot">TRUE</span>

, , 找

<span class="st">     </span>沒痛   痛
沒蛀 <span class="ot">TRUE</span> <span class="ot">TRUE</span>
蛀   <span class="ot">TRUE</span> <span class="ot">TRUE</span>

&gt;<span class="st"> </span><span class="kw">sum</span>(p[<span class="st">&quot;蛀&quot;</span>,,<span class="st">&quot;找&quot;</span>])/<span class="kw">sum</span>(p[<span class="st">&quot;蛀&quot;</span>,,])
[<span class="dv">1</span>] <span class="fl">0.9</span>
&gt;<span class="st"> </span><span class="kw">sum</span>(p[<span class="st">&quot;蛀&quot;</span>,,<span class="st">&quot;找&quot;</span>])/<span class="kw">sum</span>(p[<span class="st">&quot;蛀&quot;</span>,,])
[<span class="dv">1</span>] <span class="fl">0.9</span>
&gt;<span class="st"> </span><span class="kw">sum</span>(p[,<span class="st">&quot;痛&quot;</span>,<span class="st">&quot;找&quot;</span>])/<span class="kw">sum</span>(p[,<span class="st">&quot;痛&quot;</span>,])
[<span class="dv">1</span>] <span class="fl">0.62</span>
&gt;<span class="st"> </span><span class="kw">sum</span>(p[,<span class="st">&quot;痛&quot;</span>,<span class="st">&quot;找&quot;</span>])
[<span class="dv">1</span>] <span class="fl">0.124</span>
&gt;<span class="st"> </span>pab =<span class="st"> </span><span class="kw">sum</span>(p[<span class="st">&quot;蛀&quot;</span>,,<span class="st">&quot;找&quot;</span>])/<span class="kw">sum</span>(p[,,<span class="st">&quot;找&quot;</span>]) <span class="co"># pab = P(蛀 | 找到)</span>
&gt;<span class="st"> </span>pba =<span class="st"> </span><span class="kw">sum</span>(p[<span class="st">&quot;蛀&quot;</span>,,<span class="st">&quot;找&quot;</span>])/<span class="kw">sum</span>(p[<span class="st">&quot;蛀&quot;</span>,,]) <span class="co"># pba = P(找到 | 蛀)</span>
&gt;<span class="st"> </span>pa =<span class="st"> </span><span class="kw">sum</span>(p[<span class="st">&quot;蛀&quot;</span>,,]) <span class="co"># pa = P(蛀)</span>
&gt;<span class="st"> </span>pb =<span class="st"> </span><span class="kw">sum</span>(p[,,<span class="st">&quot;找&quot;</span>]) <span class="co"># pb = P(找到)</span>
&gt;<span class="st"> </span>pab
[<span class="dv">1</span>] <span class="fl">0.5294118</span>
&gt;<span class="st"> </span>pba
[<span class="dv">1</span>] <span class="fl">0.9</span>
&gt;<span class="st"> </span>pa
[<span class="dv">1</span>] <span class="fl">0.2</span>
&gt;<span class="st"> </span>pb
[<span class="dv">1</span>] <span class="fl">0.34</span>
&gt;<span class="st"> </span>pba*pa/pb
[<span class="dv">1</span>] <span class="fl">0.5294118</span>
&gt;<span class="st"> </span>pab-pba*pa/pb
[<span class="dv">1</span>] <span class="dv">0</span>
&gt;<span class="st"> </span></code></pre>
<h1 id="隨機變數"><a href="#隨機變數">隨機變數</a></h1>
<h2 id="隨機變數簡介"><a href="#隨機變數簡介">隨機變數簡介</a></h2>
<p>如果 X 指定給機率空間 S 中每一個事件 e 一個實數 X(e)，同時針對每一個實數 r 都有一個事件集合 <img src="../timg/fb19e35ede1c.jpg" /> 與其相對應，其中 <img src="../timg/a1c678182b41.jpg" /> ，那麼 X 被稱作隨機變數。</p>
<p>隨機變數是機率理論當中非常重要的一個概念，但是卻也非常容易被誤解，因為隨機變數其實是一種函數，而非只是簡單的變數，以下是機變數的定義。</p>
<blockquote>
<p><em>隨機變數 (Random Variable)</em></p>
<p>定義：隨機變數是以樣本空間 S 為定義域的實數值函數，可以寫為 X(s)，其中 <img src="../timg/61caaef9bb60.jpg" /></p>
<p>換言之，隨機變數 X 是一個機率空間 (probability space) 中的函數， 可以寫為 <img src="../timg/517d16924a66.jpg" /> ，該函數將 S 的某一子集合映射到實數領域 R。</p>
</blockquote>
<div class="figure">
<img src="../img/Zufall.png" alt="圖、實數坐標軸上的隨機變數示意圖" /><p class="caption">圖、實數坐標軸上的隨機變數示意圖</p>
</div>
<p>舉例而言，投擲一個銅板時，可能出現正面或反面，此時的樣本空間 S = {正面、反面}。</p>
<p>假如這是一個公平的銅板，兩面的機率各為 1/2，那麼我們就可以寫為 P(正面) = 1/2， P(反面) = 1/2。</p>
<p>但是在這樣的描述當中，並沒有函數的慨念，因此不符合隨機變數的定義。</p>
<p>如果我們用一個函數 X，代表銅板正面出現的次數，那麼 X 會將 {正面、反面} 映設到 {1,0} ，這樣的函數才符合隨機變數的定義。我們可以寫為 <img src="../timg/517d16924a66.jpg" /> ，其中的樣本空間 S={正面、反面}，且 X(正面)=1，X(反面) = 0。</p>
<p>為何要這麼麻煩呢？為何我們不直接指定樣本空間中每一元素的機率就好了呢？</p>
<p>原因之一是，採用隨機變數概念的描述，才能將函數引入到機率模型中，這樣也才能更方便的描述一系列的隨機試驗。</p>
<p>舉例而言，假如我們投擲兩個銅版，出現正面的個數為一個隨機變數，假如這個隨機變數稱為 X2，那麼 X2 的定義域 (樣本空間) 就是 S2={正正、正反、反正、反反}，那麼隨機變數 X2 就會將 S2 空間中的元素映射到 {2, 1, 0} 這些實數值上，如下所示：</p>
<pre><code>X2(正正) = 2
X2(正反) = 1
X2(反正) = 1
X2(反反) = 0</code></pre>
<p>這樣我們就可以用「機率密度函數」來描述各個事件出現的機率，例如用 P[X2=2] 代表出現兩次正面的機率，P[X2=1] 代表出現一次正面的機率，而P[X2=0] 代表沒有出現正面的機率。</p>
<p>範例：</p>
<blockquote>
<p>隨機擲兩個骰子，整個事件空間可以由 36 個元素組成：</p>
<div class="figure">
<img src="../timg/f43afa1265bd.jpg" />
</div>
<p>這裡可以構成多個隨機變數，比如隨機變數 X ( 獲得的兩個骰子的點數和 ) 或者隨機變數 Y ( 獲得的兩個骰子的點數差)，隨機變數 X 可以有 11 個整數值，而隨機變數 Y 只有 6 個。</p>
<p><img src="../timg/7ff9cf76e9e9.jpg" /> ;</p>
<p><img src="../timg/a32b7f8ecf0e.jpg" /> ;</p>
</blockquote>
<p>在此，我們引入了一個新的概念，稱為「機率密度函數」，讓我們更仔細的看看這個概念的意義。</p>
<p>習題 1：</p>
<blockquote>
<p>問題： 請定義擲茭(博杯)的隨機變數</p>
<p>說明：</p>
<ol style="list-style-type: lower-alpha">
<li><p>有杯映射到 1，沒杯映射到 0</p></li>
<li><p>樣本空間為 {正正、正反、反正、反反}</p></li>
<li><p>{ 正反、反正} 稱為有杯</p></li>
</ol>
</blockquote>
<p>解答：</p>
<blockquote>
<p>X({正正}) = 0</p>
<p>X({正反}) = 1</p>
<p>X({反正}) = 1</p>
<p>X({反反}) = 0</p>
<p>補充：假如博杯正面積率為 0.6，反面機率為 0.4，而且兩個杯之間互相獨立，那麼假如根據機率公理第三條，可以算出：</p>
<p>P({正正}) = P(正) * P(正) = 0.6*0.6 = 0.36</p>
<p>P({正反}) = P(正) * P(反) = 0.6*0.4 = 0.24</p>
<p>P({反正}) = P(反) * P(正) = 0.4*0.6 = 0.24</p>
<p>P({反反}) = P(反) * P(反) = 0.4*0.4 = 0.16</p>
<p>所以</p>
<p>P(X=1) = P({正反, 反正}) = P({正反}) + P({反正}) = 0.24 + 0.24 = 0.48</p>
<p>P(X=0) = P({正正, 反反}) = P({正正}) + P({反反}) = 0.36 + 0.16 = 0.52</p>
</blockquote>
<p>習題 2：</p>
<blockquote>
<p>問題： 假如現在從你身上抽一滴血，請回答下列兩個問題。</p>
<ol style="list-style-type: decimal">
<li>請定義一個隨機變數 X 代表那滴血中的白血球數量。</li>
</ol>
<p>提示： 樣本空間 S = 此時此刻你身上的所有白血球 = {w1,w2,......,wn}</p>
<ol start="2" style="list-style-type: decimal">
<li>請算出一滴血液中有三顆白血球的機率，假設該滴血液占你總血量的 1/1000。</li>
</ol>
</blockquote>
<p>解答 1：</p>
<blockquote>
<p>X(A) = |A|</p>
<p>說明：</p>
<p>A 是一個事件，也就是白血球的樣本空間 S 的子集合，例如： A = {w1, w5, w9}</p>
<p>|A| 代表 A 集合的大小，也就是元素個數，舉例而言：</p>
<p>如果 A = {w1, w5, w9} ，那麼 |A| = 3</p>
<p>如果 B = {w2, w8}，那麼 |B| = 2</p>
<p>如果 C = {}，那麼 |C| = 0</p>
<p>如果 D = S，那麼 |D| = n</p>
</blockquote>
<p>解答 2：</p>
<blockquote>
<p>P(X=3) = P({A | X(A) = 3}) = P({{w1, w2, w3}) + P({w1, w2, w4}) + ......</p>
<p>假如任一顆白血球被抽到的機率等於該滴血液佔全身血液的比率，由於該滴血液佔總血量的 1/1000，所以給顆白血球被抽到的機率為 1/1000。</p>
<p>而且假設這些白血球沒有智慧，也不會聚合在一起，因此相互之間獨立，那麼由於每顆白血球被抽到的機率為 1/1000，因此 P(w1) = P(w2) = .... P(wn) = 1/1000。</p>
<p>那麼初步想法是 P(w1w3) = P(w1) * P(w3) = 1/1000 * 1/1000 。</p>
<p>但是上述的想法有個小問題，那就是該情況代表其它白血球都沒被抽到，因此所謂的 P(w1w3) 真正的意思應該是</p>
<div class="figure">
<img src="../timg/29e439b8a536.jpg" />
</div>
<p>所以 P(X=3) 應該算法如下：</p>
<div class="figure">
<img src="../timg/960d1fb7e15e.jpg" />
</div>
<p>推而廣之，P(X=k) 的機率之算法如下：</p>
<div class="figure">
<img src="../timg/c103f4ae13f5.jpg" />
</div>
<p>事實上，這個題目的機率分布就是下一章的二項分布，如下所示：</p>
<div class="figure">
<img src="../timg/c9c2c2819c48.jpg" />
</div>
<p>而且、當 n 趨近於無限大時，這個分布將會趨近於布瓦松分布，如下所示：</p>
<div class="figure">
<img src="../timg/9fde5316116c.jpg" />
</div>
<p>其中的 λ 之意義為，在單位時間 (或單位面積、體積) 內，事件的出現次數平均為 λ 次。</p>
</blockquote>
<h2 id="離散與連續"><a href="#離散與連續">離散與連續</a></h2>
<p>如果隨機變數 X 的取值是有限的或者是可數無窮盡的值，則稱 X 為離散隨機變數，如下所示：</p>
<div class="figure">
<img src="../timg/a9d0f02afe46.jpg" />
</div>
<p>如果 X 由全部實數或者由一部分區間組成，則稱 X 為連續隨機變數，連續隨機變數的值是不可數及無窮盡的。</p>
<div class="figure">
<img src="../timg/3dd1c60cebdc.jpg" />
</div>
<p>例如：擲骰子和丟銅版，都是離散型的隨機變數。而常態分布或均等分布，則是連續型的隨機變數之分布。</p>
<h2 id="機率密度函數-probabilistic-density-function"><a href="#機率密度函數-probabilistic-density-function">機率密度函數 (Probabilistic Density Function)</a></h2>
<blockquote>
<p><em>機率密度函數 (Probabilistic Density Function, PDF)</em></p>
<p>定義：機率密度函數則是一個符合機率公理的的函數 P，當我們寫 P[X=x] 時，意味著 x 是一個特定實數，其機率定義如下：</p>
<div class="figure">
<img src="../timg/90e5b3163e1d.jpg" />
</div>
<p>其中的 <img src="../timg/090614c64a0b.jpg" /> 乃是一個 S 的子集合，定義為 <img src="../timg/cb5f74544bb4.jpg" /> 。</p>
</blockquote>
<p>舉例而言，P[X=2] 代表 <img src="../timg/4e0800f774a0.jpg" /> 的機率。</p>
<p>讓我們來看看更多的機率密度函數的範例。</p>
<p>範例 1：</p>
<blockquote>
<p>在投擲銅板的機率過程中，其樣本空間 S={正, 反} ，</p>
<p>而其中一個常見的隨機變數 X ，是用來計算銅板的正面數量，</p>
<p>也就是 X(正) =1, X(反) = 0。</p>
<p>此時，P[X=1] = P({正}) = 0.5，而 P[X=0] = P({反}) = 0.5</p>
</blockquote>
<p>範例 2：</p>
<blockquote>
<p>在投擲兩個銅板的機率過程中，其樣本空間 S={正正, 正反, 反正, 反反} ，</p>
<p>而其中一個常見的隨機變數 X ，是用來計算銅板的正面數量，</p>
<p>也就是 X(正正) =2, X(正反) = X(反正) = 1, X(反反) = 0。</p>
<p>P[X=2] = P({正正}) = 0.25 P[X=1] = P({正反,反正}) = 0.5 P[X=0] = P({反反}) = 0.25</p>
</blockquote>
<p>範例 3：</p>
<blockquote>
<p>在投擲骰子的機率過程中，其樣本空間 S={1點,2點,3點,4點,5點,6點}，</p>
<p>而其中一個常見的隨機變數 X ，是用來計算點數的，</p>
<p>也就是 X(1點) =1, X(2點) = 2, ... X(6點) = 6。</p>
<p>此時，P[X=1] = P[X=2] = ... = P[X=6] = 1/6。</p>
</blockquote>
<p>範例 4：</p>
<blockquote>
<p>在投擲骰子的機率過程中，其樣本空間 S={1點,2點,3點,4點,5點,6點}，</p>
<p>而其中一個不常見的隨機變數 Y ，是用來辨認偶數點的，</p>
<p>也就是 Y(1點) =0, Y(2點) = 1, Y(3點) = 0, Y(4點) = 1, Y(5點) = 0, Y(6點) = 1。</p>
<p>此時，P[Y=1] = P[Y=0]= 1/2。</p>
</blockquote>
<h2 id="累加分配函數-cumulative-distribution-function"><a href="#累加分配函數-cumulative-distribution-function">累加分配函數 (Cumulative Distribution Function)</a></h2>
<p>有了上述的「隨機變數」與「機率密度函數」之後，我們就可以很容易的定義「累加分配函數」這種在「實數值」上的概念了。</p>
<blockquote>
<p><em>累加分配函數 (Cumulative Distribution Function, CDF)</em></p>
<p>定義：累加分配函數 F(x) 代表所有小於 x 的機率密度函數之累加值 <img src="../timg/c77c25f5b694.jpg" /></p>
<p>離散情況： <img src="../timg/264c3e6908a4.jpg" /></p>
<p>連續情況： <img src="../timg/b6ec0d86413d.jpg" /></p>
<p>為了方便起見，我們經常會將 P[X=1] 簡寫成 P(1) 或 f(1)，P[X=x] 簡寫成 P(x) 或 f(x)。 所以上面公式中的 P(x) 是離散情況中機率密度函數 P[X=x] 的簡寫，而 f(x) 是連續情況中 P[X=x] 的簡寫。</p>
</blockquote>
<h2 id="隨機變數的代數運算"><a href="#隨機變數的代數運算">隨機變數的代數運算</a></h2>
<p>在單一個樣本空間 S 中，可以有很多不同的隨機變數 X, Y, ... ，因為將 S 映射到 R 的函數有很多，例如：</p>
<blockquote>
<ol style="list-style-type: decimal">
<li><p>X(s) 其中 <img src="../timg/61caaef9bb60.jpg" /></p></li>
<li><p>Y(s) 其中 <img src="../timg/adb64c866c7a.jpg" /></p></li>
<li><p>...</p></li>
</ol>
</blockquote>
<p>在機率統計中，我們經常看到隨機變數可以像數值一樣進行 +, -, * 等運算。舉例而言，假如 X, Y 均為隨機變數，那麼 「X+Y」, 「X-Y」, 「X*Y」 等都是隨機變數。</p>
<p>但是在前文中，我們看到了隨機變數其實被定義為一個「實數值函數」 <img src="../timg/9a4b480355ff.jpg" /> ，那麼這些 +, -, * 等運算就是在函數上所進行的運算，這些運算的函意到底是甚麼呢？</p>
<h3 id="x-的意義"><a href="#x-的意義">3X 的意義</a></h3>
<p>隨機變數 3X 代表的是一個函數 Z=3X，其中 Z 函數對每一個元素 s 的映射值均為 X 的 3 倍，也就是：</p>
<blockquote>
<p>Z(s) = 3 * X(s)</p>
</blockquote>
<p>範例：</p>
<blockquote>
<p>問題：令 X 為擲骰子點數的隨機變數，也就是 X(k點)=k (k=1..6)，那麼隨機變數 3X 代表的是 Z(k點)=3*X(k點)=3k 這個函數。</p>
<p>根據這樣的表示方法，如果 Z = 3X，那麼請計算下列機率值。</p>
<ol style="list-style-type: decimal">
<li>請問 P[Z=3] = ?, (答案為1/6)</li>
<li>請問 P[Z=1] = ?, (答案為0)</li>
<li>請問 P[Z=18] = ?, (答案為1/6)</li>
<li>請問 P[Z=5] = ?, (答案為0)</li>
</ol>
</blockquote>
<p>範例：</p>
<blockquote>
<p>問題：令 X 為丟銅板所得正面次數的隨機變數，也就是 X(正)=1, X(反)=0，那麼隨機變數 Z=3X 代表的是 Z(正)=3，Z(反)=0 這個函數。</p>
</blockquote>
<h3 id="xy-的意義"><a href="#xy-的意義">X+Y 的意義</a></h3>
<p>隨機變數 X+Y 代表的是一個函數 Z=X+Y，其中 Z 函數對每一個元素 s 的映射值均為 X + Y 的映射值總和，也就是：Z(s) = X(s)+Y(s)</p>
<p>範例：</p>
<blockquote>
<p>令 X, Y 均為為擲骰子點數的隨機變數，也就是 X(k點)=Y(k點)=k (k=1..6)，那麼 X+Y 代表的是隨機變數 Z(k點)=2k 這個隨機變數。</p>
</blockquote>
<p>範例：</p>
<blockquote>
<p>問題：令 X 為擲骰子點數的隨機變數，Y 為丟銅板所得正面次數的隨機變數，那麼 X+Y 這個隨機變數代表甚麼意義呢？</p>
<p>解答：這兩個隨機變數的定義域不同，因此不能相加，但是若我們將定義域擴展為聯合分布，那麼就可以相加。</p>
<p>在這個範例中，X 與 Y 兩者的定義域 SX, SY 並不相同，因此必須用聯合隨機分布的概念，也就是同時投擲一顆骰子與一個銅板，才能有效說明 X+Y 的意義。</p>
<p>對於定義域不同的兩個隨機變數而言，其樣本空間可用兩者的「笛卡兒」乘積代表，也就是 SX = {1點,...., 6點} , 而 SY = {正, 反}。</p>
<p>此時 X+Y 所在的樣本空間，必須解釋為 {1點,...., 6點} 與 {正, 反} 兩者的笛卡兒乘積，總共有 12 種可能，聯合分布的樣本空間 S 如下所示。</p>
</blockquote>
<p>S = <img src="../timg/28b539f1eb77.jpg" /> = { (1點, 正), (1點,反), (2點, 正), (2點,反), ....(6點, 正), (6點,反)}</p>
<p>因此，Z = X+Y 所代表的隨機變數，其實是一個 Z 函數，該函數將 <img src="../timg/28b539f1eb77.jpg" /> 映射到實數 R 中，其中的 X 作用在 <img src="../timg/ad30194f40fc.jpg" /> 上，而 Y 作用在 <img src="../timg/d7f8bb33070e.jpg" /> 上，也就是： Z(s) = Z(x, y) = X(x)+Y(y)</p>
<p>所以，P(Z=2) 也可以寫成 P(X+Y = 2) ，也就是 P({(1點, 正), (2點,反)})，因此 P(Z=2) 的機率為 2/12 = 1/6。</p>
<h3 id="x-y-的意義"><a href="#x-y-的意義">X Y 的意義</a></h3>
<p>隨機變數 X Y 代表的是一個函數 Z=X Y，其中 Z 函數對每一個元素 s 的映射值均為 X Y 的映射值乘積，也就是：</p>
<p>Z(s) = X(s) Y(s)</p>
<p>範例：</p>
<blockquote>
<p>問題：令 X 為擲骰子點數的隨機變數，Y 為丟銅板所得正面次數的隨機變數，那麼 X Y 這個隨機變數代表甚麼意義呢？</p>
<p>解答：這兩個隨機變數的定義域不同，因此不能相加，但是若我們將定義域擴展為聯合分布，那麼就可以相加。</p>
<p>同上一個範例，X 與 Y 兩者的定義域 <img src="../timg/28b539f1eb77.jpg" /> 並不相同，樣本空間仍然用其「笛卡兒」乘積代表。</p>
<p>S = <img src="../timg/28b539f1eb77.jpg" /> = { (1點, 正), (1點,反), (2點, 正), (2點,反), ....(6點, 正), (6點,反)}</p>
</blockquote>
<p>因此，Z = X Y 所代表的隨機變數，其實是一個 Z 函數，該函數將 <img src="../timg/28b539f1eb77.jpg" /> 映射到實數 R 中，其中的 X 作用在 <img src="../timg/ad30194f40fc.jpg" /> 上，而 Y 作用在 <img src="../timg/d7f8bb33070e.jpg" /> 上。</p>
<p>所以，P(Z=2) 也可以寫成 P(X Y = 2) ，也就是 P({(2點, 正)}) ，因此 P(Z=2) 的機率為 1/12。</p>
<h3 id="xk-的意義"><a href="#xk-的意義">X^k 的意義</a></h3>
<p>隨機變數 <img src="../timg/fd221a37cf78.jpg" /> 代表的是一個函數 <img src="../timg/2aaed0e73d1e.jpg" /> ，其中 Z 函數對每一個元素 s 的映射值均為 X(s) 的 k 次方，也就是： <img src="../timg/2716952f83e6.jpg" /></p>
<blockquote>
<p>範例：X 為投擲 1 顆骰子點數的隨機變數，且定義 <img src="../timg/d93216cda5b4.jpg" /> ，請問隨機變數 P(Z=4) 的機率為何？</p>
<p>解答：</p>
<div class="figure">
<img src="../timg/f8cd594af966.jpg" />
</div>
<p>所以 P(Z=4) 相當於 P(X=2) = P({2點}) = 1/6</p>
<p>但必須注意的是 Z 的定義域雖仍然為 ({1點,...., 6點})，但是值域卻為 1,4,9,16,25,36。</p>
</blockquote>
<h2 id="結語"><a href="#結語">結語</a></h2>
<p>隨機變數 X, Y, Z, ... 乃是一種作用於樣本空間 S 的實函數，此種函數會將樣本點映射到實數中，例如： <img src="../timg/9a4b480355ff.jpg" /> 代表函數 X 將樣本空間中的元素 s 映射到某個實數值 x。</p>
<p>利用隨機變數映射完成之後，就可以比較大小，因此可以計算「機率密度函數」與「累加分配函數」，這樣就能利用加總或積分去計算某個區間內的機率，讓機率模型得以進行數學性的運算。</p>
<p>我想這是為甚麼數學家要將隨機變數定義成實函數的原因之一吧！</p>
<h1 id="機率分布"><a href="#機率分布">機率分布</a></h1>
<h2 id="簡介-2"><a href="#簡介-2">簡介</a></h2>
<p>在程式設計領域，「設計模式」是一些經常被使用到的物件樣式，而在數學領域，也同樣存在著某些「常見模式」，在機率統計領域，這些「常見模式」就是機率分布。</p>
<p>機率分布可以分為「離散型」與「連續型」兩類，離散型的機率分布通常只會有整數型的值，而連續型的機率分布則在整個實數軸上都可能產生樣本。</p>
<h2 id="伯努力試驗-bernoulli-trial"><a href="#伯努力試驗-bernoulli-trial">伯努力試驗 (Bernoulli trial)</a></h2>
<p>所有的離散型機率分布，幾乎都是從「伯努力試驗」這個概念開始的，讓我們先來瞭解一下何謂「伯努力試驗」。</p>
<p>伯努利試驗是一項只有兩種可能結果的隨機試驗，可以用下列機率分布描述：</p>
<div class="figure">
<img src="../timg/d13f10f0dd92.jpg" />
</div>
<p>換句話說、伯努力試驗是一種 YES or NO (1 or 0) 的試驗。舉例而言，像是「丟銅版、生男生女、一地區某天最高溫是否超過 30 度、擲骰子是否超過 2 點」等等，都可以用伯努力實驗描述。</p>
<p>伯努力試驗的概念很簡單，以下是一些範例：</p>
<p>範例 1 :</p>
<blockquote>
<p>丟一個公正銅板，用隨機變數 X 將正面映射為 1 ，反面映射為 0，那麼就可以用 P[X=1]=0.5, P[X=0]=0.5 表示這個機率模型。</p>
</blockquote>
<p>在 R 軟體中， Sample 函數可以用來模仿柏努力試驗。</p>
<p>舉例而言，以下是範例一的丟銅板試驗，指令 sample(0:1, 10, replace=T, prob=c(0.5,0.5)) 代表連續進行 10 次柏努力試驗，成功失敗機率各為 0.5。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">sample</span>(<span class="dv">0</span>:<span class="dv">1</span>, <span class="dv">10</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>, <span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.5</span>,<span class="fl">0.5</span>))
 [<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span>
&gt;<span class="st"> </span><span class="kw">sample</span>(<span class="dv">0</span>:<span class="dv">1</span>, <span class="dv">10</span>, <span class="dt">replace=</span>T)
 [<span class="dv">1</span>] <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span></code></pre>
<p>說明：X(反面)=0, X(正面)=1, 第一個參數 0:1 分別代表 {反面、正面} 的映射結果，而第二個參數代表只投擲一次，第三個參數 replace 代表樣本取後是否放回，這在頭銅板的範例必須用 replace=TRUE, 因為這次投正面之後不代表下次不能再出現正面，而 prob 則是指定的機率分布，如果不指定則代表採用平分的機率分布，以這個例子就是各為 0.5 的方式。</p>
<p>範例 2 :</p>
<blockquote>
<p>假如用機率描述生男生女這件事， X({生男})=1, X({生女})=0, 且生男生的機率為 0.53, 生女生的機率為 0.47，那麼就可以用 P[X=1]=0.53, P[X=0]=0.47 表示這個機率模型。</p>
</blockquote>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">sample</span>(<span class="dv">0</span>:<span class="dv">1</span>, <span class="dv">10</span>, <span class="dt">replace=</span>T, <span class="dt">prob=</span><span class="kw">c</span>(<span class="fl">0.47</span>, <span class="fl">0.53</span>))
 [<span class="dv">1</span>] <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">0</span></code></pre>
<h2 id="二項分布-binomial-distribution"><a href="#二項分布-binomial-distribution">二項分布 (Binomial distribution)</a></h2>
<p>如果我們進行 n 次的伯努力試驗，每一次的實驗都可以用隨機變數描述， P(ti=1) = p, P(ti=0)=1-p ，而且這些試驗 {t1, t2, ...., tn} 之間是獨立的，那麼我們就可以用二項分布來描述 n 次實驗的可能機率分布。</p>
<p>由於這 n 次實驗相互獨立，假如 (t1 t2 ... tn) 代表這個實驗的一個可能出像，因此 P(t1 t2 .... tn) = P(t1) P(t2) .... P(tn)。</p>
<p>令 X 代表一個可以將 (t1 t2 ... tn) 映射到伯努力試驗成功 (Yes) 次數的函數，那麼、n 次實驗中出現 k 次 1 的機會，可以用以下算式表示。</p>
<div class="figure">
<img src="../timg/caf280e86ba3.jpg" />
</div>
<p>舉例而言，投擲公正銅板 5 次，得到 3 次正面的機率為 <img src="../timg/ccd492ad234f.jpg" /> ，其中 p=0.5。</p>
<p>範例：</p>
<blockquote>
<p>假如生男生的機率為 0.53, 生女生的機率為 0.47，而且每位母親生男生女的事件之間都是獨立的。</p>
<p>某母親 A 想要生 3 個小孩，請問至少有一個男生的機會為多少。</p>
<p>用機率描述生男生女這件事， X({生男})=1, X({生女})=0, 那麼可以計算至少生一個男生的機率如下：</p>
<p><img src="../timg/f2f255758208.jpg" /> ，其中 p = 0.53, (1-p) = 0.47。</p>
</blockquote>
<p>讓我們用 R 軟體計算一下</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">dbinom</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="fl">0.53</span>)+<span class="kw">dbinom</span>(<span class="dv">2</span>,<span class="dv">3</span>, <span class="fl">0.53</span>)+<span class="kw">dbinom</span>(<span class="dv">3</span>,<span class="dv">3</span>,<span class="fl">0.53</span>)
[<span class="dv">1</span>] <span class="fl">0.896177</span>
&gt;<span class="st"> </span><span class="kw">sum</span>(<span class="kw">dbinom</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>), <span class="dv">3</span>, <span class="fl">0.53</span>))
[<span class="dv">1</span>] <span class="fl">0.896177</span>
&gt;<span class="st"> </span>x=<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>)
&gt;<span class="st"> </span>x
[<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>
&gt;<span class="st"> </span>p=<span class="kw">dbinom</span>(x, <span class="dv">3</span>, <span class="fl">0.53</span>)
&gt;<span class="st"> </span>p
[<span class="dv">1</span>] <span class="fl">0.351231</span> <span class="fl">0.396069</span> <span class="fl">0.148877</span>
&gt;<span class="st"> </span><span class="kw">sum</span>(p)
[<span class="dv">1</span>] <span class="fl">0.896177</span></code></pre>
<h3 id="二項分布的圖形"><a href="#二項分布的圖形">二項分布的圖形</a></h3>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))
&gt;<span class="st"> </span>x =<span class="st"> </span><span class="dv">0</span>:<span class="dv">5</span>
&gt;<span class="st"> </span>b5 =<span class="st"> </span><span class="kw">dbinom</span>(x, <span class="dv">5</span>, <span class="fl">0.5</span>)
&gt;<span class="st"> </span><span class="kw">plot</span>(x, b5, <span class="dt">type=</span><span class="st">&quot;h&quot;</span>)
&gt;<span class="st"> </span>b3 =<span class="st"> </span><span class="kw">dbinom</span>(x, <span class="dv">5</span>, <span class="fl">0.3</span>)
&gt;<span class="st"> </span><span class="kw">plot</span>(x, b3, <span class="dt">type=</span><span class="st">&quot;h&quot;</span>)
&gt;<span class="st"> </span>b7 =<span class="st"> </span><span class="kw">dbinom</span>(x, <span class="dv">5</span>, <span class="fl">0.7</span>)
&gt;<span class="st"> </span><span class="kw">plot</span>(x, b7, <span class="dt">type=</span><span class="st">&quot;h&quot;</span>)
&gt;<span class="st"> </span>b1 =<span class="st"> </span><span class="kw">dbinom</span>(x, <span class="dv">5</span>, <span class="fl">0.1</span>)
&gt;<span class="st"> </span><span class="kw">plot</span>(x, b1, <span class="dt">type=</span><span class="st">&quot;h&quot;</span>)</code></pre>
<div class="figure">
<img src="../img/plotBinom.jpg" />
</div>
<h3 id="習題-1"><a href="#習題-1">習題</a></h3>
<ol style="list-style-type: decimal">
<li>請問丟 10 個公平的銅板，有三個正面的機會是多少？</li>
<li>請問丟 n 個公平的銅板，正面次數 &lt;= k 的機率是多少？</li>
<li>請問丟 10 個公平的銅板，得到正面次數的期望值為何？</li>
</ol>
<h2 id="幾何分布-geometric-distribution"><a href="#幾何分布-geometric-distribution">幾何分布 (Geometric distribution)</a></h2>
<p>如果我們連續進行一系列的伯努力試驗，直到成功才停止，那麼我們需要進行多少次實驗呢？</p>
<p>關於這種「直到成功才停止」的問題，可以用幾何分布來描述，以下是幾何分布的定義。</p>
<div class="figure">
<img src="../timg/9ff5b7c8b2b5.jpg" />
</div>
<p>舉例而言，假如我們連續投擲公正銅版，直到出現正面才停止，那麼我們需要投擲 k 次才會得到第一個正面的機率，就會是 <img src="../timg/8e6c6a1c01e1.jpg" /> ，其中的 p=0.5。</p>
<p>範例：</p>
<blockquote>
<p>假如生男生的機率為 0.53, 生女生的機率為 0.47，而且每位母親生男生女的事件之間都是獨立的。</p>
<p>某位母親決定要一直生小孩，直到有一個女孩為止，請問她在生小孩個數不大於三個就能完成任務的機率為多少？</p>
<p>用機率描述生男生女這件事， X({生女})=1, X({生男})=0, 那麼就可以累加下列算式以計算結果。</p>
<div class="figure">
<img src="../timg/1ffe2e755a44.jpg" />
</div>
</blockquote>
<p>讓我們用 R 軟體計算一下，必須注意的是，R 軟體中的幾何分布 dgeom 的定義為 <img src="../timg/0d77b33676f5.jpg" /> ，也就是用失敗次數當 x，因此其公式與上面的有所不同，必須修改如下：(其中的 x 代表失敗次數)。</p>
<div class="figure">
<img src="../timg/de498aade9e6.jpg" />
</div>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">dgeom</span>(<span class="dv">0</span>, <span class="fl">0.47</span>)
[<span class="dv">1</span>] <span class="fl">0.47</span>
&gt;<span class="st"> </span><span class="kw">dgeom</span>(<span class="dv">1</span>, <span class="fl">0.47</span>)
[<span class="dv">1</span>] <span class="fl">0.2491</span>
&gt;<span class="st"> </span><span class="kw">sum</span>(<span class="kw">dgeom</span>(<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>), <span class="fl">0.47</span>))
[<span class="dv">1</span>] <span class="fl">0.851123</span></code></pre>
<h3 id="習題-2"><a href="#習題-2">習題</a></h3>
<ol style="list-style-type: decimal">
<li><p>請問丟公平的銅板時，得到第 1 次正面時投擲次數 k 的機率分布為何？該分布的期望值為何？</p></li>
<li><p>請問丟公正的骰子時，得到第 1 次 6 點時投擲次數 k 的機率分布為何？該分布的期望值為何？</p></li>
</ol>
<h2 id="負二項分布"><a href="#負二項分布">負二項分布</a></h2>
<p>如果我們對「幾何分布」進行擴充，改成「持續進行試驗直到取得 r 次成功為止」，那麼其機率分布又該如何描述呢？</p>
<p>這樣的機率分布就稱為負二項分布，其公式如下：</p>
<div class="figure">
<img src="../timg/b7b3eb3c2c87.jpg" />
</div>
<p>舉例而言，假如我們連續投擲公正銅版，直到出現三次正面才停止，那麼我們需要投擲 k 次才會得到第一個正面的機率，就會是 <img src="../timg/bd9c8ad370de.jpg" /> ，其中的 p=0.5。</p>
<p>讓我們用 R 軟體計算一下，必須注意的是，R 軟體中的負二項分布 dbinom 的定義為 Γ(x+n)/(Γ(n) x!) p^n (1-p)^x ，也就是用 n=r, x=k-r-1 的代換方式。</p>
<p>其中的 x 同樣代表失敗次數，而 n 代表成功次數，Γ(n) 代表排列數，所以 Γ(x+n)/(Γ(n) x!) 其實也就是 (x+n-1)!/((n-1)! x!) ，也就是 <img src="../timg/cf848d4afb68.jpg" /> 的意思。</p>
<p>R 的操作範例</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">dnbinom</span>(<span class="dv">0</span>, <span class="dv">3</span>, <span class="fl">0.5</span>)
[<span class="dv">1</span>] <span class="fl">0.125</span>
&gt;<span class="st"> </span><span class="kw">dnbinom</span>(<span class="dv">1</span>, <span class="dv">3</span>, <span class="fl">0.5</span>)
[<span class="dv">1</span>] <span class="fl">0.1875</span>
&gt;<span class="st"> </span><span class="kw">dnbinom</span>(<span class="dv">0</span>:<span class="dv">10</span>, <span class="dv">3</span>, <span class="fl">0.5</span>)
 [<span class="dv">1</span>] <span class="fl">0.125000000</span> <span class="fl">0.187500000</span> <span class="fl">0.187500000</span> <span class="fl">0.156250000</span> <span class="fl">0.117187500</span> <span class="fl">0.082031250</span>
 [<span class="dv">7</span>] <span class="fl">0.054687500</span> <span class="fl">0.035156250</span> <span class="fl">0.021972656</span> <span class="fl">0.013427734</span> <span class="fl">0.008056641</span>
&gt;<span class="st"> </span>n=<span class="dv">3</span>
&gt;<span class="st"> </span>x=<span class="dv">1</span> 
&gt;<span class="st"> </span>p=<span class="fl">0.5</span>
&gt;<span class="st"> </span><span class="kw">gamma</span>(x+n)/(<span class="kw">gamma</span>(n)*<span class="kw">prod</span>(<span class="dv">1</span>:x)) *<span class="st"> </span>p^n *<span class="st"> </span>(<span class="dv">1</span>-p)^x
[<span class="dv">1</span>] <span class="fl">0.1875</span>
&gt;<span class="st"> </span><span class="kw">choose</span>(x+n, n) *<span class="st"> </span>p^n *<span class="st"> </span>(<span class="dv">1</span>-p)^x
[<span class="dv">1</span>] <span class="fl">0.25</span>
&gt;<span class="st"> </span><span class="kw">choose</span>(x+n<span class="dv">-1</span>, x) *<span class="st"> </span>p^n *<span class="st"> </span>(<span class="dv">1</span>-p)^x
[<span class="dv">1</span>] <span class="fl">0.1875</span></code></pre>
<p>範例：</p>
<blockquote>
<p>假如生男生的機率為 0.53, 生女生的機率為 0.47，而且每位母親生男生女的事件之間都是獨立的。</p>
<p>某位母親決定要一直生小孩，直到有三個女孩為止，請問她在生小孩個數不大於 5 個就能完成任務的機率為多少？</p>
<p>用機率描述生男生女這件事， X({生女})=1, X({生男})=0, 那麼就可以累加下列算式以計算結果。</p>
<p><img src="../timg/d6c5556feae1.jpg" /> , 其中 p=0.47, r=3。</p>
</blockquote>
<p>但是由於 R 是用失敗次數</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">dnbinom</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="fl">0.47</span>)
[<span class="dv">1</span>] <span class="fl">0.1545686</span>
&gt;<span class="st"> </span><span class="kw">dnbinom</span>(<span class="dv">4</span>, <span class="dv">3</span>, <span class="fl">0.47</span>)
[<span class="dv">1</span>] <span class="fl">0.122882</span>
&gt;<span class="st"> </span>p=<span class="kw">dnbinom</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>), <span class="dv">3</span>, <span class="fl">0.47</span>)
&gt;<span class="st"> </span>p
[<span class="dv">1</span>] <span class="fl">0.15456857</span> <span class="fl">0.12288201</span> <span class="fl">0.09117845</span>
&gt;<span class="st"> </span><span class="kw">sum</span>(p)
[<span class="dv">1</span>] <span class="fl">0.368629</span></code></pre>
<h3 id="負二項分布的圖形"><a href="#負二項分布的圖形">負二項分布的圖形</a></h3>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))
&gt;<span class="st"> </span>nb5 =<span class="st"> </span><span class="kw">dnbinom</span>(x, <span class="dv">5</span>, <span class="fl">0.5</span>)
&gt;<span class="st"> </span><span class="kw">plot</span>(nb5, <span class="dt">type=</span><span class="st">&quot;h&quot;</span>)
&gt;<span class="st"> </span>nb7 =<span class="st"> </span><span class="kw">dnbinom</span>(x, <span class="dv">5</span>, <span class="fl">0.7</span>)
&gt;<span class="st"> </span><span class="kw">plot</span>(nb7, <span class="dt">type=</span><span class="st">&quot;h&quot;</span>)
&gt;<span class="st"> </span>nb2 =<span class="st"> </span><span class="kw">dnbinom</span>(x, <span class="dv">5</span>, <span class="fl">0.2</span>)
&gt;<span class="st"> </span><span class="kw">plot</span>(nb2, <span class="dt">type=</span><span class="st">&quot;h&quot;</span>)
&gt;<span class="st"> </span>nb9 =<span class="st"> </span><span class="kw">dnbinom</span>(x, <span class="dv">5</span>, <span class="fl">0.9</span>)
&gt;<span class="st"> </span><span class="kw">plot</span>(nb9, <span class="dt">type=</span><span class="st">&quot;h&quot;</span>)</code></pre>
<div class="figure">
<img src="../img/plotNbinom.jpg" />
</div>
<h2 id="布瓦松分布-poisson-distribution"><a href="#布瓦松分布-poisson-distribution">布瓦松分布 (Poisson distribution)</a></h2>
<p>在離散機率分布當中，布瓦松分布算是相當特別的一個，因為「布瓦松分布」是描述「連續區域內出現幾個樣本」的分布。舉例而言，像是舀一瓢水會撈到的草履蟲數量，或者抽一滴血會抽到的白血球數量等等。</p>
<p>布瓦松分布的公式如下所示，其中的 <img src="../timg/c6a6eb61fd9c.jpg" /> 代表每單位區域內會出現的樣本平均數。</p>
<div class="figure">
<img src="../timg/9fde5316116c.jpg" />
</div>
<p>要瞭解布瓦松分布，得從二項分布的極限開始想起，以下是三種不同 <img src="../timg/c6a6eb61fd9c.jpg" /> 參數的布瓦松分布圖：</p>
<div class="figure">
<img src="../img/PoissonCurve.jpg" alt="圖、布瓦松分布來源：http://en.wikipedia.org/wiki/Poisson_distribution" /><p class="caption">圖、布瓦松分布<BR/>來源：<a href="http://en.wikipedia.org/wiki/Poisson_distribution">http://en.wikipedia.org/wiki/Poisson_distribution</a></p>
</div>
<p>事實上、布瓦松分布是二項分布在 n 趨近無限大的極限情況。</p>
<div class="figure">
<img src="../img/PoissonVsBinomial.jpg" alt="圖、布瓦松分布是二項分布 n 趨近無限大的極限情況來源：http://en.wikipedia.org/wiki/File:Binomial_versus_poisson.svg" /><p class="caption">圖、布瓦松分布是二項分布 n 趨近無限大的極限情況<BR/>來源：<a href="http://en.wikipedia.org/wiki/File:Binomial_versus_poisson.svg">http://en.wikipedia.org/wiki/File:Binomial_versus_poisson.svg</a></p>
</div>
<p>為了說明布瓦松分布與二項分布之間的關係，讓我們用以下的白血球範例來看看隱藏在這兩個分布背後的關係：</p>
<p>範例：抽血時白血球數量的問題</p>
<blockquote>
<p>問題： 假如現在從你身上抽一滴血，請回答下列兩個問題。</p>
<ol style="list-style-type: decimal">
<li>請定義一個隨機變數 X 代表那滴血中的白血球數量。</li>
</ol>
<p>提示： 樣本空間 S = 此時此刻你身上的所有白血球 = {w1,w2,......,wn}</p>
<ol start="2" style="list-style-type: decimal">
<li>請算出一滴血液中有三顆白血球的機率，假設該滴血液占你總血量的 1/1000。</li>
</ol>
</blockquote>
<p>解答 1：</p>
<blockquote>
<p>X(A) = |A|</p>
<p>說明：</p>
<p>A 是一個事件，也就是白血球的樣本空間 S 的子集合，例如： A = {w1, w5, w9}</p>
<p>|A| 代表 A 集合的大小，也就是元素個數，舉例而言：</p>
<p>如果 A = {w1, w5, w9} ，那麼 |A| = 3</p>
<p>如果 B = {w2, w8}，那麼 |B| = 2</p>
<p>如果 C = {}，那麼 |C| = 0</p>
<p>如果 D = S，那麼 |D| = n</p>
</blockquote>
<p>解答 2：</p>
<blockquote>
<p>P(X=3) = P({A | X(A) = 3}) = P({{w1, w2, w3}) + P({w1, w2, w4}) + ......</p>
<p>假如任一顆白血球被抽到的機率等於該滴血液佔全身血液的比率，由於該滴血液佔總血量的 1/1000，所以給顆白血球被抽到的機率為 1/1000。</p>
<p>而且假設這些白血球沒有智慧，也不會聚合在一起，因此相互之間獨立，那麼由於每顆白血球被抽到的機率為 1/1000，因此 P(w1) = P(w2) = .... P(wn) = 1/1000。</p>
<p>那麼初步想法是 P(w1w3) = P(w1) * P(w3) = 1/1000 * 1/1000 。</p>
<p>但是上述的想法有個小問題，那就是該情況代表其它白血球都沒被抽到，因此所謂的 P(w1w3) 真正的意思應該是</p>
<div class="figure">
<img src="../timg/29e439b8a536.jpg" />
</div>
<p>所以 P(X=3) 應該算法如下：</p>
<div class="figure">
<img src="../timg/960d1fb7e15e.jpg" />
</div>
<p>推而廣之，P(X=k) 的機率之算法如下：</p>
<div class="figure">
<img src="../timg/c103f4ae13f5.jpg" />
</div>
<p>事實上，這個題目的機率分布就是下一章的二項分布，如下所示：</p>
<div class="figure">
<img src="../timg/c9c2c2819c48.jpg" />
</div>
<p>而且、當 n 趨近於無限大時，這個分布將會趨近於布瓦松分布，如下所示：</p>
<div class="figure">
<img src="../timg/9fde5316116c.jpg" />
</div>
<p>其中的 λ 之意義為，在單位時間 (或單位面積、體積) 內，事件的出現次數平均為 λ 次。</p>
</blockquote>
<h3 id="習題-3"><a href="#習題-3">習題</a></h3>
<p>習題：假設每 1CC 的血所含的白血球平均為 10 顆，那麼請問你抽 1CC 的血時，抽到 8 顆白血球的機率是多少。</p>
<p>解答：</p>
<blockquote>
<p>λ = 10，因此布瓦松分布為 <img src="../timg/ce3620ab8f85.jpg" /> ，將 x=8 代入，得到 <img src="../timg/bce69f5aeddf.jpg" /></p>
</blockquote>
<p>其數值可以用 R 軟體計算，如下所示：</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>?dpois
&gt;<span class="st"> </span><span class="kw">dpois</span>(<span class="dv">8</span>, <span class="dv">10</span>)
[<span class="dv">1</span>] <span class="fl">0.112599</span>
&gt;<span class="st"> </span><span class="dv">10</span>^<span class="dv">8</span>*<span class="kw">exp</span>(-<span class="dv">10</span>)/<span class="kw">prod</span>(<span class="dv">1</span>:<span class="dv">8</span>)
[<span class="dv">1</span>] <span class="fl">0.112599</span></code></pre>
<h3 id="布瓦松分布的圖形"><a href="#布瓦松分布的圖形">布瓦松分布的圖形</a></h3>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))
&gt;<span class="st"> </span>x =<span class="st"> </span><span class="dv">0</span>:<span class="dv">10</span>
&gt;<span class="st"> </span>p3 =<span class="st"> </span><span class="kw">dpois</span>(x, <span class="dt">lambda=</span><span class="dv">3</span>)
&gt;<span class="st"> </span><span class="kw">plot</span>(p3, <span class="dt">type=</span><span class="st">&quot;h&quot;</span>)
&gt;<span class="st"> </span>p7 =<span class="st"> </span><span class="kw">dpois</span>(x, <span class="dt">lambda=</span><span class="dv">7</span>)
&gt;<span class="st"> </span><span class="kw">plot</span>(p7, <span class="dt">type=</span><span class="st">&quot;h&quot;</span>)
&gt;<span class="st"> </span>p1 =<span class="st"> </span><span class="kw">dpois</span>(x, <span class="dt">lambda=</span><span class="dv">1</span>)
&gt;<span class="st"> </span><span class="kw">plot</span>(p1, <span class="dt">type=</span><span class="st">&quot;h&quot;</span>)
&gt;<span class="st"> </span>p5 =<span class="st"> </span><span class="kw">dpois</span>(x, <span class="dt">lambda=</span><span class="dv">5</span>)
&gt;<span class="st"> </span><span class="kw">plot</span>(p5, <span class="dt">type=</span><span class="st">&quot;h&quot;</span>)</code></pre>
<div class="figure">
<img src="../img/plotPoisson.jpg" />
</div>
<h2 id="均勻分布-uniform-distribution"><a href="#均勻分布-uniform-distribution">均勻分布 (Uniform distribution)</a></h2>
<h3 id="均勻分布的圖形"><a href="#均勻分布的圖形">均勻分布的圖形</a></h3>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">dunif</span>(<span class="fl">0.5</span>)
[<span class="dv">1</span>] <span class="dv">1</span>
&gt;<span class="st"> </span><span class="kw">dunif</span>(<span class="fl">0.9</span>)
[<span class="dv">1</span>] <span class="dv">1</span>
&gt;<span class="st"> </span><span class="kw">dunif</span>(<span class="dv">2</span>)
[<span class="dv">1</span>] <span class="dv">0</span>
&gt;<span class="st"> </span><span class="kw">dunif</span>(-<span class="dv">1</span>)
[<span class="dv">1</span>] <span class="dv">0</span>
&gt;<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))
&gt;<span class="st"> </span>x=<span class="dv">0</span>:<span class="dv">10</span>
&gt;<span class="st"> </span><span class="kw">curve</span>(<span class="kw">dunif</span>(x, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">1</span>), <span class="dt">from=</span>-<span class="dv">1</span>, <span class="dt">to=</span><span class="dv">11</span>)
&gt;<span class="st"> </span><span class="kw">curve</span>(<span class="kw">dunif</span>(x, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">10</span>), <span class="dt">from=</span>-<span class="dv">1</span>, <span class="dt">to=</span><span class="dv">11</span>)
&gt;<span class="st"> </span><span class="kw">curve</span>(<span class="kw">dunif</span>(x, <span class="dt">min=</span><span class="dv">3</span>, <span class="dt">max=</span><span class="dv">6</span>), <span class="dt">from=</span>-<span class="dv">1</span>, <span class="dt">to=</span><span class="dv">11</span>)
&gt;<span class="st"> </span><span class="kw">curve</span>(<span class="kw">dunif</span>(x, <span class="dt">min=</span><span class="dv">2</span>, <span class="dt">max=</span><span class="dv">9</span>), <span class="dt">from=</span>-<span class="dv">1</span>, <span class="dt">to=</span><span class="dv">11</span>)</code></pre>
<div class="figure">
<img src="../img/curveUnif22.jpg" />
</div>
<h2 id="常態分布-normal-distribution"><a href="#常態分布-normal-distribution">常態分布 (Normal Distribution)</a></h2>
<h3 id="常態分布的圖形"><a href="#常態分布的圖形">常態分布的圖形</a></h3>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>)
[<span class="dv">1</span>] <span class="fl">0.3989423</span>
&gt;<span class="st"> </span><span class="kw">dnorm</span>(<span class="fl">0.5</span>)
[<span class="dv">1</span>] <span class="fl">0.3520653</span>
&gt;<span class="st"> </span><span class="kw">dnorm</span>(<span class="fl">2.5</span>)
[<span class="dv">1</span>] <span class="fl">0.0175283</span>
&gt;<span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))
&gt;<span class="st"> </span><span class="kw">curve</span>(<span class="kw">dnorm</span>(x, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">1</span>), <span class="dt">from=</span>-<span class="dv">10</span>, <span class="dt">to=</span><span class="dv">10</span>)
&gt;<span class="st"> </span><span class="kw">curve</span>(<span class="kw">dnorm</span>(x, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">5</span>), <span class="dt">from=</span>-<span class="dv">10</span>, <span class="dt">to=</span><span class="dv">10</span>)
&gt;<span class="st"> </span><span class="kw">curve</span>(<span class="kw">dnorm</span>(x, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">1</span>), <span class="dt">from=</span>-<span class="dv">10</span>, <span class="dt">to=</span><span class="dv">10</span>)
&gt;<span class="st"> </span><span class="kw">curve</span>(<span class="kw">dnorm</span>(x, <span class="dt">mean=</span>-<span class="dv">3</span>, <span class="dt">sd=</span><span class="dv">3</span>), <span class="dt">from=</span>-<span class="dv">10</span>, <span class="dt">to=</span><span class="dv">10</span>)</code></pre>
<div class="figure">
<img src="../img/curveNorm22.jpg" />
</div>
<h2 id="附件離散型機率分布表格整理"><a href="#附件離散型機率分布表格整理">附件：離散型機率分布表格整理</a></h2>
<p>以下是離散型機率分布的匯總表格，讀者現在還看不懂的話沒有關係，我們在後文中會解說其中較重要的幾個分布。</p>
<table>
<thead>
<tr class="header">
<th align="left">離散機率模型</th>
<th align="left">密度函數</th>
<th align="left">R 函數名稱</th>
<th align="left">說明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">二項分布</td>
<td align="left"><img src="../timg/9474fc44e360.jpg" /></td>
<td align="left">binom(n:size, p:prob)</td>
<td align="left">n:樣本數, p:正面機率, <br/> n 次試驗中有 x 個成功的機率</td>
</tr>
<tr class="even">
<td align="left">多項分布</td>
<td align="left"><img src="../timg/8a0544157d79.jpg" /></td>
<td align="left">multinom(n:size, p(1..k):prob)</td>
<td align="left">n:樣本數, p[1..n]:各項的機率</td>
</tr>
<tr class="odd">
<td align="left">負二項分布</td>
<td align="left"><img src="../timg/c77b7e7c5cb0.jpg" /></td>
<td align="left">nbinom(size, prob)</td>
<td align="left">x:樣本數, , p:正面機率, <br/> 要得到第 r 次成功所需要的試驗次數</td>
</tr>
<tr class="even">
<td align="left">幾何分布</td>
<td align="left"><img src="../timg/5659648f10e2.jpg" /></td>
<td align="left">geom(p:prob)</td>
<td align="left">p: 成功機率, 第一次成功所需要的試驗次數</td>
</tr>
<tr class="odd">
<td align="left">超幾何分布</td>
<td align="left"><img src="../timg/e0b0e13f6298.jpg" /></td>
<td align="left">hyper(N:m,n:n,r:k)</td>
<td align="left">m:白球數量, n:黑球數量, k:抽出球數, <br/> 同二項分布，但取樣後不放回</td>
</tr>
<tr class="even">
<td align="left">布瓦松分布</td>
<td align="left"><img src="../timg/1960dc6e970a.jpg" /></td>
<td align="left">pois(lambda)</td>
<td align="left">k:期望值, <img src="../timg/cc7b6d325f41.jpg" /> , <br/> 在 s 時間內，事件出現平均 k 次</td>
</tr>
</tbody>
</table>
<h2 id="附件連續型機率分布表格整理"><a href="#附件連續型機率分布表格整理">附件：連續型機率分布表格整理</a></h2>
<p>以下是連續型機率分布的匯總表格，讀者現在還看不懂的話沒有關係，我們在後文中會解說其中較重要的幾個分布。</p>
<table>
<thead>
<tr class="header">
<th align="left">連續機率模型</th>
<th align="left">密度函數</th>
<th align="left">R 函數</th>
<th align="left">說明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">均勻分布 (Uniform)</td>
<td align="left"><img src="../timg/d199631f1413.jpg" /></td>
<td align="left">unif(a:min, b:max)</td>
<td align="left">a:範圍下限, b: 上限 <br/> 出現機會均等</td>
</tr>
<tr class="even">
<td align="left">常態分布(Normal)</td>
<td align="left"><img src="../timg/b0aca724e39e.jpg" /></td>
<td align="left">norm(mean, sd)</td>
<td align="left">中央極限定理：x1+x2+...+xk; 當 k 越大就越接近常態分布</td>
</tr>
<tr class="odd">
<td align="left">伽瑪分布 (Gamma)</td>
<td align="left"><img src="../timg/7a2f5a287065.jpg" /></td>
<td align="left">gamma(shape, rate = 1, scale = 1/rate)</td>
<td align="left"><img src="../timg/c63269e21148.jpg" /> <br/> 指數分布與卡方分布都是 Gamma 分布的特例</td>
</tr>
<tr class="even">
<td align="left">指數分布 (Exponential)</td>
<td align="left"><img src="../timg/71075ebb0855.jpg" /></td>
<td align="left">exp(rate)</td>
<td align="left">伽瑪分布( <img src="../timg/ad965fa877cb.jpg" /> ) <br/> 布瓦松過程中，第一次事件出現的時間 W</td>
</tr>
<tr class="odd">
<td align="left">卡方分布 (Chi-Square)</td>
<td align="left"><img src="../timg/1c1902be8fc6.jpg" /></td>
<td align="left">chisq(df, ncp)</td>
<td align="left">伽瑪分布( <img src="../timg/10fe70a365dc.jpg" /> ) <br/> 利用樣本推斷母體變異數</td>
</tr>
<tr class="even">
<td align="left">柯西分布 (Cauchy)</td>
<td align="left"><img src="../timg/868c8083bf08.jpg" /></td>
<td align="left">cauchy(b:location, a:scale)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">威布爾分布 (Weibull)</td>
<td align="left"><img src="../timg/d1d29714916b.jpg" /></td>
<td align="left">weibull(a:shape, b:scale)</td>
<td align="left"><img src="../timg/787bf9141c33.jpg" /> <br/> 可靠度工程：f(x) 失敗時間, R(t) 可靠度, <img src="../timg/5cba230c35b4.jpg" /> 失敗率</td>
</tr>
<tr class="even">
<td align="left">T 分布 (T)</td>
<td align="left"><img src="../timg/47685e30d909.jpg" /></td>
<td align="left">t(df, ncp)</td>
<td align="left">估計變異數時使用的分布</td>
</tr>
<tr class="odd">
<td align="left">F 分布 (F)</td>
<td align="left"><img src="../timg/984c910d56d9.jpg" /></td>
<td align="left">f(df1, df2, ncp)</td>
<td align="left">等變異數 F 檢定時使用</td>
</tr>
<tr class="even">
<td align="left">貝塔分布 (Beta)</td>
<td align="left"></td>
<td align="left">beta(a:shape1, b:shape2, ncp)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">對數常態分布 (Log Normal)</td>
<td align="left"></td>
<td align="left">lnorm(meanlog, sdlog)</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">邏輯分布</td>
<td align="left"></td>
<td align="left">logis(location, scale)</td>
<td align="left"></td>
</tr>
<tr class="odd">
<td align="left">Signrank</td>
<td align="left"></td>
<td align="left">signrank(n)</td>
<td align="left"></td>
</tr>
<tr class="even">
<td align="left">威爾斯</td>
<td align="left"></td>
<td align="left">wilcox(m, n)</td>
<td align="left">a,b 為兩組樣本</td>
</tr>
</tbody>
</table>
<h1 id="期望值與動差生成函數"><a href="#期望值與動差生成函數">期望值與動差生成函數</a></h1>
<h2 id="期望值"><a href="#期望值">期望值</a></h2>
<p>定義：期望值 E(X) , (通常用符號 <img src="../timg/c9faf6ead2cd.jpg" /> 代表, <img src="../timg/02998500d150.jpg" /> )</p>
<blockquote>
<p>離散分布： <img src="../timg/ee473d84a2f4.jpg" /> 　　　　; 通常簡寫為 <img src="../timg/ef594ab5bde8.jpg" /> 或者直接寫 <img src="../timg/d8bc4e686081.jpg" /> 　</p>
<p>連續分布： <img src="../timg/e427a6a11ea0.jpg" /></p>
</blockquote>
<p>期望值的相關定理：</p>
<blockquote>
<ol style="list-style-type: decimal">
<li><p><img src="../timg/8c077554b68f.jpg" /> ;</p></li>
<li><p><img src="../timg/b67e59603606.jpg" /> ;</p></li>
<li><p><img src="../timg/d216f9d0a11c.jpg" /> ;</p></li>
</ol>
</blockquote>
<p>證明</p>
<p>定理 1: E[c] = c</p>
<blockquote>
<p><img src="../timg/910dbefa33ca.jpg" /> ; 根據期望值定義</p>
<p><img src="../timg/8508ca8158d0.jpg" /> ; 根據基本算術</p>
<p><img src="../timg/2af70652ca08.jpg" /> ; 因為 P(x) 是機率密度函數</p>
</blockquote>
<p>定理 2: E[c X] = c E[X]</p>
<blockquote>
<p><img src="../timg/73939d174ebf.jpg" /> ; 根據期望值定義</p>
<p><img src="../timg/6448eae28874.jpg" /> ; 根據基本算術</p>
<p><img src="../timg/05837ec771af.jpg" /> ; 根據期望值定義</p>
</blockquote>
<p>定理 3 : E[X + Y] = E[X] + E[Y]</p>
<blockquote>
<p>假如離散隨機變數 X, Y 的機率密度函數分別用 <img src="../timg/67deaeed1077.jpg" /> 代表。</p>
<p><img src="../timg/778460242ded.jpg" /> ; 根據期望值定義</p>
<p><img src="../timg/f1f484fbc4d6.jpg" /> ; 根據乘法對加法的分配率</p>
<p><img src="../timg/48c6228d3673.jpg" /> ;</p>
</blockquote>
<p>以上證明了離散的情況，連續的情況雷同，請比照上述寫法撰寫。</p>
<h2 id="變異數"><a href="#變異數">變異數</a></h2>
<p>定義：變異數 Var(X)</p>
<blockquote>
<p>離散隨機變數 X 的變異數 Var(X) 定義如下</p>
<div class="figure">
<img src="../timg/732e2e5049de.jpg" />
</div>
<p>說明：</p>
<ol style="list-style-type: decimal">
<li>上式中的 Var(X) 稱為 X 的變異數，而其平方根 <img src="../timg/025b3f94d793.jpg" /> 稱為 X 的標準差。 ( <img src="../timg/c9faf6ead2cd.jpg" /> 為 X 的期望值)</li>
<li>以上算式中 <img src="../timg/7231fa806691.jpg" /> 的下標均為 <img src="../timg/623aacabe8ed.jpg" /> ，而非 <img src="../timg/feb2d3288735.jpg" /> ，也就是 x 是實數值，而非樣本點。</li>
<li>這也是為何要將隨機變數定義為實函數的原因，這樣才能對這些「變數」進行 +, -, * &gt; 等代數運算，並且可以進行期望值與變異數的計算。</li>
</ol>
</blockquote>
<p>定理： <img src="../timg/a7703dd6ce1d.jpg" /></p>
<blockquote>
<p><img src="../timg/96bb01c3b614.jpg" /> ;</p>
<p><img src="../timg/8c1cb562ae08.jpg" /> ;</p>
<p><img src="../timg/eec54b02f56e.jpg" /> ;</p>
<p><img src="../timg/525aac13d520.jpg" /> ;</p>
<p><img src="../timg/52db891ad51a.jpg" /> .</p>
</blockquote>
<h2 id="期望值的函數"><a href="#期望值的函數">期望值的函數</a></h2>
<p>有時，我們會想計算某個隨機變數之函數的期望值，像是 E[g(X)]。</p>
<p>某隨機變數 X 之函數 g(X) 的期望值</p>
<blockquote>
<p><em>期望值 E[g(X)]：</em></p>
<div class="figure">
<img src="../timg/1f54b1fc932f.jpg" />
</div>
</blockquote>
<p>舉例而言， <img src="../timg/9203d5ac59db.jpg" /> 就是一個隨機變數 X 的函數 <img src="../timg/b6c29bd412ea.jpg" /> 的期望值。</p>
<p>而且、由於上述定理 1, 2, 3 的特性，這些期望值的函數還可以拆開來算，舉例如下：</p>
<blockquote>
<p><img src="../timg/9203d5ac59db.jpg" /> ;</p>
<p><img src="../timg/c66bdf020744.jpg" /> ;</p>
<p><img src="../timg/714b1d569ca7.jpg" /> .</p>
</blockquote>
<p>在以上的範例中， <img src="../timg/f564e7c6618b.jpg" /> 稱為 X 的 1 級動差， <img src="../timg/4d1d522fcf91.jpg" /> 稱為 X 的 2 級動差， <img src="../timg/6228ee82f5de.jpg" /> 稱為 X 的 3 級動差 ....</p>
<h2 id="k-階動差-kth-ordinary-moment"><a href="#k-階動差-kth-ordinary-moment">k 階動差 (Kth Ordinary Moment)</a></h2>
<blockquote>
<p>定義： <img src="../timg/461434b80615.jpg" /> 稱為隨機變數 X 的 k 階動差 (Kth ordinary moment)</p>
</blockquote>
<p>動差的慨念就像是期望值的多項式，我們可以將任何一個多項式的動差寫成 k 個動差的組合，這樣就能將任何的函數的動差給支解。</p>
<p>但是、可惜的是，即使我們將函數分解成動差的組合，其計算上仍然是相當複雜的，但是如果我們只是想變任某個期望值函數對應的原始機率分布為何，那麼可以藉助「動差生成函數」來完成這項任務，以下是動差生成函數的定義。</p>
<h2 id="動差生成函數"><a href="#動差生成函數">動差生成函數</a></h2>
<blockquote>
<p>定義：隨機變數 X 的動差生成函數 (Moment Generating Function, m.g.f) <img src="../timg/c4864c620edf.jpg" /> 為以下函數</p>
<div class="figure">
<img src="../timg/2ef7a193d755.jpg" />
</div>
<p>動差存在的條件是期望值 <img src="../timg/29d1f46b6031.jpg" /> 在開區間 (-h, h) 內是有限的。</p>
</blockquote>
<p>根據以上定義，離散分布與連續分布的動差生成函數分別可以寫成以下算式：</p>
<blockquote>
<p>離散分布： <img src="../timg/c8aa9024d083.jpg" /></p>
<p>連續分布： <img src="../timg/3fca689ae22a.jpg" /></p>
</blockquote>
<p>那麼、動差生成函數到底有甚麼用呢？</p>
<p>關於這個問題，可以讓我們回到泰勒展開式這個微積分的概念來看，就能理解「動差生成函數」背後的原理了。</p>
<p>根據泰勒展開式，我們可以將函數 <img src="../timg/8c8af458ac49.jpg" /> 展開如下：</p>
<div class="figure">
<img src="../timg/8e15bb28f8dd.jpg" />
</div>
<p>您可以看到在上述展開式當中，不管 k 為何，每一項的 <img src="../timg/fd221a37cf78.jpg" /> 都存在，並不會消失，而且 <img src="../timg/fd221a37cf78.jpg" /> 的係數為 <img src="../timg/302d803543b0.jpg" /> ， 因此、只要在某個夠小的開區間 (-h, h) 內這個動差生成函數是有限的，那麼隨機變數 <img src="../timg/02129bb86106.jpg" /> 與函數 <img src="../timg/8c8af458ac49.jpg" /> 之間將會有對映關係，而機率密度函數 P(X) 與動差生成函數 <img src="../timg/8098fa2dc11e.jpg" /> 也可以被證明有一對一的對映關係。</p>
<p>於是、動差生成函數就成了一個機率分布的「指紋」，意思是如果兩個隨機變數 X, Y 的動差生成函數 <img src="../timg/aaa2ec4dde41.jpg" /> ，則這兩個機率分布也必然相同。</p>
<p>思考 1：</p>
<blockquote>
<p>思考：為何動差生成函數可以做為一個機率分布的「指紋」呢？</p>
<p>說明：如果兩個機率分布 P(X) 與 P(Y) 的動差生成函數相同，那麼將意味著 <img src="../timg/8362fe04cf5f.jpg" /> ，根據泰勒展開式可得到</p>
<div class="figure">
<img src="../timg/7814c2c43888.jpg" />
</div>
<p>因此在每一階的動差上， <img src="../timg/461434b80615.jpg" /> 都與 <img src="../timg/2317a87d2d5e.jpg" /> 相同，因此這兩個分布也就應該是一樣的了。</p>
</blockquote>
<p>回顧 1：</p>
<blockquote>
<p>f(x) 在 0 點的泰勒展開式 (麥克羅林級數) 可以作為一個函數的指紋，意思是如果兩個函數的泰勒展開式相同，則這兩個函數必然相同 (這點是高等微積分課程的核心)。</p>
</blockquote>
<p>回顧 2：</p>
<blockquote>
<p>函數 f(x) 的特徵函數 (Characteristic function) 為 <img src="../timg/a3e1338aa2a4.jpg" /></p>
</blockquote>
<h2 id="結語-1"><a href="#結語-1">結語</a></h2>
<p>為何數學家要將隨機變數定義成一種函數，然後相樣本映射到實數空間上，而不是直接對樣本進行機率運算呢？筆者認為應該是為了期望值而布的局，因為將樣本映射到實數之後，才能用下列算式計算期望值。</p>
<blockquote>
<div class="figure">
<img src="../timg/4a592e228a54.jpg" />
</div>
</blockquote>
<p>而隨機變數之間的代數運算，像是 「3X」 , 「X+Y」 , 「X-2Y」 ,「<code>X*Y</code>」, 「<code>X*X*X*X</code>」等 運算的結果，也仍然是一種作用在樣本空間 S 的實函數，只是當 X, Y 兩者的樣本空間有所不同時，我們必須以兩者樣本空間的迪卡兒乘積 <img src="../timg/30a86e134f41.jpg" /> 作為樣本空間。</p>
<p>在這種情況下，期望值函數也才能運作在 +, - * 等運算空間中，得到以下的廣義期望值：</p>
<blockquote>
<div class="figure">
<img src="../timg/1f54b1fc932f.jpg" />
</div>
</blockquote>
<p>「動差生成函數」可以做為機率分布的指紋，因此如果兩個機率分布的「動差生成函數」相同，那麼其機率分布也會相同。</p>
<p>「動差生成函數」的定義如下：</p>
<blockquote>
<div class="figure">
<img src="../timg/2ef7a193d755.jpg" />
</div>
</blockquote>
<h1 id="聯合分布"><a href="#聯合分布">聯合分布</a></h1>
<h2 id="聯合密度函數"><a href="#聯合密度函數">聯合密度函數</a></h2>
<p>定義：離散聯合密度函數</p>
<blockquote>
<p>表示符號： <img src="../timg/23c11b5457be.jpg" /></p>
<p>必要條件：</p>
<ol style="list-style-type: decimal">
<li><p><img src="../timg/022dd0cb7b81.jpg" /> ;</p></li>
<li><p><img src="../timg/2b8440b2f634.jpg" /> ;</p></li>
</ol>
</blockquote>
<p>定義 2：連續聯合密度函數</p>
<blockquote>
<p>表示符號： <img src="../timg/aa236e008600.jpg" /> (範圍： <img src="../timg/94c803b94de4.jpg" /> )</p>
<p>必要條件：</p>
<ol style="list-style-type: decimal">
<li><p><img src="../timg/022dd0cb7b81.jpg" /> ;</p></li>
<li><p><img src="../timg/b3a153a4d7be.jpg" /> ;</p></li>
<li><p><img src="../timg/00d5a6a88bff.jpg" /> ;</p></li>
</ol>
</blockquote>
<h2 id="邊際密度函數"><a href="#邊際密度函數">邊際密度函數</a></h2>
<p>定義：離散邊際密度函數</p>
<blockquote>
<ol style="list-style-type: decimal">
<li>只有 X 的情況： <img src="../timg/c193358b7cbe.jpg" /></li>
<li>只有 Y 的情況： <img src="../timg/49b164a3dea5.jpg" /></li>
</ol>
</blockquote>
<p>定義：連續邊際密度函數</p>
<blockquote>
<ol style="list-style-type: decimal">
<li>只有 X 的情況： <img src="../timg/e1c2b6cb1090.jpg" /></li>
<li>只有 Y 的情況： <img src="../timg/4317afe39561.jpg" /></li>
</ol>
</blockquote>
<h2 id="聯合分配的期望值"><a href="#聯合分配的期望值">聯合分配的期望值</a></h2>
<p>定義：聯合分配的期望值 E[H(X,Y)]</p>
<blockquote>
<ol style="list-style-type: decimal">
<li><p>離散的情況： <img src="../timg/1344dfc48b41.jpg" /></p></li>
<li><p>連續的情況： <img src="../timg/4e9de1550265.jpg" /></p></li>
</ol>
</blockquote>
<p>定義：聯合分配中單一變數的期望值</p>
<blockquote>
<ol style="list-style-type: decimal">
<li><p>離散： <img src="../timg/0026e0af4742.jpg" /></p></li>
<li><p>離散： <img src="../timg/eae5786e38ba.jpg" /></p></li>
<li><p>連續： <img src="../timg/32fdb311c073.jpg" /></p></li>
<li><p>連續： <img src="../timg/0d18b1de1083.jpg" /></p></li>
</ol>
</blockquote>
<h2 id="共變異數-covariance-協方差"><a href="#共變異數-covariance-協方差">共變異數 (Covariance, 協方差)</a></h2>
<p>定義：共變異數 Cov(X,Y)</p>
<blockquote>
<div class="figure">
<img src="../timg/aa03e7b871bd.jpg" />
</div>
</blockquote>
<p>定理：共變異數與期望值之關係</p>
<blockquote>
<div class="figure">
<img src="../timg/b26db689fc5e.jpg" />
</div>
</blockquote>
<p>定理：相互獨立時的期望值</p>
<blockquote>
<p>如果 X, Y 相互獨立 ，則 E[X Y] = E[X] E[Y] 。</p>
</blockquote>
<h2 id="相關係數-correlation"><a href="#相關係數-correlation">相關係數 (Correlation)</a></h2>
<p>定義：</p>
<blockquote>
<p>相關係數 <img src="../timg/9e92ade7433b.jpg" /></p>
<div class="figure">
<img src="../timg/d66c94b9aba2.jpg" />
</div>
</blockquote>
<p>定理：</p>
<blockquote>
<div class="figure">
<img src="../timg/6ca29846577f.jpg" />
</div>
</blockquote>
<p>定理：</p>
<blockquote>
<div class="figure">
<img src="../timg/cf9dbc0f8dc3.jpg" />
</div>
</blockquote>
<p>實作：相關係數的R 程式</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dv">10</span>)
&gt;<span class="st"> </span>x
 [<span class="dv">1</span>]  <span class="dv">1</span>  <span class="dv">8</span> <span class="dv">10</span>  <span class="dv">5</span>  <span class="dv">3</span>  <span class="dv">7</span>  <span class="dv">9</span>  <span class="dv">4</span>  <span class="dv">2</span>  <span class="dv">6</span>
&gt;<span class="st"> </span><span class="kw">cor</span>(x, x<span class="dv">+1</span>)
[<span class="dv">1</span>] <span class="dv">1</span>
&gt;<span class="st"> </span><span class="kw">cor</span>(x, -x)
[<span class="dv">1</span>] -<span class="dv">1</span>
&gt;<span class="st"> </span><span class="kw">cor</span>(x, <span class="fl">0.5</span>*x)
[<span class="dv">1</span>] <span class="dv">1</span>
&gt;<span class="st"> </span><span class="kw">cor</span>(x, <span class="fl">0.5</span>*x<span class="dv">+1</span>)
[<span class="dv">1</span>] <span class="dv">1</span>
&gt;<span class="st"> </span><span class="kw">cor</span>(x, -<span class="fl">0.5</span>*x<span class="dv">+1</span>)
[<span class="dv">1</span>] -<span class="dv">1</span>
&gt;<span class="st"> </span>y=<span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">100</span>, <span class="dv">10</span>)
&gt;<span class="st"> </span>y
 [<span class="dv">1</span>]  <span class="dv">4</span> <span class="dv">53</span> <span class="dv">20</span> <span class="dv">68</span> <span class="dv">29</span> <span class="dv">74</span> <span class="dv">17</span> <span class="dv">49</span> <span class="dv">78</span> <span class="dv">62</span>
&gt;<span class="st"> </span><span class="kw">cor</span>(x,y)
[<span class="dv">1</span>] -<span class="fl">0.06586336</span>
&gt;<span class="st"> </span></code></pre>
<h2 id="多變數聯合分布的情況"><a href="#多變數聯合分布的情況">多變數聯合分布的情況</a></h2>
<h3 id="聯合分布與條件機率"><a href="#聯合分布與條件機率">聯合分布與條件機率</a></h3>
<blockquote>
<p>定義：如果 X,Y 滿足下列條件，則稱 X, Y 兩者之間獨立：</p>
<div class="figure">
<img src="../timg/ff003c91254e.jpg" />
</div>
</blockquote>
<h3 id="多個變數的貝氏定理"><a href="#多個變數的貝氏定理">多個變數的貝氏定理</a></h3>
<blockquote>
<ol style="list-style-type: decimal">
<li><p><img src="../timg/2cd6ef25fb48.jpg" /> ;</p></li>
<li><p><img src="../timg/a03cc3c83a3d.jpg" /> ;</p></li>
<li><p><img src="../timg/aa4192b1dff5.jpg" /> ;</p></li>
</ol>
</blockquote>
<p>其他情況可以類推，只要能正確改寫 A , B 為任何隨機變數序列都行。</p>
<h3 id="條件獨立與貝氏定理"><a href="#條件獨立與貝氏定理">條件獨立與貝氏定理</a></h3>
<p>假如 A 與 B 在給定 C 的情況下條件獨立，那麼以下算式成立：</p>
<blockquote>
<div class="figure">
<img src="../timg/385d8cb47193.jpg" />
</div>
</blockquote>
<h2 id="結語-2"><a href="#結語-2">結語</a></h2>
<p>兩個位於樣本空間 S 的聯合隨機行為，會導致樣本空間變成其迪卡兒乘積 S×S，其樣本空間大小變成 <img src="../timg/0fa9b9fc8ae9.jpg" /> 。</p>
<p>而 k 個位於樣本空間 S 的聯合隨機行為，會導致樣本空間變成其迪卡兒乘積 S×S×...×S ，其樣本空間大小變成 <img src="../timg/80a4b19424f8.jpg" /> 。</p>
<p>如果兩個位於不同樣本空間 <img src="../timg/28b539f1eb77.jpg" /> 的聯合隨機行為，則會導致樣本空間變成 <img src="../timg/4edb769bd248.jpg" /> ，其樣本空間大小變為 <img src="../timg/befbd1c71673.jpg" /> 。</p>
<p>此時 X, Y 的機率密度函數將會採用以下的「邊際機率密度函數」之算法，以便將聯合樣本空間 <img src="../timg/28b539f1eb77.jpg" /> 中的機率與單一樣本空間 <img src="../timg/ad30194f40fc.jpg" /> 或 <img src="../timg/d7f8bb33070e.jpg" /> 中的機率關聯起來。</p>
<blockquote>
<div class="figure">
<img src="../timg/2acc890d9f1f.jpg" />
</div>
<div class="figure">
<img src="../timg/d7ebe9c754ed.jpg" />
</div>
</blockquote>
<p>最後我們必須強調的是，樣本空間的選擇並沒有一定的標準，您可以視問題的需要來定義樣本空間，通常我們會盡量利用獨立的特性，讓樣本空間越小越好，否則將會很難計算。</p>
<h1 id="抽樣與敘述統計"><a href="#抽樣與敘述統計">抽樣與敘述統計</a></h1>
<h2 id="隨機抽樣"><a href="#隨機抽樣">隨機抽樣</a></h2>
<p>統計的基礎是抽樣，所謂的抽樣就是從母體 (一大群樣本) 當中抽出一些樣本，而在抽樣的時候，我們通常會盡可能的確保樣本的隨機性，以避免抽到的樣本有所偏差。</p>
<p>簡單來說，抽樣是從一群東西(母體) 當中隨機抽取出 x1, x2, ...., xn 等 n 個觀察值的過程，表示如下：</p>
<pre><code>母體 =&gt; (獨立性) X1, X2, .... , Xn 等 n 個隨機變數相互獨立 =&gt; 取出 x1, x2, ...., xn 等 n 個觀察值。</code></pre>
<p>在電腦上，我們可以很容易的模擬隨機抽樣，以下是一個使用 R 軟體模擬隨機抽樣的範例，其中指令 sample(1:100, 10) 代表從 1 到 100 的整數當中取出 10 個樣本出來。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">100</span>, <span class="dv">10</span>)
&gt;<span class="st"> </span>x
 [<span class="dv">1</span>] <span class="dv">12</span> <span class="dv">17</span> <span class="dv">50</span> <span class="dv">33</span> <span class="dv">98</span> <span class="dv">77</span> <span class="dv">39</span> <span class="dv">79</span>  <span class="dv">7</span> <span class="dv">26</span></code></pre>
<p>sample 函數的原型是 <code>sample(x, size, replace = FALSE, prob = NULL)</code>，如果 replace 設定為 FALSE，代表已經取過就會被去除，不能重複出現；反之則可以重複出現。</p>
<p>在統計學中，有一些常用的機率模型，都有對應的 R 函數，以下是一些最常用的機率模型之整理。</p>
<table>
<thead>
<tr class="header">
<th align="left">機率模型</th>
<th align="left">密度函數</th>
<th align="left">R 函數名稱</th>
<th align="left">說明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">二項分布</td>
<td align="left"><img src="../timg/9474fc44e360.jpg" /></td>
<td align="left">binom(n:size, p:prob)</td>
<td align="left">n:樣本數, p:正面機率, <br/> n 次試驗中有 x 個成功的機率</td>
</tr>
<tr class="even">
<td align="left">布瓦松分布</td>
<td align="left"><img src="../timg/297093d1b247.jpg" /></td>
<td align="left">pois(lambda)</td>
<td align="left">在每單位區域內，事件出現平均 <img src="../timg/c6a6eb61fd9c.jpg" /> 次</td>
</tr>
<tr class="odd">
<td align="left">均勻分布 (Uniform)</td>
<td align="left"><img src="../timg/d199631f1413.jpg" /></td>
<td align="left">unif(a:min, b:max)</td>
<td align="left">a:範圍下限, b: 上限 <br/> 出現機會均等</td>
</tr>
<tr class="even">
<td align="left">常態分布(Normal)</td>
<td align="left"><img src="../timg/b0aca724e39e.jpg" /></td>
<td align="left">norm(mean, sd)</td>
<td align="left">中央極限定理：x1+x2+...+xk; 當 k 越大就越接近常態分布</td>
</tr>
<tr class="odd">
<td align="left">指數分布 (Exponential)</td>
<td align="left"><img src="../timg/71075ebb0855.jpg" /></td>
<td align="left">exp(rate)</td>
<td align="left">伽瑪分布( <img src="../timg/ad965fa877cb.jpg" /> ) <br/> 布瓦松過程中，第一次事件出現的時間 W</td>
</tr>
</tbody>
</table>
<p>對於每個機率模型，您只要在該函數前若加入 r 這個字，就可以用來產生隨機樣本，以下是一些隨機樣本的產生範例。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">20</span>, <span class="dv">5</span>, <span class="fl">0.5</span>)
 [<span class="dv">1</span>] <span class="dv">4</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">3</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">1</span> <span class="dv">1</span>
&gt;<span class="st"> </span><span class="kw">rpois</span>(<span class="dv">20</span>, <span class="fl">3.5</span>)
 [<span class="dv">1</span>] <span class="dv">2</span> <span class="dv">1</span> <span class="dv">4</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">6</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">1</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">6</span> <span class="dv">6</span> <span class="dv">0</span> <span class="dv">4</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">4</span> <span class="dv">6</span> <span class="dv">2</span>
&gt;<span class="st"> </span><span class="kw">runif</span>(<span class="dv">20</span>, <span class="dt">min =</span> <span class="dv">3</span>, <span class="dt">max =</span> <span class="dv">8</span>)
 [<span class="dv">1</span>] <span class="fl">3.933526</span> <span class="fl">3.201883</span> <span class="fl">7.592147</span> <span class="fl">5.207603</span> <span class="fl">4.897806</span> <span class="fl">3.848298</span> <span class="fl">4.521461</span> <span class="fl">4.437873</span>
 [<span class="dv">9</span>] <span class="fl">3.655640</span> <span class="fl">5.633540</span> <span class="fl">6.557995</span> <span class="fl">5.430671</span> <span class="fl">6.502675</span> <span class="fl">5.637283</span> <span class="fl">7.713699</span> <span class="fl">5.841052</span>
[<span class="dv">17</span>] <span class="fl">6.859493</span> <span class="fl">5.987991</span> <span class="fl">3.752924</span> <span class="fl">7.480678</span>
&gt;<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dt">mean =</span> <span class="fl">5.0</span>, <span class="dt">sd =</span> <span class="fl">2.0</span>)
 [<span class="dv">1</span>] <span class="fl">6.150209</span> <span class="fl">4.743013</span> <span class="fl">3.328734</span> <span class="fl">5.096294</span> <span class="fl">4.922795</span> <span class="fl">6.272768</span> <span class="fl">4.862825</span> <span class="fl">8.036376</span>
 [<span class="dv">9</span>] <span class="fl">4.198432</span> <span class="fl">5.467984</span> <span class="fl">2.046450</span> <span class="fl">6.452511</span> <span class="fl">2.088256</span> <span class="fl">5.349187</span> <span class="fl">3.074408</span> <span class="fl">3.628072</span>
[<span class="dv">17</span>] <span class="fl">3.421388</span> <span class="fl">7.242598</span> <span class="fl">3.125895</span> <span class="fl">9.865341</span>
&gt;<span class="st"> </span><span class="kw">rexp</span>(<span class="dv">20</span>, <span class="dt">rate=</span><span class="fl">2.0</span>)
 [<span class="dv">1</span>] <span class="fl">0.17667426</span> <span class="fl">0.49729383</span> <span class="fl">0.12786107</span> <span class="fl">0.13983412</span> <span class="fl">0.44683515</span> <span class="fl">1.30482842</span>
 [<span class="dv">7</span>] <span class="fl">0.28512544</span> <span class="fl">1.61472266</span> <span class="fl">0.23220649</span> <span class="fl">0.39089780</span> <span class="fl">0.05947224</span> <span class="fl">1.42892610</span>
[<span class="dv">13</span>] <span class="fl">0.02555552</span> <span class="fl">0.69409186</span> <span class="fl">0.68228242</span> <span class="fl">0.22542362</span> <span class="fl">0.33590791</span> <span class="fl">0.14684937</span>
[<span class="dv">19</span>] <span class="fl">0.34995146</span> <span class="fl">0.80595369</span></code></pre>
<p>為了讓讀者能確認這些指令所產生的圖形確實符合分布，讓我們用這些隨機抽樣函數各產生 100,000 個樣本， 然後用 hist() 這個函數繪製統計圖，就能看出這些抽樣函數的效果了，以下是我們的抽樣指令與結果圖形。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x =<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">100000</span>, <span class="dv">5</span>, <span class="fl">0.5</span>)
&gt;<span class="st"> </span><span class="kw">hist</span>(x)</code></pre>
<div class="figure">
<img src="../img/rbinomHist.jpg" alt="rbinom(100000, 5, 0.5) 的統計圖" /><p class="caption">rbinom(100000, 5, 0.5) 的統計圖</p>
</div>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>y =<span class="st"> </span><span class="kw">rpois</span>(<span class="dv">100000</span>, <span class="fl">3.5</span>)
&gt;<span class="st"> </span><span class="kw">hist</span>(y)</code></pre>
<div class="figure">
<img src="../img/rpoisHist.jpg" alt="rpois(100000, 3.5) 的統計圖" /><p class="caption">rpois(100000, 3.5) 的統計圖</p>
</div>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>z =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">100000</span>, <span class="dt">min=</span><span class="dv">3</span>, <span class="dt">max=</span><span class="dv">8</span>)
&gt;<span class="st"> </span><span class="kw">hist</span>(z)</code></pre>
<div class="figure">
<img src="../img/runifHist.jpg" alt="runif(100000, min=3, max=8) 的統計圖" /><p class="caption">runif(100000, min=3, max=8) 的統計圖</p>
</div>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>w =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100000</span>, <span class="dt">mean=</span><span class="fl">5.0</span>, <span class="dt">sd=</span><span class="fl">2.0</span>)
&gt;<span class="st"> </span><span class="kw">hist</span>(w)</code></pre>
<div class="figure">
<img src="../img/rnormHist.jpg" alt="rnorm(100000, mean=5.0, sd=2.0) 的統計圖" /><p class="caption">rnorm(100000, mean=5.0, sd=2.0) 的統計圖</p>
</div>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>v =<span class="st"> </span><span class="kw">rexp</span>(<span class="dv">100000</span>, <span class="dt">rate=</span><span class="fl">2.0</span>)
&gt;<span class="st"> </span><span class="kw">hist</span>(v)</code></pre>
<div class="figure">
<img src="../img/rexpHist.jpg" alt="rexp(100000, rate=2.0) 的統計圖" /><p class="caption">rexp(100000, rate=2.0) 的統計圖</p>
</div>
<h2 id="單組樣本的敘述統計"><a href="#單組樣本的敘述統計">單組樣本的敘述統計</a></h2>
<p>敘述統計乃是隨機抽樣的樣本集合，進行某些計算與繪圖，以便忠實的呈現出樣本的某些特性。這些計算出的數值，以及呈現出來的圖形，可以反映出樣本的某些統計特性，讓統計者能透過數值或圖形，大致了解樣本的統計特徵。</p>
<table>
<thead>
<tr class="header">
<th align="left">中文名稱</th>
<th align="left">英文名稱</th>
<th align="left">數學公式 / 說明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">樣本平均數</td>
<td align="left">Mean</td>
<td align="left"><img src="../timg/178d1db69ac7.jpg" /></td>
</tr>
<tr class="even">
<td align="left">樣本中位數</td>
<td align="left">Median</td>
<td align="left">樣本排序後最中間位置的數值</td>
</tr>
<tr class="odd">
<td align="left">樣本變異數</td>
<td align="left">Sample Variance</td>
<td align="left"><img src="../timg/e7e0cbe68706.jpg" /></td>
</tr>
<tr class="even">
<td align="left">樣本標準差</td>
<td align="left">Sample Standard Deviation</td>
<td align="left">樣本變異數中的 S 稱為樣本標準差，也就是 <img src="../timg/cc63171042d5.jpg" /></td>
</tr>
<tr class="odd">
<td align="left">樣本全距</td>
<td align="left">Range</td>
<td align="left">樣本中最大的觀察值減去最小的觀察值 <img src="../timg/0b7b19ca31d5.jpg" /></td>
</tr>
<tr class="even">
<td align="left">離群值</td>
<td align="left">Outlier 或 Wild</td>
<td align="left">離其他樣本很遠，特別大或特別小的樣本值</td>
</tr>
<tr class="odd">
<td align="left">樣本四分數間距</td>
<td align="left">InterQuartile Range, IQR</td>
<td align="left">第 3 四分位數減掉第 1 四分位數 <img src="../timg/8287f5eaa0f7.jpg" /></td>
</tr>
</tbody>
</table>
<blockquote>
<p>注意：變異數的定義為 <img src="../timg/9db00d6dfc86.jpg" /> ，上述的樣本變異數必須除以 n-1 才是變異數的不偏估計量，而不是除以 n (這是因為我們並不知道母體真正的 <img src="../timg/c9faf6ead2cd.jpg" /> 值是多少，因此採用了 <img src="../timg/3ebf8415809f.jpg" /> 來代替 <img src="../timg/ac033b561fc6.jpg" /> ，但是這樣就會造成多減掉 一份樣本的效應，於是分母就必須除以 n-1 了)。</p>
</blockquote>
<p>範例：請寫出樣本序列 (7 4 6 8 9 4 5 6 2 8) 的以下敘述統計值與其計算過程。</p>
<ol style="list-style-type: decimal">
<li>樣本平均數 (Mean)</li>
<li>樣本變異數 (Sample Variance)</li>
<li>樣本標準差 (Sample Standard Deviation)</li>
<li>中位數 (Median)</li>
<li>全距 (Range)</li>
<li>第一四分位數 (q1)</li>
<li>第三四分位數 (q3)</li>
<li>樣本四分數間距 (iqr)</li>
</ol>
<p>解答：</p>
<ol style="list-style-type: decimal">
<li>樣本平均數 (Mean)</li>
</ol>
<blockquote>
<p>mean(x) = (7+4+6+8+9+4+5+6+2+8)/10 = 5.9</p>
</blockquote>
<ol start="2" style="list-style-type: decimal">
<li>樣本變異數 (Sample Variance)</li>
</ol>
<blockquote>
<div class="figure">
<img src="../timg/956da532fb19.jpg" />
</div>
</blockquote>
<ol start="3" style="list-style-type: decimal">
<li>樣本標準差 (Sample Standard Deviation)</li>
</ol>
<blockquote>
<div class="figure">
<img src="../timg/76b172cf2944.jpg" />
</div>
</blockquote>
<ol start="4" style="list-style-type: decimal">
<li>中位數 (Median)</li>
</ol>
<blockquote>
<p>M = (2 4 4 5 6 6 7 8 8 9) 最中間的值 = (6+6)/2 = 6</p>
</blockquote>
<ol start="5" style="list-style-type: decimal">
<li>全距 (Range)</li>
</ol>
<blockquote>
<p>range(x) = 9-2 = 7</p>
</blockquote>
<ol start="6" style="list-style-type: decimal">
<li>第一四分位數 (q1)</li>
</ol>
<blockquote>
<p>順序 0 1 2 3 4 5 6 7 8 9</p>
<p>樣本 2 4 4 5 6 6 7 8 8 9</p>
<p>q1 的位置 0.25 * 9/10 = 0.225</p>
<p>所以 q1 = 4+0.25 * (5-4) = 4.25</p>
</blockquote>
<ol start="7" style="list-style-type: decimal">
<li>第三四分位數 (q3)</li>
</ol>
<blockquote>
<p>q3 的位置 0.75 * 9/10 = 0.675</p>
<p>所以 q3 = 7+0.75 * (8-7) = 7.75</p>
</blockquote>
<ol start="8" style="list-style-type: decimal">
<li>樣本四分數間距 (iqr)</li>
</ol>
<blockquote>
<p>iqr(x) = q3-q1 = 7.75-4.25 = 3.5</p>
</blockquote>
<p>使用 R 軟體進行驗證</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">100</span>, <span class="dv">10</span>)
&gt;<span class="st"> </span>x
 [<span class="dv">1</span>] <span class="dv">12</span> <span class="dv">17</span> <span class="dv">50</span> <span class="dv">33</span> <span class="dv">98</span> <span class="dv">77</span> <span class="dv">39</span> <span class="dv">79</span>  <span class="dv">7</span> <span class="dv">26</span>
&gt;<span class="st"> </span><span class="kw">mean</span>(x)
[<span class="dv">1</span>] <span class="fl">43.8</span>
&gt;<span class="st"> </span><span class="kw">median</span>(x)
[<span class="dv">1</span>] <span class="dv">36</span>
&gt;<span class="st"> </span><span class="kw">var</span>(x)
[<span class="dv">1</span>] <span class="fl">984.1778</span>
&gt;<span class="st"> </span><span class="kw">sd</span>(x)
[<span class="dv">1</span>] <span class="fl">31.37161</span>
&gt;<span class="st"> </span><span class="kw">range</span>(x)
[<span class="dv">1</span>]  <span class="dv">7</span> <span class="dv">98</span>
&gt;<span class="st"> </span><span class="kw">max</span>(x)
[<span class="dv">1</span>] <span class="dv">98</span>
&gt;<span class="st"> </span><span class="kw">min</span>(x)
[<span class="dv">1</span>] <span class="dv">7</span>
&gt;<span class="st"> </span><span class="kw">max</span>(x)-<span class="kw">min</span>(x)
[<span class="dv">1</span>] <span class="dv">91</span>
&gt;<span class="st"> </span>q1 =<span class="st"> </span><span class="kw">quantile</span>(x, <span class="fl">0.25</span>)
&gt;<span class="st"> </span>q1
  <span class="dv">25</span>% 
<span class="fl">19.25</span> 
&gt;<span class="st"> </span>q3 =<span class="st"> </span><span class="kw">quantile</span>(x, <span class="fl">0.75</span>)
&gt;<span class="st"> </span>q3
  <span class="dv">75</span>% 
<span class="fl">70.25</span> 
&gt;<span class="st"> </span>q3-q1
<span class="dv">75</span>% 
 <span class="dv">51</span> 
&gt;<span class="st"> </span><span class="kw">iqr</span>(x)
錯誤:<span class="st"> </span>沒有這個函數 <span class="st">&quot;iqr&quot;</span>
&gt;<span class="st"> </span><span class="kw">IQR</span>(x)
[<span class="dv">1</span>] <span class="dv">51</span>
&gt;<span class="st"> </span><span class="kw">fivenum</span>(x)
[<span class="dv">1</span>]  <span class="dv">7</span> <span class="dv">17</span> <span class="dv">36</span> <span class="dv">77</span> <span class="dv">98</span>
&gt;<span class="st"> </span><span class="kw">summary</span>(x)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
   <span class="fl">7.00</span>   <span class="fl">19.25</span>   <span class="fl">36.00</span>   <span class="fl">43.80</span>   <span class="fl">70.25</span>   <span class="fl">98.00</span> </code></pre>
<p>習題：請用 R 軟體計算出樣本序列 (8.9 , 4.5 , 3.7 , 10.0 , 11.5 , 8.9 , 5.6 , 15.4 , 16.6 , 1.0) 的以下敘述統計值 (必須寫出指令與結果)。</p>
<ol style="list-style-type: decimal">
<li><p>樣本平均數 (Mean)</p></li>
<li><p>樣本變異數 (Sample Variance)</p></li>
<li><p>樣本標準差 (Sample Standard Deviation)</p></li>
<li><p>中位數 (Median)</p></li>
<li><p>全距 (Range)</p></li>
<li><p>第一四分位數 (q1)</p></li>
<li><p>第三四分位數 (q3)</p></li>
<li><p>樣本四分數間距 (iqr)</p></li>
</ol>
<p>解答：</p>
<pre class="sourceCode R"><code class="sourceCode r">[<span class="dv">1</span>] <span class="fl">25.37433</span>
&gt;<span class="st"> </span><span class="kw">sd</span>(x)
[<span class="dv">1</span>] <span class="fl">5.037294</span>
&gt;<span class="st"> </span><span class="kw">median</span>(x)
[<span class="dv">1</span>] <span class="fl">8.9</span>
&gt;<span class="st"> </span><span class="kw">max</span>(x)-<span class="kw">min</span>(x)
[<span class="dv">1</span>] <span class="fl">15.6</span>
&gt;<span class="st"> </span>q1 =<span class="st"> </span><span class="kw">quantile</span>(<span class="fl">0.25</span>, x)
錯誤在<span class="kw">quantile.default</span>(<span class="fl">0.25</span>, x) :<span class="st"> &#39;probs&#39;</span> outside [<span class="dv">0</span>,<span class="dv">1</span>]
&gt;<span class="st"> </span><span class="dt">q1 =</span> <span class="kw">quantile</span>(x, <span class="fl">0.25</span>)
&gt;<span class="st"> </span>q1
  <span class="dv">25</span>% 
<span class="fl">4.775</span> 
&gt;<span class="st"> </span><span class="dt">q3 =</span> <span class="kw">quantile</span>(x, <span class="fl">0.75</span>)
&gt;<span class="st"> </span>q3
   <span class="dv">75</span>% 
<span class="fl">11.125</span> 
&gt;<span class="st"> </span>q3-q1
 <span class="dv">75</span>% 
<span class="fl">6.35</span> 
&gt;<span class="st"> </span><span class="kw">IQR</span>(x)
[<span class="dv">1</span>] <span class="fl">6.35</span>
&gt;<span class="st"> </span></code></pre>
<h2 id="繪製統計圖"><a href="#繪製統計圖">繪製統計圖</a></h2>
<table>
<thead>
<tr class="header">
<th align="left">中文名稱</th>
<th align="left">英文名稱</th>
<th align="left">R 指令</th>
<th align="left">說明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">直方圖</td>
<td align="left">Histogram</td>
<td align="left">hist(x)</td>
<td align="left">根據每個區間的樣本出現次數繪製的長條圖。</td>
</tr>
<tr class="even">
<td align="left">莖葉圖</td>
<td align="left">Stem-and-Leaf Diagram</td>
<td align="left">stem(x)</td>
<td align="left">用主幹數字與分支數字表示分布情況的圖形。</td>
</tr>
<tr class="odd">
<td align="left">盒型圖</td>
<td align="left">Boxplots</td>
<td align="left">boxplot(x)</td>
<td align="left">由平均值、內籬笆與外籬笆所形成的盒型圖，可看出中心點與離散程度。</td>
</tr>
<tr class="even">
<td align="left">肩型圖 (累加分配圖)</td>
<td align="left">Relative Cumulative Frequency Ogive</td>
<td align="left">plot(ecdf(x))</td>
<td align="left">將累加次數繪製出來的圖形。</td>
</tr>
</tbody>
</table>
<p>說明：盒型圖是由四分位數 q1, q3, 以及內籬笆 f1, f3 (inner fences), 連接值 a1, a3 與外籬笆 F1, F3 (outer fances) 所組成的圖形</p>
<ul>
<li>內籬笆：f1 = q1 - 1.5 iqr; f3 = q3 + 1.5 iqr;</li>
<li>外籬笆：F1 = q1 - 3.0 iqr; F3 = q3 + 3.0 iqr;</li>
<li>連接值：a1 是大於且最接近 f1 的數據點; a3 小於且最接近 f3 的數據點。</li>
</ul>
<p>盒型圖的畫法請參考下列圖形：</p>
<div class="figure">
<img src="../img/BoxPlot.png" alt="圖、盒型圖的畫法" /><p class="caption">圖、盒型圖的畫法</p>
</div>
<p>R 操作範例 : 統計圖</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)
&gt;<span class="st"> </span>x
  [<span class="dv">1</span>]  <span class="fl">0.389381081</span> -<span class="fl">0.274522826</span>  <span class="fl">1.492670583</span> -<span class="fl">1.563228609</span>  <span class="fl">0.766405108</span>
  [<span class="dv">6</span>]  <span class="fl">0.736573742</span>  <span class="fl">0.297407135</span> -<span class="fl">1.324130406</span> -<span class="fl">1.376598231</span>  <span class="fl">1.661727175</span>
 [<span class="dv">11</span>] -<span class="fl">1.356590351</span>  <span class="fl">1.309122339</span> -<span class="fl">1.193821085</span>  <span class="fl">0.365801091</span> -<span class="fl">0.952034088</span>
 [<span class="dv">16</span>] -<span class="fl">0.277610568</span> -<span class="fl">0.599980091</span> -<span class="fl">0.124105876</span> -<span class="fl">1.107713162</span>  <span class="fl">0.560637570</span>
 [<span class="dv">21</span>]  <span class="fl">0.714449138</span>  <span class="fl">0.111969057</span>  <span class="fl">0.505171739</span> -<span class="fl">2.418297599</span>  <span class="fl">0.318797182</span>
 [<span class="dv">26</span>]  <span class="fl">2.716646516</span>  <span class="fl">0.345289422</span>  <span class="fl">0.019434615</span>  <span class="fl">1.087758951</span>  <span class="fl">0.033917165</span>
 [<span class="dv">31</span>] -<span class="fl">0.356786424</span> -<span class="fl">1.284809066</span>  <span class="fl">1.580411327</span>  <span class="fl">0.552931291</span> -<span class="fl">0.615928762</span>
 [<span class="dv">36</span>] -<span class="fl">0.087069820</span> -<span class="fl">0.814632197</span> -<span class="fl">0.570882510</span> -<span class="fl">0.107731447</span> -<span class="fl">1.453838416</span>
 [<span class="dv">41</span>] -<span class="fl">0.257115209</span>  <span class="fl">1.166866120</span>  <span class="fl">1.072692716</span> -<span class="fl">0.022594852</span>  <span class="fl">0.441221144</span>
 [<span class="dv">46</span>]  <span class="fl">1.053900960</span> -<span class="fl">1.025193547</span> -<span class="fl">1.119200587</span>  <span class="fl">0.264668203</span>  <span class="fl">1.409504515</span>
 [<span class="dv">51</span>]  <span class="fl">0.241644132</span> -<span class="fl">0.955407800</span>  <span class="fl">0.446297381</span>  <span class="fl">0.231887649</span>  <span class="fl">0.769308731</span>
 [<span class="dv">56</span>]  <span class="fl">0.269624579</span>  <span class="fl">0.496109294</span>  <span class="fl">0.822638573</span> -<span class="fl">0.904380789</span> -<span class="fl">0.429527404</span>
 [<span class="dv">61</span>] -<span class="fl">2.050582772</span> -<span class="fl">0.586973281</span> -<span class="fl">1.192753403</span>  <span class="fl">1.158321933</span> -<span class="fl">0.151319360</span>
 [<span class="dv">66</span>]  <span class="fl">0.558858868</span> -<span class="fl">0.656174351</span> -<span class="fl">2.858964403</span>  <span class="fl">0.366785049</span>  <span class="fl">0.896958092</span>
 [<span class="dv">71</span>]  <span class="fl">0.369315063</span> -<span class="fl">0.953560954</span> -<span class="fl">0.762608370</span> -<span class="fl">1.017449547</span> -<span class="fl">0.127738562</span>
 [<span class="dv">76</span>] -<span class="fl">1.922030980</span> -<span class="fl">0.839897930</span>  <span class="fl">1.332972530</span> -<span class="fl">0.001151104</span>  <span class="fl">0.104336360</span>
 [<span class="dv">81</span>] -<span class="fl">0.208907813</span>  <span class="fl">1.401335798</span>  <span class="fl">0.019330593</span> -<span class="fl">0.687559289</span>  <span class="fl">0.445371885</span>
 [<span class="dv">86</span>]  <span class="fl">0.504532689</span>  <span class="fl">2.168626000</span> -<span class="fl">1.742886230</span>  <span class="fl">0.831058071</span>  <span class="fl">2.011604088</span>
 [<span class="dv">91</span>]  <span class="fl">1.676059594</span>  <span class="fl">1.132849957</span> -<span class="fl">1.047073217</span> -<span class="fl">0.912548540</span> -<span class="fl">2.235854777</span>
 [<span class="dv">96</span>] -<span class="fl">1.194104128</span>  <span class="fl">0.121106118</span> -<span class="fl">1.178415224</span>  <span class="fl">0.214196778</span>  <span class="fl">0.280714044</span>
&gt;<span class="st"> </span><span class="kw">stem</span>(x)

  The decimal point is at the |

<span class="st">  </span>-<span class="dv">2</span> |<span class="st"> </span><span class="dv">9421</span>
  -<span class="dv">1</span> |<span class="st"> </span><span class="dv">97654433222211000000</span>
  -<span class="dv">0</span> |<span class="st"> </span><span class="dv">998887766664433322111100</span>
   <span class="dv">0</span> |<span class="st"> </span><span class="dv">00011122233333344444445556667788889</span>
   <span class="dv">1</span> |<span class="st"> </span><span class="dv">11112233445677</span>
   <span class="dv">2</span> |<span class="st"> </span><span class="dv">027</span>

&gt;<span class="st"> </span><span class="kw">hist</span>(x, <span class="dt">main=</span><span class="st">&quot;Frequency Histogram of x&quot;</span>)

&gt;<span class="st"> </span><span class="kw">hist</span>(x, <span class="dt">main=</span><span class="st">&quot;Probability Histogram of x&quot;</span>, <span class="dt">freq=</span>F)

&gt;<span class="st"> </span>Fx =<span class="st"> </span><span class="kw">ecdf</span>(x)

&gt;<span class="st"> </span><span class="kw">plot</span>(x)

&gt;<span class="st"> </span><span class="kw">plot</span>(Fx)

&gt;<span class="st"> </span><span class="kw">boxplot</span>(x)</code></pre>
<div class="figure">
<img src="../img/DescriptiveGraph.jpg" alt="統計圖" /><p class="caption">統計圖</p>
</div>
<div class="figure">
<img src="../img/BoxPlot.jpg" alt="盒狀圖" /><p class="caption">盒狀圖</p>
</div>
<p>以上都是對於單組樣本的統計數字與圖形，以下將討論兩組樣本的統計數字</p>
<h2 id="共變異數兩組樣本的相關度統計"><a href="#共變異數兩組樣本的相關度統計">共變異數、兩組樣本的相關度統計</a></h2>
<p>兩組樣本的統計數字，最重要的就是共變異數 (covariance) 相關係數 (correlation) 與了。</p>
<p>共變異數是兩組樣本 X, Y 的樣本與期望值之間差的乘積之期望值，而相關係數則共變異數經過 正規化後的結果，用來表示兩組樣本相關程度，其數值介於 -1.0 到 1.0 之間。</p>
<table>
<thead>
<tr class="header">
<th align="left">中文名稱</th>
<th align="left">英文名稱</th>
<th align="left">R 指令</th>
<th align="left">數學公式 / 說明</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">共變異數</td>
<td align="left">covariance</td>
<td align="left">cov(x,y)</td>
<td align="left"><img src="../timg/46c8d04f73d9.jpg" /></td>
</tr>
<tr class="even">
<td align="left">相關係數</td>
<td align="left">correlation</td>
<td align="left">cor(x,y)</td>
<td align="left"><img src="../timg/23849870b7b7.jpg" /></td>
</tr>
</tbody>
</table>
<p>讓我們看看 R 軟體中的共變異數函數 cov() 與相關係數 cor() 的操作，如下所示：</p>
<pre class="sourceCode R"><code class="sourceCode r"> <span class="kw">runif</span>(<span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">5</span>)
&gt;<span class="st"> </span>x
 [<span class="dv">1</span>] <span class="fl">1.375135</span> <span class="fl">1.863417</span> <span class="fl">2.403693</span> <span class="fl">2.639902</span> <span class="fl">1.694610</span> <span class="fl">4.419406</span> <span class="fl">4.032262</span> <span class="fl">2.147783</span>
 [<span class="dv">9</span>] <span class="fl">1.501733</span> <span class="fl">1.497732</span>
&gt;<span class="st"> </span><span class="kw">cov</span>(x, x)
[<span class="dv">1</span>] <span class="fl">1.144697</span>
&gt;<span class="st"> </span><span class="kw">cov</span>(x, x<span class="dv">+1</span>)
[<span class="dv">1</span>] <span class="fl">1.144697</span>
&gt;<span class="st"> </span><span class="kw">cor</span>(x, x)
[<span class="dv">1</span>] <span class="dv">1</span>
&gt;<span class="st"> </span><span class="kw">cor</span>(x, x<span class="dv">+1</span>)
[<span class="dv">1</span>] <span class="dv">1</span>
&gt;<span class="st"> </span><span class="kw">cov</span>(x, -x)
[<span class="dv">1</span>] -<span class="fl">1.144697</span>
&gt;<span class="st"> </span><span class="kw">cor</span>(x, -x)
[<span class="dv">1</span>] -<span class="dv">1</span>
&gt;<span class="st"> </span><span class="kw">cor</span>(x, <span class="fl">0.5</span>*x)
[<span class="dv">1</span>] <span class="dv">1</span>
&gt;<span class="st"> </span>y =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">10</span>, <span class="dv">1</span>, <span class="dv">5</span>)
&gt;<span class="st"> </span>y
 [<span class="dv">1</span>] <span class="fl">1.114662</span> <span class="fl">2.358270</span> <span class="fl">2.089179</span> <span class="fl">4.581484</span> <span class="fl">4.170922</span> <span class="fl">2.630044</span> <span class="fl">1.450336</span> <span class="fl">1.320637</span>
 [<span class="dv">9</span>] <span class="fl">1.705649</span> <span class="fl">3.506064</span>
&gt;<span class="st"> </span><span class="kw">cor</span>(x, y)
[<span class="dv">1</span>] -<span class="fl">0.04560485</span>
&gt;<span class="st"> </span><span class="kw">cor</span>(y, y)
[<span class="dv">1</span>] <span class="dv">1</span>
&gt;<span class="st"> </span></code></pre>
<h1 id="中央極限定理"><a href="#中央極限定理">中央極限定理</a></h1>
<p>中央極限定理是機率統計上最重要的定理之一，整個統計的估計與檢定幾乎都建立在這個定理之上，因此 對「中央極限定理」有清楚的理解是學好機率統計的一個關鍵。</p>
<p>在本章中，我們將利用 R 軟體實作並驗證「中央極限定理」，讓讀者能透過程式實際體會該定理的重要性與用途。</p>
<p>但是在說明中央極限定理之前，先讓我們來看看一個更簡單的數學定律，那就是大數法則。</p>
<h2 id="大數法則"><a href="#大數法則">大數法則</a></h2>
<p>大數法則又稱大數律，是個數學與統計學的概念，意指數量越多，則其平均就越趨近母體平均數 <span class="math"><em>μ</em></span>。</p>
<p>用數學的講法來說，也就是如下的公式成立。</p>
<blockquote>
<p><img src="../timg/b7e39cbf044f.jpg" /> ; 當 <img src="../timg/9fcd9d5d39cc.jpg" /> 之時。</p>
</blockquote>
<p>但是、在上述的趨近定義上，大數法則通常還可以分為強弱兩個版本，如下所示：</p>
<blockquote>
<p>弱大數法則 (Weak law) : <img src="../timg/cb0b52fd7d7d.jpg" /></p>
</blockquote>
<p>弱大數法則的意義是說，當樣本數趨近於無限大時，樣本平均值會趨近於母體平均數 <span class="math"><em>μ</em></span>。</p>
<blockquote>
<p>強大數法則 (Strong law) : <img src="../timg/67f605b0447c.jpg" /></p>
</blockquote>
<p>而強大數法則的意義則是說，當樣本數趨近於無限大時，樣本平均值等於母體平均數 <img src="../timg/c9faf6ead2cd.jpg" /> 的機率為 1。</p>
<p>上述的大數法則只是說出一個傾向而已，而且 <img src="../timg/9fcd9d5d39cc.jpg" /> 這個要求太過強烈，現實上是不可能達到的， 如果能夠找到有限樣本下的平均數之變動範圍限制，那會比這樣的無限大要求更好一些。</p>
<h2 id="柴比雪夫不等式"><a href="#柴比雪夫不等式">柴比雪夫不等式</a></h2>
<p>柴比雪夫不等式給出了樣本分佈情況的一個限制條件，其數學公式如下所示：</p>
<div class="figure">
<img src="../timg/b51808dd8e3f.jpg" />
</div>
<p>柴比雪夫不等式所述說的，是樣本平均數與標準差之間的一個限制關係，這個關係不管在哪一種分佈之下，都一定會成立的。</p>
<ul>
<li>與平均數 <img src="../timg/c9faf6ead2cd.jpg" /> 相差至少 2 個標準差 ( <img src="../timg/0fe961916d0a.jpg" /> ) 的樣本數目不多於 1/4。</li>
<li>與平均數 <img src="../timg/c9faf6ead2cd.jpg" /> 相差至少 3 個標準差 ( <img src="../timg/988daade55fc.jpg" /> ) 的樣本數目不多於 1/9。</li>
<li><p>與平均數 <img src="../timg/c9faf6ead2cd.jpg" /> 相差至少 4 個標準差 ( <img src="../timg/46e0e1022ad0.jpg" /> ) 的樣本數目不多於 1/16。</p></li>
<li><p>與平均數 <img src="../timg/c9faf6ead2cd.jpg" /> 相差至少 k 個標準差 ( <img src="../timg/a32e021ec29c.jpg" /> ) 的樣本數目不多於 <span class="math">1 / <em>k</em><sup>2</sup></span>。</p></li>
</ul>
<p>舉例而言，假如一個 40 人的班上，同學的平均體重為 50 公斤，標準差為 10 公斤，那麼體重小於 30 公斤的人不可能會超過 10 人。</p>
<p>初步看起來，柴比雪夫不等式非常得奇怪，感覺很不合理，舉例而言，對於 n 個柏努力試驗的樣本，由於樣本值不是 0 就是 1，這樣 應該會不符合柴比雪夫不等式才對，但事實上卻會符合。</p>
<p>讓我們舉一個例子，假如 20 個伯努力試驗，共有十次成功，十次失敗，於是其平均值、變異數與標準差可計算如下：</p>
<ul>
<li>平均值： <img src="../timg/0a51a4c9f4c0.jpg" /></li>
<li>變異數： <img src="../timg/78d7a7dcc949.jpg" /></li>
<li>標準差： <img src="../timg/aab5be661703.jpg" /></li>
</ul>
<p>因此，與平均數 <img src="../timg/2624a14d938a.jpg" /> 相差兩個標準差的情況根本就不存在 (也就是 <img src="../timg/8a8b7feb635c.jpg" /> )， 所以柴比雪夫不等式在這樣分為兩個極端的分布上還是會成立的。</p>
<p>雖然柴比雪夫不等式給出了平均值的範圍限制，但是卻沒有給出平均值分佈的形狀，還好中央極限定理解決了這個問題。</p>
<h2 id="中央極限定理簡介"><a href="#中央極限定理簡介">中央極限定理簡介</a></h2>
<p>以下是中央極限定理的數學式：</p>
<div class="figure">
<img src="../timg/5884aa99cd82.jpg" />
</div>
<p>如果用白話文陳述，那就是說 n 個樣本的平均數 <img src="../timg/894e240322d2.jpg" /> 會趨近於常態分布。</p>
<p>更精確一點的說，當您從某個母體 X 取出 n 個樣本，則這 n 個樣本的平均數 <img src="../timg/894e240322d2.jpg" /> 會趨近於以平均期望值 <img src="../timg/c9faf6ead2cd.jpg" /> 為中心， 以母體標準差 <img src="../timg/a2ab7d71a0f0.jpg" /> 除以 <img src="../timg/be183cdd1e68.jpg" /> 的值 <img src="../timg/b902c90353f0.jpg" /> 為標準差的常態分布。</p>
<p>如果採用另一種正規化後的公式寫法，也可以將上述的「中央極限定理」改寫為： <img src="../timg/5808b1829895.jpg" /></p>
<p>其中的 Z 是指標準常態分部，也就是 <img src="../timg/41f620914dc6.jpg" /> 會趨近標準常態分布。</p>
<h2 id="中央極限定理的用途"><a href="#中央極限定理的用途">中央極限定理的用途</a></h2>
<p>根據上述的定義，我們知道當樣本數 n 足夠大時 (通常 20 個以上就夠大了)， n 個樣本的平均值 <img src="../timg/894e240322d2.jpg" /> 會趨近於常態分布，換句話說也就是 <img src="../timg/41f620914dc6.jpg" /> 會趨近於標準常態分布。</p>
<p>因此、當我們取得一組樣本之後，我們就可以計算其平均數 <span class="math">$\frac{x_1+x_2+...+x_n}{n}=\bar{x}$</span>，如果有人告訴我們說母體的 平均數 <img src="../timg/c9faf6ead2cd.jpg" /> 的值是多少，我們就可以看看 <img src="../timg/6fbdf291cda8.jpg" /> 與 <img src="../timg/c9faf6ead2cd.jpg" /> 是否差距很遠，如果差距很遠， 導致 <img src="../timg/6fbdf291cda8.jpg" /> 來自平均數 <img src="../timg/c9faf6ead2cd.jpg" /> 母體的機率很小，那麼很可能是此組樣本是非常罕見的特例，或者該組樣本的抽樣有所偏差，也就是該組樣本很可能並非來自平均數為 <img src="../timg/c9faf6ead2cd.jpg" /> 的母體。</p>
<p>以下是一些標準常態分布的重要數值，</p>
<ol style="list-style-type: decimal">
<li><img src="../timg/e258ddb9fece.jpg" /></li>
<li><img src="../timg/00c3fe6de89d.jpg" /></li>
<li><img src="../timg/83a5e13e11e1.jpg" /></li>
<li><img src="../timg/352e43bbeb3a.jpg" /></li>
<li><img src="../timg/83ffc195699b.jpg" /></li>
<li><img src="../timg/62ffbb4b34fa.jpg" title="fig:" /></li>
</ol>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">1</span>)-<span class="kw">pnorm</span>(-<span class="dv">1</span>)
[<span class="dv">1</span>] <span class="fl">0.6826895</span>
&gt;<span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">2</span>)-<span class="kw">pnorm</span>(-<span class="dv">2</span>)
[<span class="dv">1</span>] <span class="fl">0.9544997</span>
&gt;<span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">3</span>)-<span class="kw">pnorm</span>(-<span class="dv">3</span>)
[<span class="dv">1</span>] <span class="fl">0.9973002</span>
&gt;<span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">4</span>)-<span class="kw">pnorm</span>(-<span class="dv">4</span>)
[<span class="dv">1</span>] <span class="fl">0.9999367</span>
&gt;<span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">5</span>)-<span class="kw">pnorm</span>(-<span class="dv">5</span>)
[<span class="dv">1</span>] <span class="fl">0.9999994</span>
&gt;<span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">6</span>)-<span class="kw">pnorm</span>(-<span class="dv">6</span>)
[<span class="dv">1</span>] <span class="dv">1</span>
&gt;<span class="st"> </span><span class="kw">options</span>(<span class="dt">digits=</span><span class="dv">10</span>)
&gt;<span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">6</span>)-<span class="kw">pnorm</span>(-<span class="dv">6</span>)
[<span class="dv">1</span>] <span class="fl">0.999999998</span></code></pre>
<p>從上面的數值您可以看出來，管理學上所謂的六標準差其實是很高的一個要求，也就是良率必須要達到 99.9999998% 以上才行。</p>
<p>如果您今天所取的 n 個樣本，與母體平均數 <img src="../timg/c9faf6ead2cd.jpg" /> 距離兩個標準差以上，那就很可能有問題了，這種推論稱為檢定，我們可以用 R 軟體中的 t.test 函數來檢驗這件事，我們將在下一期當中說明如何用 R 軟體進行統計檢定的主題，讓我們先將焦點移回到中央極限定理身上，用 R 軟體 來驗證該定理。</p>
<h2 id="r-程式範例驗證中央極限定理"><a href="#r-程式範例驗證中央極限定理">R 程式範例：驗證中央極限定理</a></h2>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>u &lt;-<span class="st"> </span><span class="kw">matrix</span> ( <span class="kw">runif</span>(<span class="dv">500000</span>), <span class="dv">50</span>, <span class="dv">10000</span> )
&gt;<span class="st"> </span>y &lt;-<span class="st"> </span><span class="kw">apply</span> ( u, <span class="dv">2</span>, mean )
&gt;<span class="st"> </span><span class="kw">hist</span>(u[,<span class="dv">1</span>])
&gt;<span class="st"> </span><span class="kw">hist</span>(y)
&gt;<span class="st"> </span>?apply
&gt;<span class="st"> </span></code></pre>
<p>說明：</p>
<ol style="list-style-type: decimal">
<li>u 乃是將 50 萬個 uniform 樣本分配成 50*10000 的矩陣，</li>
<li>y 對 u 進行列統計 apply ( u, 2, mean ) 代表對每行取平均值 mean(col of u) 的結果。</li>
<li>因此 y 代表從 Uniform Distribution 中每次取出 50 個樣本，然後進行加總平均的結果，也就是 <img src="../timg/8c510cfb8483.jpg" /> 。</li>
<li>從下列的 hist(y) 圖形中，我們可以看到中央極限定理的證據：也就是 <img src="../timg/8c510cfb8483.jpg" /> 會趨向常態分布。</li>
</ol>
<div class="figure">
<img src="../img/HistU.jpg" alt="圖、hist(u[,1]) 畫出的圖形" /><p class="caption">圖、hist(u[,1]) 畫出的圖形</p>
</div>
<div class="figure">
<img src="../img/HistY.jpg" alt="圖、hist(y) 畫出的圖形" /><p class="caption">圖、hist(y) 畫出的圖形</p>
</div>
<pre class="sourceCode R"><code class="sourceCode r">CLT =<span class="st"> </span>function(x) {
  op&lt;-<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>)) <span class="co"># 設為 2*2 的四格繪圖版</span>
  <span class="kw">hist</span>(x, <span class="dt">nclass=</span><span class="dv">50</span>)     <span class="co"># 繪製 x 序列的直方圖 (histogram)。</span>
  m2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(x, <span class="dt">nrow=</span><span class="dv">2</span>, )  <span class="co"># 將 x 序列分為 2*k 兩個一組的矩陣 m2。</span>
  xbar2 &lt;-<span class="st"> </span><span class="kw">apply</span>(m2, <span class="dv">2</span>, mean)   <span class="co"># 取每兩個一組的平均值 (x1+x2)/2 放入 xbar2 中。</span>
  <span class="kw">hist</span>(xbar2, <span class="dt">nclass=</span><span class="dv">50</span>)     <span class="co"># 繪製 xbar2 序列的直方圖 (histogram)。</span>
  m10 &lt;-<span class="st"> </span><span class="kw">matrix</span>(x, <span class="dt">nrow=</span><span class="dv">10</span>, )   <span class="co"># 將 x 序列分為 10*k 兩個一組的矩陣 m10。</span>
  xbar10 &lt;-<span class="st"> </span><span class="kw">apply</span>(m10, <span class="dv">2</span>, mean) <span class="co"># 取每10個一組的平均值 (x1+..+x10)/10 放入 xbar10 中。</span>
  <span class="kw">hist</span>(xbar10, <span class="dt">nclass=</span><span class="dv">50</span>)    <span class="co"># 繪製 xbar10 序列的直方圖 (histogram)。</span>
  m20 &lt;-<span class="st"> </span><span class="kw">matrix</span>(x, <span class="dt">nrow=</span><span class="dv">20</span>, )   <span class="co"># 將 x 序列分為 25*k 兩個一組的矩陣 m25。</span>
  xbar20 &lt;-<span class="st"> </span><span class="kw">apply</span>(m20, <span class="dv">2</span>, mean) <span class="co"># 取每20個一組的平均值 (x1+..+x20)/20 放入 xbar20 中。</span>
  <span class="kw">hist</span>(xbar20, <span class="dt">nclass=</span><span class="dv">50</span>)    <span class="co"># 繪製 xbar20 序列的直方圖 (histogram)。</span>
}

<span class="kw">CLT</span>(<span class="kw">rbinom</span>(<span class="dv">100000</span>, <span class="dv">20</span>, <span class="fl">0.5</span>)) <span class="co"># 用參數為 n=20, p=0.5 的二項分布驗證中央極限定理。</span>
<span class="kw">CLT</span>(<span class="kw">runif</span>(<span class="dv">100000</span>)) <span class="co"># 用參數為 a=0, b=1 的均等分布驗證中央極限定理。</span>
<span class="kw">CLT</span>(<span class="kw">rpois</span>(<span class="dv">100000</span>, <span class="dv">4</span>)) <span class="co"># 用參數為 lambda=4 的布瓦松分布驗證中央極限定理。</span>
<span class="kw">CLT</span>(<span class="kw">rgeom</span>(<span class="dv">100000</span>, <span class="fl">0.5</span>)) <span class="co"># 用參數為 n=20, m=10, k=5 的超幾何分布驗證中央極限定理。</span>
<span class="kw">CLT</span>(<span class="kw">rhyper</span>(<span class="dv">100000</span>, <span class="dv">20</span>, <span class="dv">10</span>, <span class="dv">5</span>)) <span class="co"># 用參數為 p=0.5 的幾何分布驗證中央極限定理。</span>
<span class="kw">CLT</span>(<span class="kw">rnorm</span>(<span class="dv">100000</span>)) <span class="co"># 用參數為 mean=0, sd=1 的標準常態分布驗證中央極限定理。</span>
<span class="kw">CLT</span>(<span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">6</span>, <span class="dv">100000</span>, <span class="dt">replace=</span>T)) <span class="co"># 用擲骰子的分布驗證中央極限定理。</span>
<span class="kw">CLT</span>(<span class="kw">sample</span>(<span class="dv">0</span>:<span class="dv">1</span>, <span class="dv">100000</span>, <span class="dt">replace=</span>T)) <span class="co"># 用丟銅板的分布驗證中央極限定理。</span></code></pre>
<p>以下是這些指令的執行結果，從這些圖中您可以看到當樣本數到達 20 個的時候，幾乎每種樣本都會趨向常態分布。</p>
<div class="figure">
<img src="../img/CLT_rbinom.jpg" alt="圖、指令 CLT(rbinom(100000, 20, 0.5)) 的執行結果" /><p class="caption">圖、指令 CLT(rbinom(100000, 20, 0.5)) 的執行結果</p>
</div>
<div class="figure">
<img src="../img/CLT_runif.jpg" alt="圖、指令 CLT(runif(100000)) 的執行結果" /><p class="caption">圖、指令 CLT(runif(100000)) 的執行結果</p>
</div>
<div class="figure">
<img src="../img/CLT_rpois.jpg" alt="圖、指令 CLT(rpois(100000, 4)) 的執行結果" /><p class="caption">圖、指令 CLT(rpois(100000, 4)) 的執行結果</p>
</div>
<div class="figure">
<img src="../img/CLT_rgeom.jpg" alt="圖、指令 CLT(rgeom(100000, 0.5)) 的執行結果" /><p class="caption">圖、指令 CLT(rgeom(100000, 0.5)) 的執行結果</p>
</div>
<div class="figure">
<img src="../img/CLT_rhyper.jpg" alt="圖、指令 CLT(rhyper(100000, 20, 10, 5)) 的執行結果" /><p class="caption">圖、指令 CLT(rhyper(100000, 20, 10, 5)) 的執行結果</p>
</div>
<div class="figure">
<img src="../img/CLT_rnorm.jpg" alt="圖、指令 CLT(rnorm(100000)) 的執行結果" /><p class="caption">圖、指令 CLT(rnorm(100000)) 的執行結果</p>
</div>
<div class="figure">
<img src="../img/CLT_sample1_6.jpg" alt="圖、指令 CLT(sample(1:6, 100000, replace=T)) 的執行結果" /><p class="caption">圖、指令 CLT(sample(1:6, 100000, replace=T)) 的執行結果</p>
</div>
<div class="figure">
<img src="../img/CLT_sample0_1.jpg" alt="圖、指令 CLT(sample(0:1, 100000, replace=T)) 的執行結果" /><p class="caption">圖、指令 CLT(sample(0:1, 100000, replace=T)) 的執行結果</p>
</div>
<h2 id="結語-3"><a href="#結語-3">結語</a></h2>
<p>在本節當中，我們沒有證明「大數法則、柴比雪夫不等式、中央極限定理」等數學定律，只用了 R 軟體來驗證中央極限定理， 如果對數學比較有興趣的同學，可以參考以下參考文獻中維基百科的證明。</p>
<h2 id="參考文獻-1"><a href="#參考文獻-1">參考文獻</a></h2>
<ul>
<li><a href="http://msenux.redwoods.edu/math/R/CentralLimit.php">The Central Limit Theorem (Part 1)</a></li>
<li><a href="http://episte.math.ntu.edu.tw/articles/mm/mm_09_3_07/index.html">洋洋 -- 淺談機率上的幾個極限定理</a></li>
<li>Proof of Central Limit Theorem, H. Krieger, Mathematics 157, Harvey Mudd College, Spring, 2005
<ul>
<li><a href="http://www.math.hmc.edu/~krieger/m157cltproof.pdf">http://www.math.hmc.edu/~krieger/m157cltproof.pdf</a></li>
</ul></li>
<li>Wikipedia:<a href="http://en.wikipedia.org/wiki/Law_of_large_numbers">Law of large numbers</a> (有證明柴比雪夫不等式與大數法則)</li>
<li>Wikipedia:Chebyshev's inequality -- <a href="http://en.wikipedia.org/wiki/Chebyshev&#39;s_inequality">http://en.wikipedia.org/wiki/Chebyshev's_inequality</a></li>
<li>Wikipedia:<a href="http://en.wikipedia.org/wiki/Central_limit_theorem">Central limit theorem</a> (有證明中央極限定理)</li>
<li>維基百科：<a href="http://zh.wikipedia.org/wiki/%E5%A4%A7%E6%95%B0%E5%AE%9A%E5%BE%8B">大數定律</a></li>
<li>維基百科：<a href="http://zh.wikipedia.org/wiki/%E5%88%87%E6%AF%94%E9%9B%AA%E5%A4%AB%E4%B8%8D%E7%AD%89%E5%BC%8F">切比雪夫不等式</a> (有證明柴比雪夫不等式)</li>
<li>維基百科：<a href="http://zh.wikipedia.org/wiki/%E4%B8%AD%E5%BF%83%E6%9E%81%E9%99%90%E5%AE%9A%E7%90%86">中央極限定理</a></li>
<li>Two Proofs of the Central Limit Theorem, Yuval Filmus, January/February 2010
<ul>
<li><a href="http://www.cs.toronto.edu/~yuvalf/CLT.pdf">http://www.cs.toronto.edu/~yuvalf/CLT.pdf</a></li>
</ul></li>
</ul>
<h1 id="平均值的估計與檢定"><a href="#平均值的估計與檢定">平均值的估計與檢定</a></h1>
<p>在上一章當中，我們說明了中央極限定理的意義，也就是對於某母體 (平均數 mean、標準差 sd) 而言，抽出 n 個獨立樣本 <img src="../timg/9c792ececfe2.jpg" /> ， 其平均數 <img src="../timg/df18a7e9a42b.jpg" /> 會趨近於常態分布 N(mean, sd/n) 。</p>
<p>換句話說，也就是 <img src="../timg/aacc3e705de5.jpg" /> 會趨近於標準常態分布 <img src="../timg/0c296e59e0b7.jpg" /> 。</p>
<p>有了這樣的定理當基礎，我們就可以進行估計了！但在這之前，我們必須先理解一個關念，那就是信賴區間。</p>
<h2 id="信賴區間"><a href="#信賴區間">信賴區間</a></h2>
<p>對於一個機率分布 X 而言，假如其機率密度函數為 P(x)，那麼該機率分布在 L1 ≤ x ≤ L2 這個區域之間的機率總和，可以寫成如下算式：</p>
<table>
<thead>
<tr class="header">
<th align="left">分布類型</th>
<th align="left">P(L1 ≤ x ≤ L2)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">離散情況</td>
<td align="left"><img src="../timg/1687f6278d44.jpg" /></td>
</tr>
<tr class="even">
<td align="left">連續情況</td>
<td align="left"><img src="../timg/aaddddbd6cbb.jpg" /></td>
</tr>
</tbody>
</table>
<p>由於是機率分布，所以上述算式的總和必然介於 0 到 1 之間，假如我們稱該總和為 <img src="../timg/b0603860fcff.jpg" /> ，那麼該區間就是一個機率值為 <img src="../timg/b0603860fcff.jpg" /> 的信賴區間。</p>
<p>補充：我們經常將該 <img src="../timg/b0603860fcff.jpg" /> 寫為 <img src="../timg/eeb9858e2850.jpg" /> ，然後稱該區間為 <img src="../timg/79371bd05887.jpg" /> 的信賴區間。</p>
<p>為了瞭解信賴區間的慨念，先讓我們看看常態分配 (Normal) 與均等分配 (Uniform) 等兩個機率分布的圖形：</p>
<div class="figure">
<img src="../img/NormCurve.jpg" alt="標準常態分配的圖形 N(mean=0, sd=1)" /><p class="caption">標準常態分配的圖形 N(mean=0, sd=1)</p>
</div>
<div class="figure">
<img src="../img/UnifCurve.jpg" alt="標準均等分配圖形 U(min=0, max=1)" /><p class="caption">標準均等分配圖形 U(min=0, max=1)</p>
</div>
<p>接著讓我們先用均等分配為例，說明信賴區間的概念。舉例而言，假如對於一個介於 0 到 10 之間的均等分布而言， 由於每個點的機率密度函數為 1/10，因此介於 (1, 9) 之間的機率將會是 0.8，也就是 80%。 因此 (1, 9) 是該機率母體的 80% 信賴區間，以下是我們用 R 軟體反應這個信賴區間的操作過程。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>L2=<span class="kw">punif</span>(<span class="dv">9</span>, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">10</span>)
&gt;<span class="st"> </span>L2
[<span class="dv">1</span>] <span class="fl">0.9</span>
&gt;<span class="st"> </span>L1=<span class="kw">punif</span>(<span class="dv">1</span>, <span class="dt">min=</span><span class="dv">0</span>, <span class="dt">max=</span><span class="dv">10</span>)
&gt;<span class="st"> </span>L1
[<span class="dv">1</span>] <span class="fl">0.1</span>
&gt;<span class="st"> </span>L2-L1
[<span class="dv">1</span>] <span class="fl">0.8</span></code></pre>
<h2 id="常態分布的信賴區間"><a href="#常態分布的信賴區間">常態分布的信賴區間</a></h2>
<p>根據中央極限定理，在樣本數夠多 (通常 &gt; 20) 的情況之下，平均值 <img src="../timg/58c3d0d0ebe0.jpg" /> 會趨近於常態分布， 因此常態分布的信賴區間對估計 <img src="../timg/58c3d0d0ebe0.jpg" /> 相當重要，所以我們接下來要看看常態分布的信賴區間。</p>
<p>假如您已經知道某母體為常態分布，而且期望值 (平均值) 為 mean ，標準差為 sd ， 那麼當您用該母體來產生樣本，有多少的樣本會落在範圍 (L1, L2) 之外呢？</p>
<p>上述問題感覺數學符號多了一點，讓我們用實際的數字來進一步說明。</p>
<p>假如母體為標準常態分布 Z=N(0, 1) ，那麼請問產生的樣本落在 (-2, 2) 之外的會有多少呢？</p>
<p>這個問題讓我們用 R 軟體來實際操做看看。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>L2=<span class="kw">pnorm</span>(<span class="dv">2</span>, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">1</span>)
&gt;<span class="st"> </span>L1=<span class="kw">pnorm</span>(-<span class="dv">2</span>, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">1</span>)
&gt;<span class="st"> </span>L1
[<span class="dv">1</span>] <span class="fl">0.02275013</span>
&gt;<span class="st"> </span>L2
[<span class="dv">1</span>] <span class="fl">0.9772499</span>
&gt;<span class="st"> </span>L2-L1
[<span class="dv">1</span>] <span class="fl">0.9544997</span>
&gt;<span class="st"> </span><span class="fl">1.0</span>-(L2-L1)
[<span class="dv">1</span>] <span class="fl">0.04550026</span></code></pre>
<p>以上的操作告訴我們，標準常態分布 Z 的樣本落在 (-2, 2) 之內的機率約為 0.9544997，因此落在範圍外的機率為 0.04550026。</p>
<p>那麼，假如不是標準常態分布，那又如何呢？其實只要知道平均值 mean 與標準差為 sd ，就可以輕易的用 R 軟體算出來。 舉例而言，假如某母體為常態分布 N(mean=5, sd=3) ，那麼若我們想知道其樣本落在 (3, 6) 之間的機率有多少，就可以用 下列操作計算出來。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>L2=<span class="kw">pnorm</span>(<span class="dv">6</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">3</span>)
&gt;<span class="st"> </span>L1=<span class="kw">pnorm</span>(<span class="dv">3</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">3</span>)
&gt;<span class="st"> </span>L1
[<span class="dv">1</span>] <span class="fl">0.2524925</span>
&gt;<span class="st"> </span>L2
[<span class="dv">1</span>] <span class="fl">0.6305587</span>
&gt;<span class="st"> </span>L2-L1
[<span class="dv">1</span>] <span class="fl">0.3780661</span></code></pre>
<p>根據上述操作，我們知道樣本落在 (3, 6) 之間的機率為 0.3780661。</p>
<p>當然、如果我們真的去用 N(mean=5, sd=3) 的隨機函數產生樣本，其統計值並不一定會那麼的準，但是樣本越多的話， 統計值就會越準，請看下列操作。</p>
<p>操作：產生 10 個樣本的情況</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x=<span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">3</span>)
&gt;<span class="st"> </span>x
 [<span class="dv">1</span>]  <span class="fl">6.387168</span>  <span class="fl">7.292018</span>  <span class="fl">4.680202</span>  <span class="fl">2.225559</span> <span class="fl">11.208245</span>  <span class="fl">7.040107</span>  <span class="fl">2.739477</span>
 [<span class="dv">8</span>]  <span class="fl">2.316105</span>  <span class="fl">4.482658</span>  <span class="fl">4.913032</span>
&gt;<span class="st"> </span><span class="dv">3</span>&lt;x
 [<span class="dv">1</span>]  <span class="ot">TRUE</span>  <span class="ot">TRUE</span>  <span class="ot">TRUE</span> <span class="ot">FALSE</span>  <span class="ot">TRUE</span>  <span class="ot">TRUE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span>  <span class="ot">TRUE</span>  <span class="ot">TRUE</span>
&gt;<span class="st"> </span>x&lt;<span class="dv">6</span>
 [<span class="dv">1</span>] <span class="ot">FALSE</span> <span class="ot">FALSE</span>  <span class="ot">TRUE</span>  <span class="ot">TRUE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span>  <span class="ot">TRUE</span>  <span class="ot">TRUE</span>  <span class="ot">TRUE</span>  <span class="ot">TRUE</span>
&gt;<span class="st"> </span><span class="dv">3</span>&lt;x &amp;<span class="st"> </span>x&lt;<span class="dv">6</span>
 [<span class="dv">1</span>] <span class="ot">FALSE</span> <span class="ot">FALSE</span>  <span class="ot">TRUE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span> <span class="ot">FALSE</span>  <span class="ot">TRUE</span>  <span class="ot">TRUE</span>
&gt;<span class="st"> </span><span class="kw">sum</span>(<span class="dv">3</span>&lt;x &amp;<span class="st"> </span>x&lt;<span class="dv">6</span>)
[<span class="dv">1</span>] <span class="dv">3</span>
&gt;<span class="st"> </span><span class="kw">sum</span>(<span class="dv">3</span>&lt;x &amp;<span class="st"> </span>x&lt;<span class="dv">6</span>)/<span class="dv">10</span>
[<span class="dv">1</span>] <span class="fl">0.3</span></code></pre>
<p>操作：產生 100 個樣本的情況</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x=<span class="kw">rnorm</span>(<span class="dv">100</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">3</span>)
&gt;<span class="st"> </span><span class="kw">sum</span>(<span class="dv">3</span>&lt;x &amp;<span class="st"> </span>x&lt;<span class="dv">6</span>)
[<span class="dv">1</span>] <span class="dv">34</span>
&gt;<span class="st"> </span><span class="kw">sum</span>(<span class="dv">3</span>&lt;x &amp;<span class="st"> </span>x&lt;<span class="dv">6</span>)/<span class="dv">100</span>
[<span class="dv">1</span>] <span class="fl">0.34</span></code></pre>
<p>操作：產生 100000 個樣本的情況</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x=<span class="kw">rnorm</span>(<span class="dv">100000</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">3</span>)
&gt;<span class="st"> </span><span class="kw">sum</span>(<span class="dv">3</span>&lt;x &amp;<span class="st"> </span>x&lt;<span class="dv">6</span>)
[<span class="dv">1</span>] <span class="dv">37865</span>
&gt;<span class="st"> </span><span class="kw">sum</span>(<span class="dv">3</span>&lt;x &amp;<span class="st"> </span>x&lt;<span class="dv">6</span>)/<span class="dv">100000</span>
[<span class="dv">1</span>] <span class="fl">0.37865</span></code></pre>
<p>以上的操作大致反映出了「大數法則」，樣本越多就會越接近母體的分布。</p>
<p>但是，如果我們先給定要求的機率，而不是先給定區間，那麼要如何找出符合該機率的區間呢？</p>
<p>舉例而言，假如我們想知道常態分布 N(mean=5, sd=3) 的 98% 信賴區間，那麼應該怎麼作呢？以下是我們的操作。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>L1=<span class="kw">qnorm</span>(<span class="fl">0.01</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">3</span>)
&gt;<span class="st"> </span>L1
[<span class="dv">1</span>] -<span class="fl">1.979044</span>
&gt;<span class="st"> </span>L2=<span class="kw">qnorm</span>(<span class="fl">0.99</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">3</span>)
&gt;<span class="st"> </span>L2
[<span class="dv">1</span>] <span class="fl">11.97904</span>
&gt;<span class="st"> </span>P1=<span class="kw">pnorm</span>(L1, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">3</span>)
&gt;<span class="st"> </span>P1
[<span class="dv">1</span>] <span class="fl">0.01</span>
&gt;<span class="st"> </span>P2=<span class="kw">pnorm</span>(L2, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">3</span>)
&gt;<span class="st"> </span>P2
[<span class="dv">1</span>] <span class="fl">0.99</span>
&gt;<span class="st"> </span>P2</code></pre>
<p>在上述操作中，我們先將 (100-98)% = 2% ，平均分配到常態分配的兩端，然後透過 <code>qnorm(0.01, mean=5, sd=3)</code> 找出下界 L1，接著透過 <code>L2=qnorm(0.99, mean=5, sd=3)</code> 找出上界 L2，如此就找出了該常態分布的 98% 信賴區間，為 (L1=-1.979044, L2=11.97904)。</p>
<p>為了驗證這個答案是正確的，我們再度用 <code>P1=pnorm(L1, mean=5, sd=3)</code> 找出 L1 之前的累積機率，發現確實是 0.01 (也就是 1%)， 而 L2 之前的累積機率是 0.99 (99%)，因此該區間的機率就是 P2 - P1 = 0.99-0.01 = 0.98。</p>
<p>接著，我們可以利用該母體產生很多樣本，以驗證看看這些樣本落於信賴區間內的機率是否符合 98% 的條件，以下是對應的 R 軟體操作。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100000</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">3</span>)
&gt;<span class="st"> </span>p =<span class="st"> </span><span class="kw">sum</span>(L1&lt;x &amp;<span class="st"> </span>x&lt;L2)/<span class="dv">100000</span>
&gt;<span class="st"> </span>p
[<span class="dv">1</span>] <span class="fl">0.98012</span></code></pre>
<p>在上述操作中，您可以看到當我們產生十萬個樣本時，這些樣本落在信賴區間內的機率為 0.9812，相當接近 0.98 這個預期值，這用實驗 驗證了上述信賴區間的機率應該是對的。</p>
<h2 id="平均值的信賴區間"><a href="#平均值的信賴區間">平均值的信賴區間</a></h2>
<p>按照上述的方法，若我們知道母體為何，那麼就很容易找出一個信賴區間符合特定的機率要求，但是在統計的情況之下，我們往往不知道 母體為何？</p>
<p>如果我們知道母體是 N(mean=5, sd=3)，那麼我們根本不需要計算平均數，因為 mean=5 就告訴了你母體的平均數是 5。</p>
<p>但是當我們不知道母體平均數的時候，如何用樣本 <img src="../timg/97f71577a235.jpg" /> 去推測 (或說猜測) 母體的平均數 mean 呢？</p>
<p>這個情況有點像下述的 R 程式，讓我們看看以下操作：</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span>mu, <span class="dt">sd=</span><span class="dv">2</span>)
&gt;<span class="st"> </span>x
 [<span class="dv">1</span>] <span class="fl">10.829923</span>  <span class="fl">7.786320</span>  <span class="fl">6.975080</span>  <span class="fl">6.980363</span>  <span class="fl">8.999509</span>  <span class="fl">7.343410</span>  <span class="fl">5.928051</span>  <span class="fl">9.158911</span>
 [<span class="dv">9</span>] <span class="fl">10.116548</span>  <span class="fl">7.042043</span>  <span class="fl">8.434972</span> <span class="fl">10.530158</span>  <span class="fl">7.258413</span>  <span class="fl">8.990531</span>  <span class="fl">8.484475</span>  <span class="fl">9.104462</span>
[<span class="dv">17</span>]  <span class="fl">1.223568</span>  <span class="fl">7.011966</span>  <span class="fl">6.405762</span>  <span class="fl">4.449411</span> <span class="fl">11.465473</span>  <span class="fl">7.382751</span> <span class="fl">10.305355</span> <span class="fl">10.201814</span>
[<span class="dv">25</span>] <span class="fl">11.802796</span>
&gt;<span class="st"> </span><span class="kw">mean</span>(x)
[<span class="dv">1</span>] <span class="fl">8.168483</span>
&gt;<span class="st"> </span><span class="kw">sd</span>(x)
[<span class="dv">1</span>] <span class="fl">2.332146</span>
&gt;<span class="st"> </span></code></pre>
<p>在上述操作中，我們知道標準差 sd=2，但是不知道平均數 mean=mu (由於程式中沒辦法打數學符號， 以下的 mu 其實都代表數學符號 <span class="math"><em>μ</em></span>) 中的 mu 是多少，不過我們可以觀察到 25 個樣本序列 <img src="../timg/3e594ea568a4.jpg" /> 的值，而且可以計算出這些樣本的平均值 mean(x) = 8.168483 與 樣本變異數 sd(x) = 2.332145。</p>
<p>問題是，母體的平均值 mean (也就是 mu) 到底是多少呢？</p>
<p>這時我們必需要猜測 (或說推測)！</p>
<p>一個最簡單的推測是，我們認為 mean(x) 的值 8.168483 來取代母體的 mean ，也就是直接認為「樣本的平均值 = 母體的平均值」， 這種推測方法雖然很簡單，但是卻通常不錯。</p>
<p>這種以單一數值推測母體參數的方法，稱為「點估計」。</p>
<p>但是「點估計」太過武斷，事實上筆者用來產生上述樣本時，所設定的 mu 值為 8.0，而不是 8.168483 (不過您可以看到其實蠻接近的)。</p>
<p>如果我們將「估計的方法」改變一下，不要硬用一個點套上去，而是改去推測 mu 的可能範圍，那麼這種估計方法就會變化為「區間估計」。</p>
<p>當母體的標準差 <img src="../timg/70a1e66a8c41.jpg" /> 為已知的時候，根據中央極限定理，平均值會趨近於常態分布，因此我們可以用常態分布來進行「信賴區間估計」，這就是尚未正規化之前的中央極限定理，如下公式所示：</p>
<div class="figure">
<img src="../timg/25f0924b0a29.jpg" />
</div>
<p>但是、如果我們將上述的平均值進行正規化，也就是移項並調整之後，改用下式表示：</p>
<div class="figure">
<img src="../timg/3d94d6ee1424.jpg" />
</div>
<p>那麼我們就可以用下列程式來估計這種母體標準差已知情況下的平均值 <img src="../timg/c9faf6ead2cd.jpg" /> 了。</p>
<pre class="sourceCode R"><code class="sourceCode r">mean.range =<span class="st"> </span>function(x, <span class="dt">alpha=</span><span class="fl">0.05</span>, sd) {
    n =<span class="st"> </span><span class="kw">length</span>(x) <span class="co"># n = 樣本數</span>
    mx =<span class="st"> </span><span class="kw">mean</span>(x) <span class="co"># mx 即為平均值 mu 的點估計</span>
    r1 =<span class="st"> </span><span class="kw">qnorm</span>(alpha/<span class="dv">2</span>) <span class="co"># 信賴區間，下半截掉 alpha/2</span>
    r2 =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span>-alpha/<span class="dv">2</span>) <span class="co"># 信賴區間，上半截掉 alpha/2</span>
    L1 =<span class="st"> </span>mx-r2*sd/<span class="kw">sqrt</span>(n) <span class="co"># 信賴區間下限</span>
    L2 =<span class="st"> </span>mx-r1*sd/<span class="kw">sqrt</span>(n) <span class="co"># 信賴區間上限</span>
    range =<span class="st"> </span><span class="kw">c</span>(L1, mx, L2) <span class="co"># 信賴區間</span>
}</code></pre>
<p>於是我們可以用這個程式去進行區間估計，得到下列操作結果。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>mean.range =<span class="st"> </span>function(x, <span class="dt">alpha=</span><span class="fl">0.05</span>, sd) {
+<span class="st">     </span>n =<span class="st"> </span><span class="kw">length</span>(x) <span class="co"># n = 樣本數</span>
+<span class="st">     </span>mx =<span class="st"> </span><span class="kw">mean</span>(x) <span class="co"># mx 即為平均值 mu 的點估計</span>
+<span class="st">     </span>r1 =<span class="st"> </span><span class="kw">qnorm</span>(alpha/<span class="dv">2</span>) <span class="co"># 信賴區間，下半截掉 alpha/2</span>
+<span class="st">     </span>r2 =<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span>-alpha/<span class="dv">2</span>) <span class="co"># 信賴區間，上半截掉 alpha/2</span>
+<span class="st">     </span>L1 =<span class="st"> </span>mx-r2*sd/<span class="kw">sqrt</span>(n) <span class="co"># 信賴區間下限</span>
+<span class="st">     </span>L2 =<span class="st"> </span>mx-r1*sd/<span class="kw">sqrt</span>(n) <span class="co"># 信賴區間上限</span>
+<span class="st">     </span>range =<span class="st"> </span><span class="kw">c</span>(L1, mx, L2) <span class="co"># 信賴區間</span>
+<span class="st"> </span>}
&gt;<span class="st"> </span><span class="kw">mean.range</span>(x, <span class="dt">sd=</span><span class="dv">2</span>)
&gt;<span class="st"> </span>R =<span class="st"> </span><span class="kw">mean.range</span>(x, <span class="dt">sd=</span><span class="dv">2</span>)
&gt;<span class="st"> </span>R
[<span class="dv">1</span>] <span class="fl">7.384497</span> <span class="fl">8.168483</span> <span class="fl">8.952468</span></code></pre>
<p>上述操作代表根據樣本 x 所推估的 95% 的信賴區間 ( alpha=0.05, 1-alpha=0.95) 為 (7.384497, 8.952468)， 而樣本的平均值 mean(x) 為 8.168483。</p>
<p>現在我們已經學會的信賴區間估計的方法，但是卻還有一個缺憾！</p>
<p>通常我們除了不知道母體的平均值 mu 之外，我們也不會知道母體的標準差 sd ，因此上述的推估程式其實沒有太大的實用價值！</p>
<p>(這也是為何 R 軟體預設的套建沒有納入這類函數的原因之一)。</p>
<h2 id="t-分佈與平均值的檢定"><a href="#t-分佈與平均值的檢定">T 分佈與平均值的檢定</a></h2>
<p>當母體標準差 sd 未知的時候，我們就無法用常態分布來進行推估了，而必需要用一種稱為 T 分配的分布，來推估母體平均值 mean 的範圍。</p>
<p>那麼、T 分布到底是甚麼呢？其實 T 分布只是常態分布考慮「標準差」未知情況下的一種調整後的結果而已。</p>
<p>因為當標準差 <img src="../timg/a2ab7d71a0f0.jpg" /> 未知時，我們只能改用「樣本標準差 S」 來估計「母體標準差 」，因此我們可以列出下列兩個算式。</p>
<div class="figure">
<img src="../timg/ca9f9a7bb7d1.jpg" />
</div>
<div class="figure">
<img src="../timg/7ce8d791ab86.jpg" />
</div>
<p>當上述兩個分佈互相獨立時，我們就可以得到一種經由卡方 ( <img src="../timg/9ca61f458c78.jpg" /> ) 分布調整過的常態分布，稱為 T ，其定義如下：</p>
<div class="figure">
<img src="../timg/75c24cae26f8.jpg" />
</div>
<p>讓我們些看看 T 分布到底長得什麼樣？</p>
<p>其實 T 分布與常態分布非常接近，只是考慮到樣本數量 (自由度+1) 的影響力，因此稍微矮了一點點而已，我們可以從以下的操作與圖形 當中看到 T 分布與常態分布之間的差異。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">curve</span>(dnorm, <span class="dt">from=</span>-<span class="dv">3</span>, <span class="dt">to=</span><span class="dv">3</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>)
&gt;<span class="st"> </span><span class="kw">curve</span>(<span class="kw">dt</span>(x, <span class="dt">df=</span><span class="dv">25</span>), <span class="dt">from=</span>-<span class="dv">3</span>, <span class="dt">to=</span><span class="dv">3</span>, <span class="dt">add=</span>T, <span class="dt">ylab=</span><span class="st">&quot;T25&quot;</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>)
&gt;<span class="st"> </span><span class="kw">curve</span>(<span class="kw">dt</span>(x, <span class="dt">df=</span><span class="dv">10</span>), <span class="dt">from=</span>-<span class="dv">3</span>, <span class="dt">to=</span><span class="dv">3</span>, <span class="dt">add=</span>T, <span class="dt">ylab=</span><span class="st">&quot;T10&quot;</span>, <span class="dt">col=</span><span class="st">&quot;red&quot;</span>)
&gt;<span class="st"> </span><span class="kw">curve</span>(<span class="kw">dt</span>(x, <span class="dt">df=</span><span class="dv">3</span>), <span class="dt">from=</span>-<span class="dv">3</span>, <span class="dt">to=</span><span class="dv">3</span>, <span class="dt">add=</span>T, <span class="dt">ylab=</span><span class="st">&quot;T3&quot;</span>, <span class="dt">col=</span><span class="st">&quot;green&quot;</span>)
&gt;<span class="st"> </span></code></pre>
<div class="figure">
<img src="../img/Tcurve.jpg" alt="常態分布與 T 分布 (自由度=3, 10, 25，也就是樣本數為 4, 11, 26 的情況)" /><p class="caption">常態分布與 T 分布 (自由度=3, 10, 25，也就是樣本數為 4, 11, 26 的情況)</p>
</div>
<p>有了 T 分布，我們就可以用來檢定 sd 未知情況下的平均數了，以下是我們的操作過程。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">t.test</span>(x)

        One Sample t-test

data:<span class="st">  </span>x 
t =<span class="st"> </span><span class="fl">17.5128</span>, df =<span class="st"> </span><span class="dv">24</span>, p-value =<span class="st"> </span><span class="fl">3.562e-15</span>
alternative hypothesis:<span class="st"> </span>true mean is not equal to <span class="dv">0</span> 
<span class="dv">95</span> percent confidence interval:
<span class="st"> </span><span class="fl">7.205820</span> <span class="fl">9.131145</span> 
sample estimates:
mean of x 
 <span class="fl">8.168483</span> </code></pre>
<p>上述操作中，我們用 T 分配來推估母體的平均值範圍，程式的輸出顯示其 95% 信賴區間是 (7.205820, 9.131145)。</p>
<p>事實上、t.test 所作的並不只是「估計信賴區間」而已，而是具有「檢定」某個假設可能程度的功能，因此才稱為 test。</p>
<p>在上述檢定中，我們檢定的「對立假設」(alternative hypothesis) 是 mu≠0 (true mean is not equal to 0) ，也就是 「虛無假設」是 mu=0 ，結果顯示虛無假設成立的「顯著性」只有 3.562e-15 ( <img src="../timg/ac0918bc60fe.jpg" /> ) ，可以說是幾乎不可能。</p>
<p>這個結果是合理的，因為我們用來產生樣本的母體其實是 N(mean=8, sd=2) ，距離 0 實在太遠了。</p>
<p>如果我們將 mu 改設為 8 重新進行一次檢定，您將會看到檢定結果如下：</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu=</span><span class="dv">8</span>)

        One Sample t-test

data:<span class="st">  </span>x 
t =<span class="st"> </span><span class="fl">0.3612</span>, df =<span class="st"> </span><span class="dv">24</span>, p-value =<span class="st"> </span><span class="fl">0.7211</span>
alternative hypothesis:<span class="st"> </span>true mean is not equal to <span class="dv">8</span> 
<span class="dv">95</span> percent confidence interval:
<span class="st"> </span><span class="fl">7.205820</span> <span class="fl">9.131145</span> 
sample estimates:
mean of x 
 <span class="fl">8.168483</span> </code></pre>
<p>在採用 mu=8 所進行的檢定當中，我們看到「顯著性」變成了 p-value = 0.7211，這比起 mu=0 的 p-value = 3.562e-15 大太多了， 代表 mu=8 是有可能的，我們無法否決這樣的可能性。</p>
<p>另外、輸出報告中也顯示了自由度 df = 24，T 分布中所謂的自由度其實是樣本數減一 (25-1=24)。</p>
<p>註：那麼、上述 p-value=0.7211 的値是怎麼來的呢？這牽涉到雙尾檢定的問題，因為我們想檢定的對象是 <img src="../timg/ee75d65a7289.jpg" /> ，這代表我們想要找 到一個 t 分布且自由度 df=24 的値，使其在截掉兩尾端面積的情況下，剩下的機率累計是 0.7211。如下操作所示：</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>half =<span class="st"> </span>(<span class="dv">1</span><span class="fl">-0.7211</span>)/<span class="dv">2</span>
&gt;<span class="st"> </span>df1  =<span class="st"> </span><span class="dv">24</span>
&gt;<span class="st"> </span>from=<span class="kw">qt</span>(half, <span class="dt">df=</span>df1)
&gt;<span class="st"> </span>to=<span class="kw">qt</span>(<span class="dv">1</span>-half, <span class="dt">df=</span>df1)
&gt;<span class="st"> </span><span class="kw">pt</span>(to, <span class="dt">df=</span>df1)-<span class="kw">pt</span>(from, <span class="dt">df=</span>df1)
[<span class="dv">1</span>] <span class="fl">0.7211</span></code></pre>
<h2 id="檢定的概念"><a href="#檢定的概念">檢定的概念</a></h2>
<p>想必讀到這裡，一定有人在想：我搞不清楚你說的「對立假設」、「虛無假設」、「顯著性」是甚麼東西，讓我們補充如下。</p>
<p>根據某些樣本，推論統計可以進行實驗的檢定某個假設 H1 是否可能，其方法是透過否定對立假設 H0，看看 H0 是否不太可能發生。</p>
<ul>
<li>H1：稱為研究假設 (research hypothesis) 或對立假設 (alternhative hypothesis)</li>
<li>H0：稱為虛無假設 (null hypothesis)</li>
</ul>
<p>透過推論統計，我們可以檢查實驗結果是否具有顯著性 (假設檢定)，也就是實驗的假設 H1 是否要被接受， 由於 H0 是H1 的對立假設 (不是 H0 就是 H1，也就是 H1 = not H0)，因此一旦否決了 H0 就代表接受了 H1。</p>
<p>舉例而言，以上述的 mu = 0 的情況，其虛無假設 H0 與對立假設 H1 分別如下。</p>
<ul>
<li>H0: mu=0</li>
<li>H1: mu≠0</li>
</ul>
<p>在進行假設檢定的推論時，我們可能推論正確，也可能推論錯誤，以下是四種可能的推論情況。</p>
<table>
<thead>
<tr class="header">
<th align="left">決策</th>
<th align="left">H0 為真</th>
<th align="left">H1 為真</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">拒絕 H0</td>
<td align="left">型 I 錯誤 (H0 為真卻拒絕 H0)</td>
<td align="left">正確決策</td>
</tr>
<tr class="even">
<td align="left">無法拒絕 H0</td>
<td align="left">正確決策</td>
<td align="left">型 II 錯誤 (H1 為真卻無法拒絕 H0)</td>
</tr>
</tbody>
</table>
<p>以實例來說，對於 mu 的情況，其推論決策如下表所示。</p>
<table>
<thead>
<tr class="header">
<th align="left">決策</th>
<th align="left">H0 : mu=0 為真</th>
<th align="left">H1 : mu ≠ 0 為真</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">拒絕 mu=0</td>
<td align="left">型 I 錯誤 ( mu=0 卻被我們拒絕)</td>
<td align="left">正確決策</td>
</tr>
<tr class="even">
<td align="left">無法拒絕 mu=0</td>
<td align="left">正確決策</td>
<td align="left">型 II 錯誤 ( mu ≠ 0 卻無法拒絕 mu=0)</td>
</tr>
</tbody>
</table>
<p>當然我們會希望正確決策的機會越大越好，而錯誤決策的機會越小越好。假設檢定可以告訴我們各類型正確與錯誤決策的機率， 以便讓我們知道是否要接受 H1 而拒絕 H0。</p>
<p>在檢定的結果中，我們可以用幾個線索決定是否要拒絕虛無假設 H0，改承認對立假設 H1 ，其根據大致上可以從檢定報告的 兩個部分看出來，第一部分是從「信賴區間」中可以看出，第二部分是從顯著性 P 值當中看出。</p>
<p>在上述兩次的檢定當中，由於 mu=8 位於 95% 信賴區間 (7.205820 9.131145) 之內，因此虛無假設 mu=8 無法被拒絕，也就是 mu=8 是有可能且合理的，但是 mu=0 位於 95% 信賴區間 (7.205820 9.131145) 之外，因此是不太可能，而且應該被拒絕的， 也就是 mu ≠ 0 才是比較合理且可能的。</p>
<p>另外，也可以採用顯著性 (P 值, p-value) 的方式判別，所謂的 P 值就是樣本的不合理性，舉例而言，以上述的 mu=0 的情況， P 值就被定義為 <img src="../timg/56a14687c608.jpg" /> 的機率值，由於 mu=0 的分布會產生這麼大的一組平均值的情況非常罕見， 機率只有 3.562e-15 ，因此我們可以很有信心的拒絕 H0:mu=0 這個虛無假設，改採 H1:mu ≠ 0 這個對立假設。</p>
<p>因此在上述兩次檢定中，由於 mu=8 的顯著性 (p-value) 為 <img src="../timg/a072f2c32489.jpg" /> 算蠻大的， 所以無法被拒絕，也就是 mu=8 是有可能且合理的。</p>
<p>但是在 mu=0 的檢定中，p-value = 3.562e-15，已經小到不可思議的程度，因此該檢定結果強烈拒絕 mu=0 這樣的假設， 改為支持對立假設 mu ≠ 0 。</p>
<h2 id="檢定的圖形"><a href="#檢定的圖形">檢定的圖形</a></h2>
<p>為了讓讀者更清楚的理解檢定的結果，我們找到了 R 軟體的一個套件，稱為 visualizationTools ， 您可以透過 install.packages(&quot;visualizationTools&quot;) 這個指令安裝該套件，然後用像下列指令 顯示檢定的結果。</p>
<pre class="sourceCode R"><code class="sourceCode r"><span class="kw">plot</span>(<span class="kw">t.test</span>(x, <span class="dt">mu=</span><span class="dv">5</span>))</code></pre>
<p>以下是一個完整的檢定與圖形顯示過程：</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="fl">5.5</span>, <span class="dt">sd=</span><span class="dv">2</span>)
&gt;<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">mu=</span><span class="dv">5</span>)

        One Sample t-test

data:<span class="st">  </span>x
t =<span class="st"> </span><span class="fl">0.8254</span>, df =<span class="st"> </span><span class="dv">24</span>, p-value =<span class="st"> </span><span class="fl">0.4173</span>
alternative hypothesis:<span class="st"> </span>true mean is not equal to <span class="dv">5</span>
<span class="dv">95</span> percent confidence interval:
<span class="st"> </span><span class="fl">4.508086</span> <span class="fl">6.147536</span>
sample estimates:
mean of x 
 <span class="fl">5.327811</span> 

&gt;<span class="st"> </span><span class="kw">install.packages</span>(<span class="st">&quot;visualizationTools&quot;</span>)
---<span class="st"> </span>Please select a CRAN mirror for use in this session ---
嘗試 URL <span class="st">&#39;http://cran.csie.ntu.edu.tw/bin/windows/contrib/3.0/visualizationTools_0.2.05.zip&#39;</span>
Content type <span class="st">&#39;application/zip&#39;</span> length <span class="dv">102524</span> <span class="kw">bytes</span> (<span class="dv">100</span> Kb)
開啟了 URL
downloaded <span class="dv">100</span> Kb

package ‘visualizationTools’ successfully unpacked and MD5 sums checked

The downloaded binary packages are in
        C:\Users\ccc\AppData\Local\Temp\RtmpyCqQmq\downloaded_packages
&gt;<span class="st"> </span><span class="kw">library</span>(<span class="st">&quot;visualizationTools&quot;</span>)
&gt;<span class="st"> </span><span class="kw">plot</span>(<span class="kw">t.test</span>(x, <span class="dt">mu=</span><span class="dv">5</span>))
&gt;<span class="st"> </span></code></pre>
<p>上述指令所顯示的圖形如下所示：</p>
<div class="figure">
<img src="../img/testPlot1.jpg" alt="圖、指令 plot(t.test(x, mu=5)) 的顯示結果" /><p class="caption">圖、指令 plot(t.test(x, mu=5)) 的顯示結果</p>
</div>
<p>解讀：</p>
<p>在變異數未知情況下，以下的平均值 <img src="../timg/58c3d0d0ebe0.jpg" /> 會服從自由度為 n-1 的 T 分布如下。</p>
<div class="figure">
<img src="../timg/07b9e19c218c.jpg" />
</div>
<p>如果從 <img src="../timg/c9faf6ead2cd.jpg" /> 固定的角度來看，則 <img src="../timg/58c3d0d0ebe0.jpg" /> 分布於以 <img src="../timg/c9faf6ead2cd.jpg" /> 為中心點的 <img src="../timg/ff75b36c70f3.jpg" /> 分布， 但若以 <img src="../timg/58c3d0d0ebe0.jpg" /> 固定的角度反觀，則 <img src="../timg/c9faf6ead2cd.jpg" /> 落在以 <img src="../timg/58c3d0d0ebe0.jpg" /> 為中心的「信賴區間」內，與信賴區間 重疊的機率為 <img src="../timg/21574e63086e.jpg" /> 。</p>
<h2 id="習題-4"><a href="#習題-4">習題</a></h2>
<p>習題一、以下 x 是某隨機樣本序列，請回答下列問題</p>
<pre class="sourceCode R"><code class="sourceCode r">x =<span class="st"> </span><span class="kw">c</span>(<span class="fl">46.26534</span>, <span class="fl">49.30766</span>, <span class="fl">53.79364</span>, <span class="fl">53.18000</span>, <span class="fl">48.97584</span>, <span class="fl">51.92664</span>, <span class="fl">44.58280</span>, <span class="fl">62.26655</span>, <span class="fl">54.52493</span>, <span class="fl">55.08502</span>, <span class="fl">56.78329</span>, <span class="fl">45.00972</span>, <span class="fl">46.99871</span>, <span class="fl">43.88388</span>, <span class="fl">52.63184</span>, <span class="fl">53.15600</span>, <span class="fl">48.39374</span>, <span class="fl">51.07595</span>, <span class="fl">47.36923</span>, <span class="fl">52.09186</span>, <span class="fl">46.54074</span>, <span class="fl">54.46617</span>, <span class="fl">47.87038</span>, <span class="fl">42.94228</span>, <span class="fl">48.69307</span>)</code></pre>
<ol style="list-style-type: decimal">
<li>請問母體平均值 mu 的 95% 信賴區間為何？</li>
<li>請問母體平均值 mu 的 98% 信賴區間為何？</li>
<li>請用 mu=50 檢定該平均值
<ol style="list-style-type: lower-alpha">
<li>請問該檢定的虛無假設為何？</li>
<li>請問該檢定的對立假設為何？</li>
<li>請問顯著性 p-value 是多少？</li>
<li>請問您認為 mu=50 這個虛無假設是否應該被否決？為甚麼？</li>
<li>請問您認為 mu 不等於 50 這個對立假設是否應該被接受？為甚麼？</li>
</ol></li>
</ol>
<p>習題二、請用下列方式產生樣本 x，然後回答下列問題</p>
<pre class="sourceCode R"><code class="sourceCode r">mu=<span class="kw">runif</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">10</span>)
sd1 =<span class="st"> </span><span class="kw">runif</span>(<span class="dv">1</span>, <span class="dv">1</span>,<span class="dv">2</span>)
x=<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span>mu, <span class="dt">sd=</span>sd1)
x</code></pre>
<ol style="list-style-type: decimal">
<li>請問母體平均值 mu 的 95% 信賴區間為何？</li>
<li>請問母體平均值 mu 的 98% 信賴區間為何？</li>
<li>請用 mu=5 檢定該平均值
<ol style="list-style-type: lower-alpha">
<li>請問該檢定的虛無假設為何？</li>
<li>請問該檢定的對立假設為何？</li>
<li>請問顯著性 p-value 是多少？</li>
<li>請問您認為 mu=5 這個虛無假設是否應該被否決？為甚麼？</li>
<li>請問您認為 mu ≠ 5 這個對立假設是否應該被接受？為甚麼？</li>
</ol></li>
</ol>
<h2 id="參考文獻-2"><a href="#參考文獻-2">參考文獻</a></h2>
<ul>
<li>免費電子書 -- 機率與統計 (使用 R 軟體) -- <a href="http://ccckmit.wikidot.com/st:main">http://ccckmit.wikidot.com/st:main</a></li>
<li>工程統計學：原則與應用(修訂版)(Milton 4/e), 作者：Milton, 譯者：吳榮彬, 年份：2008年 4版, ISBN：9789861574080</li>
</ul>
<h1 id="再論估計與檢定"><a href="#再論估計與檢定">再論估計與檢定</a></h1>
<p>在上一章當中，我們說明了如何計算單一組樣本「平均值」的「信賴區間」與「檢定」等問題。在這一章當中，我們將進一步探索 如何用 R 軟體進行其他的檢定，像是「變異數」的檢定，兩組樣本的檢定等問題，我們將不會花太多力氣在數學說明上，而是採用 直接操作的範例導向方法，用範例說明這些檢定的實作方法。</p>
<h2 id="檢定的分類"><a href="#檢定的分類">檢定的分類</a></h2>
<p>大致上來說，檢定可以分為「單組樣本、兩組樣本或多組樣本」的檢定，在上期當中，我們所檢定的對象是單組樣本的平均值 <span class="math"><em>μ</em></span>， 當然我們也可以檢定兩組樣本的平均值是否相等，也就是 <img src="../timg/4e60474e0f60.jpg" /> 是否為真。</p>
<p>如果想檢定的關係並非「等號」關係，那麼檢定還可以分為「右尾檢定、左尾檢定、雙尾檢定」等三種，以平均值 <img src="../timg/c9faf6ead2cd.jpg" /> 的檢定而言， 其檢定假設如下表所示：</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">右尾檢定</th>
<th align="left">左尾檢定</th>
<th align="left">雙尾檢定</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">H0</td>
<td align="left"><img src="../timg/acb57c5744a8.jpg" /></td>
<td align="left"><img src="../timg/d8c59401e540.jpg" /></td>
<td align="left"><img src="../timg/83065df9f3ee.jpg" /></td>
</tr>
<tr class="even">
<td align="left">H1</td>
<td align="left"><img src="../timg/1619b0265515.jpg" /></td>
<td align="left"><img src="../timg/8dd164dce5fe.jpg" /></td>
<td align="left"><img src="../timg/9b4f164b4cc6.jpg" /></td>
</tr>
</tbody>
</table>
<p>另外、檢定的對象如果不是平均數 <img src="../timg/c9faf6ead2cd.jpg" /> ，而是變異數 <img src="../timg/a2ab7d71a0f0.jpg" /> ，或者某個比例 p，或者是中位數 M ，那就得改用對應的分布進行檢定，讓我們將檢定的種類與方法整理一下，列表如下：</p>
<ul>
<li>單組樣本的檢定
<ul>
<li>平均值的檢定？ ( <img src="../timg/8d5c16be7d8a.jpg" /> ) -- 學生 T 檢定</li>
<li>變異數的檢定？ ( <img src="../timg/915e4f07551f.jpg" /> ) -- 卡方 <img src="../timg/9ca61f458c78.jpg" /> 檢定</li>
<li>比例 p 的檢定？ ( <img src="../timg/6e4083e02d67.jpg" /> ) -- 常態 Z 檢定</li>
<li>中位數 M 的檢定？ ( <img src="../timg/6ed558249dd0.jpg" /> ) -- 無母數方法 Wilcoxon Sign-Rank 檢定</li>
</ul></li>
<li>兩組樣本的檢定
<ul>
<li>比較兩平均數 <img src="../timg/52ba63e20126.jpg" /> 的差值 ( <img src="../timg/e18314955b8b.jpg" /> ) 的檢定</li>
<li>比較兩變異數 <img src="../timg/112884011abb.jpg" /> 的差值 ( <img src="../timg/1848b72fa807.jpg" /> ) 的檢定</li>
<li>比較兩機率 <img src="../timg/ae8fd5980cf4.jpg" /> 的差值 ( <img src="../timg/dbdccad11fb3.jpg" /> ) 的檢定</li>
<li>比較兩組中位數 M 的差值 ( <img src="../timg/a6a7779ec296.jpg" /> ) 的檢定 (無母數方法)</li>
</ul></li>
</ul>
<h2 id="右尾檢定左尾檢定與雙尾檢定"><a href="#右尾檢定左尾檢定與雙尾檢定">右尾檢定、左尾檢定與雙尾檢定</a></h2>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">2</span>)
&gt;<span class="st"> </span>x
 [<span class="dv">1</span>] <span class="fl">6.6148290</span> <span class="fl">8.4660415</span> <span class="fl">4.7084610</span> <span class="fl">8.0959357</span> <span class="fl">5.0618158</span> <span class="fl">3.6971976</span> <span class="fl">7.7887572</span>
 [<span class="dv">8</span>] <span class="fl">5.2229378</span> <span class="fl">4.7763453</span> <span class="fl">4.3595627</span> <span class="fl">4.7674163</span> <span class="fl">2.8655986</span> <span class="fl">4.5051726</span> <span class="fl">1.2974370</span>
[<span class="dv">15</span>] <span class="fl">6.9794643</span> <span class="fl">0.4042951</span> <span class="fl">8.0391053</span> <span class="fl">6.7884780</span> <span class="fl">6.5557084</span> <span class="fl">3.7146943</span> <span class="fl">0.3457576</span>
[<span class="dv">22</span>] <span class="fl">7.4302876</span> <span class="fl">6.7216046</span> <span class="fl">9.1046976</span> <span class="fl">7.0879767</span>
&gt;<span class="st"> </span><span class="kw">sd</span>(x)
[<span class="dv">1</span>] <span class="fl">2.430731</span>
&gt;<span class="st"> </span><span class="kw">mean</span>(x)
[<span class="dv">1</span>] <span class="fl">5.415983</span>
&gt;<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative=</span><span class="st">&quot;greater&quot;</span>, <span class="dt">mu=</span><span class="fl">4.8</span>)

        One Sample t-test

data:<span class="st">  </span>x 
t =<span class="st"> </span><span class="fl">1.2671</span>, df =<span class="st"> </span><span class="dv">24</span>, p-value =<span class="st"> </span><span class="fl">0.1086</span>
alternative hypothesis:<span class="st"> </span>true mean is greater than <span class="fl">4.8</span> 
<span class="dv">95</span> percent confidence interval:
<span class="st"> </span><span class="fl">4.584244</span>      <span class="ot">Inf</span> 
sample estimates:
mean of x 
 <span class="fl">5.415983</span> 

&gt;<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative=</span><span class="st">&quot;less&quot;</span>, <span class="dt">mu=</span><span class="fl">4.8</span>)

        One Sample t-test

data:<span class="st">  </span>x 
t =<span class="st"> </span><span class="fl">1.2671</span>, df =<span class="st"> </span><span class="dv">24</span>, p-value =<span class="st"> </span><span class="fl">0.8914</span>
alternative hypothesis:<span class="st"> </span>true mean is less than <span class="fl">4.8</span> 
<span class="dv">95</span> percent confidence interval:
<span class="st">     </span>-<span class="ot">Inf</span> <span class="fl">6.247722</span> 
sample estimates:
mean of x 
 <span class="fl">5.415983</span> 

&gt;<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative=</span><span class="st">&quot;two.sided&quot;</span>, <span class="dt">mu=</span><span class="fl">4.8</span>)

        One Sample t-test

data:<span class="st">  </span>x 
t =<span class="st"> </span><span class="fl">1.2671</span>, df =<span class="st"> </span><span class="dv">24</span>, p-value =<span class="st"> </span><span class="fl">0.2173</span>
alternative hypothesis:<span class="st"> </span>true mean is not equal to <span class="fl">4.8</span> 
<span class="dv">95</span> percent confidence interval:
<span class="st"> </span><span class="fl">4.412627</span> <span class="fl">6.419339</span> 
sample estimates:
mean of x 
 <span class="fl">5.415983</span> </code></pre>
<p>註：以上的 <code>t.test(x, alternative=&quot;greater&quot;, mu=4.8)</code> 為右尾檢定，其中的 <code>t = 1.2671, df = 24, p-value = 0.1086</code> 這個 輸出中，p-value=0.1086 其實就是截掉左尾 <img src="../timg/e74a7ec38d99.jpg" /> 保留右尾 <img src="../timg/f6b317724b42.jpg" /> 的結果。如下所示：</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="dv">1</span>-<span class="kw">pt</span>(<span class="fl">1.2671</span>, <span class="dt">df=</span><span class="dv">24</span>)
[<span class="dv">1</span>] <span class="fl">0.1086388</span></code></pre>
<p>而 <code>t.test(x, alternative=&quot;less&quot;, mu=4.8)</code> 為左尾檢定，其中的 <code>t = 1.2671, df = 24, p-value = 0.8914</code> 這個 輸出中，p-value=0.8914 反過來就是截掉右尾 <img src="../timg/cc9a7ac8cd7d.jpg" /> 保留左尾 <img src="../timg/55984b56e603.jpg" /> 的結果。如下所示：</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">pt</span>(<span class="fl">1.2671</span>, <span class="dt">df=</span><span class="dv">24</span>)
[<span class="dv">1</span>] <span class="fl">0.8913612</span></code></pre>
<p>而最後的 <code>t.test(x, alternative=&quot;two.sided&quot;, mu=4.8)</code> 是雙尾檢定，其中的 <code>t = 1.2671, df = 24, p-value = 0.2173</code> 這個輸出中，p-value=0.2173 其實就是截掉兩尾的結果。如下所示：</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="dv">1</span>-(<span class="kw">pt</span>(<span class="fl">1.2671</span>, <span class="dt">df=</span><span class="dv">24</span>)-<span class="kw">pt</span>(-<span class="fl">1.2671</span>, <span class="dt">df=</span><span class="dv">24</span>))
[<span class="dv">1</span>] <span class="fl">0.2172776</span>
&gt;<span class="st"> </span></code></pre>
<h2 id="比例-p-的檢定"><a href="#比例-p-的檢定">比例 p 的檢定</a></h2>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">prop.test</span>(<span class="dv">25</span>, <span class="dv">100</span>, <span class="dt">correct=</span>T, <span class="dt">p=</span><span class="fl">0.25</span>)

        <span class="dv">1</span>-sample proportions test without continuity correction

data:<span class="st">  </span><span class="dv">25</span> out of <span class="dv">100</span>, null probability <span class="fl">0.25</span> 
X-squared =<span class="st"> </span><span class="dv">0</span>, df =<span class="st"> </span><span class="dv">1</span>, p-value =<span class="st"> </span><span class="dv">1</span>
alternative hypothesis:<span class="st"> </span>true p is not equal to <span class="fl">0.25</span> 
<span class="dv">95</span> percent confidence interval:
<span class="st"> </span><span class="fl">0.1754521</span> <span class="fl">0.3430446</span> 
sample estimates:
<span class="st">   </span>p 
<span class="fl">0.25</span> 

&gt;<span class="st"> </span><span class="kw">prop.test</span>(<span class="dv">25</span>, <span class="dv">100</span>, <span class="dt">correct=</span>T, <span class="dt">p=</span><span class="fl">0.01</span>)

        <span class="dv">1</span>-sample proportions test with continuity correction

data:<span class="st">  </span><span class="dv">25</span> out of <span class="dv">100</span>, null probability <span class="fl">0.01</span> 
X-squared =<span class="st"> </span><span class="fl">557.8283</span>, df =<span class="st"> </span><span class="dv">1</span>, p-value &lt;<span class="st"> </span><span class="fl">2.2e-16</span>
alternative hypothesis:<span class="st"> </span>true p is not equal to <span class="fl">0.01</span> 
<span class="dv">95</span> percent confidence interval:
<span class="st"> </span><span class="fl">0.1711755</span> <span class="fl">0.3483841</span> 
sample estimates:
<span class="st">   </span>p 
<span class="fl">0.25</span> 

Warning message:
In <span class="kw">prop.test</span>(<span class="dv">25</span>, <span class="dv">100</span>, <span class="dt">correct =</span> T, <span class="dt">p =</span> <span class="fl">0.01</span>) :
<span class="st">  </span>Chi-squared approximation may be incorrect
&gt;<span class="st"> </span><span class="kw">prop.test</span>(<span class="dv">25</span>, <span class="dv">100</span>, <span class="dt">correct=</span>T, <span class="dt">p=</span><span class="fl">0.2</span>)

        <span class="dv">1</span>-sample proportions test with continuity correction

data:<span class="st">  </span><span class="dv">25</span> out of <span class="dv">100</span>, null probability <span class="fl">0.2</span> 
X-squared =<span class="st"> </span><span class="fl">1.2656</span>, df =<span class="st"> </span><span class="dv">1</span>, p-value =<span class="st"> </span><span class="fl">0.2606</span>
alternative hypothesis:<span class="st"> </span>true p is not equal to <span class="fl">0.2</span> 
<span class="dv">95</span> percent confidence interval:
<span class="st"> </span><span class="fl">0.1711755</span> <span class="fl">0.3483841</span> 
sample estimates:
<span class="st">   </span>p 
<span class="fl">0.25</span> </code></pre>
<h2 id="中位數-m-的檢定"><a href="#中位數-m-的檢定">中位數 M 的檢定</a></h2>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">wilcox.test</span>(x, <span class="dt">mu=</span><span class="fl">4.8</span>)

        Wilcoxon signed rank test

data:<span class="st">  </span>x 
V =<span class="st"> </span><span class="dv">207</span>, p-value =<span class="st"> </span><span class="fl">0.2411</span>
alternative hypothesis:<span class="st"> </span>true location is not equal to <span class="fl">4.8</span> </code></pre>
<h2 id="兩組樣本的平均值檢定"><a href="#兩組樣本的平均值檢定">兩組樣本的平均值檢定</a></h2>
<p>(方法一)：合併 T 檢定 (pooled T test) -- 又被稱為：「獨立 T 檢定」或「不相關 T 檢定」</p>
<ul>
<li>前提條件：兩組樣本必須互相獨立才能使用合併 T 檢定，沒有理相信 (常態分布) 兩組樣本的母體變異數不相等的情況之下，想比較 <img src="../timg/20cd69035be5.jpg" /> 時，可用「合併 T 檢定」。</li>
</ul>
<p>合併 T 檢定的數學原理，式考慮下列兩組分佈公式：</p>
<div class="figure">
<img src="../timg/853ff86b4d58.jpg" />
</div>
<div class="figure">
<img src="../timg/40087470020f.jpg" />
</div>
<p>當 <img src="../timg/9f15cdedd8d7.jpg" /> 與 <img src="../timg/a3de00c15976.jpg" /> 相互獨立時，會有下列性質：</p>
<div class="figure">
<img src="../timg/94b18634e7ab.jpg" />
</div>
<p>於是可以得到：</p>
<div class="figure">
<img src="../timg/6479496aba68.jpg" />
</div>
<p>也就是 <img src="../timg/858b18acf22f.jpg" /> 服從自由度為 <img src="../timg/3cf0ed345ff1.jpg" /> 的 T 分布。</p>
<p>其中的 S 定義如下：</p>
<div class="figure">
<img src="../timg/efd32b9d4f51.jpg" />
</div>
<p>接著讓我們來看看如何用 R 進行這類的合併 T 檢定。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x=<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="fl">3.0</span>, <span class="dt">sd=</span><span class="dv">2</span>)
&gt;<span class="st"> </span>y=<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="fl">3.2</span>, <span class="dt">sd=</span><span class="dv">2</span>)
&gt;<span class="st"> </span>x
 [<span class="dv">1</span>]  <span class="fl">5.12770813</span> -<span class="fl">0.69201841</span>  <span class="fl">3.11359532</span>  <span class="fl">1.93715093</span>  <span class="fl">7.76880172</span>  <span class="fl">3.54159714</span>
 [<span class="dv">7</span>]  <span class="fl">1.47159331</span>  <span class="fl">4.27555975</span>  <span class="fl">3.48421232</span>  <span class="fl">2.25191442</span>  <span class="fl">3.46742988</span>  <span class="fl">7.85327689</span>
[<span class="dv">13</span>]  <span class="fl">3.52493667</span>  <span class="fl">5.41072190</span>  <span class="fl">4.39668469</span>  <span class="fl">0.29868134</span> -<span class="fl">0.19521005</span>  <span class="fl">1.30992501</span>
[<span class="dv">19</span>]  <span class="fl">2.55471568</span>  <span class="fl">3.89214393</span>  <span class="fl">6.01076126</span> -<span class="fl">0.02217834</span>  <span class="fl">1.03681457</span>  <span class="fl">5.68719430</span>
[<span class="dv">25</span>]  <span class="fl">4.15852190</span>
&gt;<span class="st"> </span>y
 [<span class="dv">1</span>]  <span class="fl">4.0565581</span>  <span class="fl">3.9617962</span>  <span class="fl">6.3513376</span>  <span class="fl">4.9998217</span>  <span class="fl">4.4419258</span>  <span class="fl">6.3198375</span>
 [<span class="dv">7</span>] -<span class="fl">1.0483622</span>  <span class="fl">5.1809845</span>  <span class="fl">7.5435307</span>  <span class="fl">2.6048084</span>  <span class="fl">5.6764663</span>  <span class="fl">2.6687181</span>
[<span class="dv">13</span>]  <span class="fl">2.7981462</span> -<span class="fl">0.3564332</span>  <span class="fl">0.8637199</span>  <span class="fl">4.2032371</span>  <span class="fl">4.5879745</span>  <span class="fl">3.1428764</span>
[<span class="dv">19</span>] -<span class="fl">0.3657162</span>  <span class="fl">4.0400208</span>  <span class="fl">5.9577457</span>  <span class="fl">2.3334531</span>  <span class="fl">3.2662193</span>  <span class="fl">1.6285190</span>
[<span class="dv">25</span>]  <span class="fl">2.2731483</span>
&gt;<span class="st"> </span><span class="kw">t.test</span>(x, y, <span class="dt">var.equal=</span>T) ## (方法一)：合併 T 檢定 (pooled T test) -- 又被稱為：「獨立 T 檢定」或「不相關 T 檢定」
## 前提條件：兩組樣本必須互相獨立才能使用合併 T 檢定，沒有理相信 (常態分布) 兩組樣本的母體變異數不相等的情況之下使用

        Two Sample t-test

data:<span class="st">  </span>x and y 
t =<span class="st"> </span>-<span class="fl">0.3409</span>, df =<span class="st"> </span><span class="dv">48</span>, p-value =<span class="st"> </span><span class="fl">0.7346</span>
alternative hypothesis:<span class="st"> </span>true difference in means is not equal to <span class="dv">0</span> 
<span class="dv">95</span> percent confidence interval:
<span class="st"> </span>-<span class="fl">1.508021</span>  <span class="fl">1.070757</span> 
sample estimates:
mean of x mean of y 
 <span class="fl">3.266581</span>  <span class="fl">3.485213</span> 

&gt;<span class="st"> </span><span class="kw">t.test</span>(x,y, <span class="dt">pair=</span>T)   ## (方法二)：成對 T 檢定 (Paired T Test)
## 前提條件：(1) 2個或以上的連續變項皆呈常態分配 (normally distributed) 
##           (2) 變項與觀察值之間互相獨立 (mutually independently) 

        Paired t-test

data:<span class="st">  </span>x and y 
t =<span class="st"> </span>-<span class="fl">0.3438</span>, df =<span class="st"> </span><span class="dv">24</span>, p-value =<span class="st"> </span><span class="fl">0.734</span>
alternative hypothesis:<span class="st"> </span>true difference in means is not equal to <span class="dv">0</span> 
<span class="dv">95</span> percent confidence interval:
<span class="st"> </span>-<span class="fl">1.531134</span>  <span class="fl">1.093870</span> 
sample estimates:
mean of the differences 
              -<span class="fl">0.218632</span> </code></pre>
<h2 id="變異數服從甚麼分布"><a href="#變異數服從甚麼分布">變異數服從甚麼分布？</a></h2>
<h2 id="兩組樣本的變異數檢定"><a href="#兩組樣本的變異數檢定">兩組樣本的變異數檢定</a></h2>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">右尾檢定</th>
<th align="left">左尾檢定</th>
<th align="left">雙尾檢定</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">H0</td>
<td align="left"><img src="../timg/34c80b93a3c9.jpg" /></td>
<td align="left"><img src="../timg/34c80b93a3c9.jpg" /></td>
<td align="left"><img src="../timg/34c80b93a3c9.jpg" /></td>
</tr>
<tr class="even">
<td align="left">H1</td>
<td align="left"><img src="../timg/ab8f008e71da.jpg" /></td>
<td align="left"><img src="../timg/b072d9c94544.jpg" /></td>
<td align="left"><img src="../timg/2a34a897a281.jpg" /></td>
</tr>
</tbody>
</table>
<p>那麼、對於變異數而言應該怎麼檢定才好呢？</p>
<p>由於單一樣本群的變異數服從卡方分布，因此在兩組樣本群時，會服從以下的分布：</p>
<div class="figure">
<img src="../timg/543e880d3841.jpg" />
</div>
<p>這種由兩個卡方分布相除的分布稱為 F 分布。</p>
<p>定理：</p>
<blockquote>
<p>令 X, Y 分別是來自常態分配 <img src="../timg/75f8b8c674ce.jpg" /> 與 <img src="../timg/aee1291dc099.jpg" /> 的樣本群，<span class="math"><em>S</em><sub><em>X</em></sub><sup>2</sup></span> 與 <img src="../timg/ed7429166c2f.jpg" /> 為 X , Y 兩群樣本的變異數，若 <img src="../timg/80693bc38e92.jpg" /> ，則統計量 <img src="../timg/948cfc859f52.jpg" /> 服從自由度為 <img src="../timg/8a0d8372e483.jpg" /> 的 F 分布。</p>
</blockquote>
<p>在 R 函數中，進行「兩組樣本變異數檢定」的函數是 var.test()，該函數即是採用 F 分布去進行檢定的，以下是一個用 var.test() 進行檢定的範例。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">var.test</span>(x,y)

        F test to compare two variances

data:<span class="st">  </span>x and y 
F =<span class="st"> </span><span class="fl">1.0973</span>, num df =<span class="st"> </span><span class="dv">24</span>, denom df =<span class="st"> </span><span class="dv">24</span>, p-value =<span class="st"> </span><span class="fl">0.8219</span>
alternative hypothesis:<span class="st"> </span>true ratio of variances is not equal to <span class="dv">1</span> 
<span class="dv">95</span> percent confidence interval:
<span class="st"> </span><span class="fl">0.4835609</span> <span class="fl">2.4901548</span> 
sample estimates:
ratio of variances 
          <span class="fl">1.097334</span> </code></pre>
<h2 id="兩組樣本的比例檢定"><a href="#兩組樣本的比例檢定">兩組樣本的比例檢定</a></h2>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">右尾檢定</th>
<th align="left">左尾檢定</th>
<th align="left">雙尾檢定</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">H0</td>
<td align="left"><img src="../timg/1c8791660c5b.jpg" /></td>
<td align="left"><img src="../timg/1c8791660c5b.jpg" /></td>
<td align="left"><img src="../timg/1c8791660c5b.jpg" /></td>
</tr>
<tr class="even">
<td align="left">H1</td>
<td align="left"><img src="../timg/90fb0c8949ef.jpg" /></td>
<td align="left"><img src="../timg/34974593894f.jpg" /></td>
<td align="left"><img src="../timg/93de3b3c344d.jpg" /></td>
</tr>
</tbody>
</table>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x=<span class="kw">c</span>(<span class="dv">100</span>, <span class="dv">200</span>)
&gt;<span class="st"> </span>y=<span class="kw">c</span>(<span class="dv">300</span>, <span class="dv">400</span>)
&gt;<span class="st"> </span><span class="kw">prop.test</span>(x,y)

        <span class="dv">2</span>-sample test for equality of proportions with continuity
        correction

data:<span class="st">  </span>x out of y 
X-squared =<span class="st"> </span><span class="fl">18.7698</span>, df =<span class="st"> </span><span class="dv">1</span>, p-value =<span class="st"> </span><span class="fl">1.475e-05</span>
alternative hypothesis:<span class="st"> </span>two.sided 
<span class="dv">95</span> percent confidence interval:
<span class="st"> </span>-<span class="fl">0.24201562</span> -<span class="fl">0.09131771</span> 
sample estimates:
<span class="st">   </span>prop <span class="dv">1</span>    prop <span class="dv">2</span> 
<span class="fl">0.3333333</span> <span class="fl">0.5000000</span> </code></pre>
<h2 id="兩組樣本的中位數檢定"><a href="#兩組樣本的中位數檢定">兩組樣本的中位數檢定</a></h2>
<p>(方法一)：Wilcoxon Rank-Sum 檢定：兩組獨立觀察值 X, Y 適用</p>
<ul>
<li>統計量： <img src="../timg/1514cbaa258a.jpg" /></li>
<li>其中的： <img src="../timg/2c5ac6f5bd5d.jpg" /></li>
</ul>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="left">右尾檢定</th>
<th align="left">左尾檢定</th>
<th align="left">雙尾檢定</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">H0</td>
<td align="left"><img src="../timg/0da28b8e6c63.jpg" /></td>
<td align="left"><img src="../timg/0da28b8e6c63.jpg" /></td>
<td align="left"><img src="../timg/0da28b8e6c63.jpg" /></td>
</tr>
<tr class="even">
<td align="left">H1</td>
<td align="left"><img src="../timg/4ada02222cdb.jpg" /></td>
<td align="left"><img src="../timg/09d107aa1f45.jpg" /></td>
<td align="left"><img src="../timg/7facb5808f1d.jpg" /></td>
</tr>
</tbody>
</table>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">2</span>)
&gt;<span class="st"> </span>y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dt">mean=</span><span class="fl">5.5</span>, <span class="dt">sd=</span><span class="dv">2</span>)
&gt;<span class="st"> </span>x
 [<span class="dv">1</span>] <span class="fl">3.962665</span> <span class="fl">4.592900</span> <span class="fl">2.708658</span> <span class="fl">4.302144</span> <span class="fl">9.140617</span> <span class="fl">6.579571</span> <span class="fl">4.711547</span> <span class="fl">4.842238</span>
 [<span class="dv">9</span>] <span class="fl">5.634979</span> <span class="fl">8.826325</span> <span class="fl">7.492737</span> <span class="fl">5.349967</span> <span class="fl">6.028533</span> <span class="fl">5.326150</span> <span class="fl">3.280819</span> <span class="fl">2.589442</span>
[<span class="dv">17</span>] <span class="fl">6.391175</span> <span class="fl">3.299716</span> <span class="fl">5.681381</span> <span class="fl">3.188571</span>
&gt;<span class="st"> </span>y
 [<span class="dv">1</span>] <span class="fl">7.537479</span> <span class="fl">5.810962</span> <span class="fl">7.340678</span> <span class="fl">4.048306</span> <span class="fl">6.179672</span> <span class="fl">5.152021</span> <span class="fl">6.780724</span> <span class="fl">3.354434</span>
 [<span class="dv">9</span>] <span class="fl">6.484613</span> <span class="fl">8.752706</span> <span class="fl">4.116139</span> <span class="fl">4.939286</span> <span class="fl">4.074703</span> <span class="fl">2.954187</span> <span class="fl">4.489012</span> <span class="fl">5.697258</span>
[<span class="dv">17</span>] <span class="fl">5.260137</span> <span class="fl">6.299990</span> <span class="fl">8.188696</span> <span class="fl">5.743851</span>
&gt;<span class="st"> </span><span class="kw">wilcox.test</span>(x, y, <span class="dt">exact=</span>F, <span class="dt">correct=</span>F)

        Wilcoxon rank sum test

data:<span class="st">  </span>x and y 
W =<span class="st"> </span><span class="dv">162</span>, p-value =<span class="st"> </span><span class="fl">0.304</span>
alternative hypothesis:<span class="st"> </span>true location shift is not equal to <span class="dv">0</span> </code></pre>
<p>(方法二)：Wilcoxon Signed-Rank 檢定：兩組成對觀察值 (X, Y) 適用</p>
<ul>
<li>樣本：兩組成對觀察值 <img src="../timg/4864fdb1c6c6.jpg" /></li>
<li>方法：將差距絕對值 <img src="../timg/d4e3f9cf91e8.jpg" /> 由小到大排序，並給予 1..n 的名次。</li>
<li>檢定統計量：看看 <img src="../timg/1204e1d9099e.jpg" /> 是否夠接近 <span class="math"><em>M</em><sub><em>Y</em></sub></span>，如果差很多那麼 W 應該會很大。</li>
<li>正排名權重：<span class="math"><em>W</em><sub> + </sub> = ∑ <sub><em>R</em><sub><em>i</em></sub> &gt; 0</sub><em>R</em><sub><em>i</em></sub></span></li>
<li>負排名權重：<span class="math">∣<em>W</em><sub> − </sub>∣ = ∑ <sub><em>R</em><sub><em>i</em></sub> &lt; 0</sub>∣<em>R</em><sub><em>i</em></sub>∣; </span></li>
<li>W = min(W_+, |W_-|)</li>
</ul>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">wilcox.test</span>(x,y, <span class="dt">exact=</span>F, <span class="dt">correct=</span>F, <span class="dt">paired=</span>T)

        Wilcoxon signed rank test

data:<span class="st">  </span>x and y 
V =<span class="st"> </span><span class="dv">83</span>, p-value =<span class="st"> </span><span class="fl">0.4115</span>
alternative hypothesis:<span class="st"> </span>true location shift is not equal to <span class="dv">0</span> </code></pre>
<h2 id="結語-4"><a href="#結語-4">結語</a></h2>
<p>在本文中，我們討論了各種「單組樣本」與「兩組樣本」檢定方法，並用 R 軟體進行示範操作，希望透過這樣的方式讓 讀者感受到「檢定」這一個統計工具的用途。</p>
<p>但是、我們還漏掉了一個部分，那就是「三組以上的樣本」之檢定方法，用來檢定這些樣本是否來自同一母體，這種 「多組樣本檢定」的問題，通常必須使用「變異數分析」(ANOVA, Analysis Of Variance) 的方法處理，這將是我們 下一章所要討論的主題！</p>
<h2 id="參考文獻-3"><a href="#參考文獻-3">參考文獻</a></h2>
<ul>
<li>陳鍾誠的網站/免費電子書/R 統計軟體 -- <a href="http://ccckmit.wikidot.com/r:main">http://ccckmit.wikidot.com/r:main</a></li>
<li>陳鍾誠的網站/免費電子書/機率與統計 (使用 R 軟體) -- <a href="http://ccckmit.wikidot.com/st:main">http://ccckmit.wikidot.com/st:main</a></li>
</ul>
<h1 id="變異數分析-anova"><a href="#變異數分析-anova">變異數分析 (ANOVA)</a></h1>
<h2 id="簡介-3"><a href="#簡介-3">簡介</a></h2>
<p>在前兩章當中，我們曾經探討過「兩組樣本的平均值檢定」問題，當兩組樣本互相獨立時， 我們可以透過檢定 <img src="../timg/20cd69035be5.jpg" /> 的信賴區間，採用 T 分布去檢定 <img src="../timg/40853c87a0e1.jpg" /> 是否為真， 這種方法稱為合併 T 檢定 (pooled T test)。</p>
<p>在此、先讓我們再次透過 R 軟體，進行一次 T 檢定，以便喚起讀者的記憶。</p>
<h2 id="檢定兩樣本群的平均值是否相同"><a href="#檢定兩樣本群的平均值是否相同">檢定兩樣本群的平均值是否相同</a></h2>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">5</span>, <span class="dv">1</span>)
&gt;<span class="st"> </span>x
 [<span class="dv">1</span>] <span class="fl">6.240855</span> <span class="fl">4.229226</span> <span class="fl">5.349843</span> <span class="fl">6.023241</span> <span class="fl">5.613232</span> <span class="fl">5.300235</span> <span class="fl">4.696128</span> <span class="fl">5.452365</span>
 [<span class="dv">9</span>] <span class="fl">4.567735</span> <span class="fl">5.260747</span> <span class="fl">3.800322</span> <span class="fl">6.168725</span> <span class="fl">6.196059</span> <span class="fl">4.969572</span> <span class="fl">6.251078</span> <span class="fl">3.549983</span>
[<span class="dv">17</span>] <span class="fl">6.432844</span> <span class="fl">5.308146</span> <span class="fl">4.978811</span> <span class="fl">4.944134</span>
&gt;<span class="st"> </span>y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">5</span>, <span class="dv">1</span>)
&gt;<span class="st"> </span>y
 [<span class="dv">1</span>] <span class="fl">5.969639</span> <span class="fl">5.400434</span> <span class="fl">4.231995</span> <span class="fl">4.804537</span> <span class="fl">3.098015</span> <span class="fl">5.481365</span> <span class="fl">6.016810</span> <span class="fl">2.769489</span>
 [<span class="dv">9</span>] <span class="fl">6.687201</span> <span class="fl">4.240217</span> <span class="fl">6.602660</span> <span class="fl">4.777928</span> <span class="fl">4.825274</span> <span class="fl">4.110038</span> <span class="fl">5.651073</span> <span class="fl">5.829578</span>
[<span class="dv">17</span>] <span class="fl">4.651262</span> <span class="fl">6.036818</span> <span class="fl">3.459562</span> <span class="fl">5.993473</span>
&gt;<span class="st"> </span><span class="kw">t.test</span>(x, y, <span class="dt">var.equal=</span><span class="ot">TRUE</span>)

        Two Sample t-test

data:<span class="st">  </span>x and y
t =<span class="st"> </span><span class="fl">0.7519</span>, df =<span class="st"> </span><span class="dv">38</span>, p-value =<span class="st"> </span><span class="fl">0.4567</span>
alternative hypothesis:<span class="st"> </span>true difference in means is not equal to <span class="dv">0</span>
<span class="dv">95</span> percent confidence interval:
<span class="st"> </span>-<span class="fl">0.3973599</span>  <span class="fl">0.8669515</span>
sample estimates:
mean of x mean of y 
 <span class="fl">5.266664</span>  <span class="fl">5.031868</span> 

&gt;<span class="st"> </span>z =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">4</span>, <span class="dv">1</span>)
&gt;<span class="st"> </span><span class="kw">t.test</span>(x, z, <span class="dt">var.equal=</span><span class="ot">TRUE</span>)

        Two Sample t-test

data:<span class="st">  </span>x and z
t =<span class="st"> </span><span class="fl">5.9399</span>, df =<span class="st"> </span><span class="dv">38</span>, p-value =<span class="st"> </span><span class="fl">6.883e-07</span>
alternative hypothesis:<span class="st"> </span>true difference in means is not equal to <span class="dv">0</span>
<span class="dv">95</span> percent confidence interval:
<span class="st"> </span><span class="fl">1.079955</span> <span class="fl">2.196671</span>
sample estimates:
mean of x mean of y 
 <span class="fl">5.266664</span>  <span class="fl">3.628351</span> 

&gt;<span class="st"> </span></code></pre>
<p>在以上檢定中， x, y 兩者都是由 rnorm(20, 5, 1) 這個指令 (平均值 5，標準差為 1) 產生的樣本，所以檢定的結果 t.test(x, y, var.equal=TRUE) 之 p-value = 0.4567 ，由於該值遠大於 1-95% = 0.05，所以檢定結果無法否認虛無假設 <img src="../timg/8ece14977518.jpg" /> ，而且信賴區間為 (-0.3973599, 0.8669515) 包含 <img src="../timg/5efeebd0f700.jpg" /> ，這兩者都代表我們無法否認 H0。</p>
<p>但是、在 t.test(x, z, var.equal=TRUE) 這個檢定中，由於 z 是 rnorm(20, 4, 1) 這個指令 (平均值 4，標準差為 1) 產生的樣本，檢定的結果 p-value = 6.883e-07 也遠小於 0.05，因此強力的否決了 <img src="../timg/8ece14977518.jpg" /> 的可能性， 這點從信賴區間 (1.079955, 2.196671) 不包含 0 這件事情上，也可以清楚的看到。</p>
<h2 id="變異數分析-analysis-of-variance-anova"><a href="#變異數分析-analysis-of-variance-anova">變異數分析 (Analysis of Variance, ANOVA)</a></h2>
<p>但是、如果樣本群的數目變多了，不是兩組樣本，而是 k 組樣本的話，事情就會變得比較麻煩！</p>
<p>如果要用上述的合併 T 檢定對 <img src="../timg/0a55ffecc693.jpg" /> 中的每個配對都作檢定，那麼就要對 (1, 2), (1, 3), ... (1, k), (2, 3), (2,4), ... (2, k), .... (k-1, k) 等 <img src="../timg/a918f5a94a3f.jpg" /> 種配對都進行一次檢定，這樣的方式有點太麻煩了。</p>
<p>此時、我們可以採用變異數分析 (中國大陸稱為方差分析) 的方法，來檢定假設 H0 是否成立，也就是檢驗是否所有樣本群的平均值都相同。</p>
<p>讓我們暫時不去探討背後的數學，直接用 R 軟體進行一次變異數分析的檢定，看看這種檢定是如何進行的，以下是一個簡單的操作過程。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>X =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">40</span>, <span class="dv">5</span>, <span class="dv">1</span>) <span class="co"># 產生四十個樣本 (平均值 5，標準差 1)</span>
&gt;<span class="st"> </span>X
 [<span class="dv">1</span>] <span class="fl">5.584603</span> <span class="fl">4.052913</span> <span class="fl">4.434469</span> <span class="fl">5.844309</span> <span class="fl">5.286695</span> <span class="fl">5.188169</span> <span class="fl">4.796683</span> <span class="fl">3.913132</span>
 [<span class="dv">9</span>] <span class="fl">5.467150</span> <span class="fl">5.740397</span> <span class="fl">4.528423</span> <span class="fl">4.395270</span> <span class="fl">4.994147</span> <span class="fl">4.014513</span> <span class="fl">6.259213</span> <span class="fl">6.898331</span>
[<span class="dv">17</span>] <span class="fl">3.792135</span> <span class="fl">3.879688</span> <span class="fl">5.334643</span> <span class="fl">5.887895</span> <span class="fl">5.647250</span> <span class="fl">5.603816</span> <span class="fl">5.465186</span> <span class="fl">6.703394</span>
[<span class="dv">25</span>] <span class="fl">5.153999</span> <span class="fl">4.855386</span> <span class="fl">2.129850</span> <span class="fl">5.477026</span> <span class="fl">4.785934</span> <span class="fl">4.138114</span> <span class="fl">5.726216</span> <span class="fl">3.581281</span>
[<span class="dv">33</span>] <span class="fl">5.255695</span> <span class="fl">4.515353</span> <span class="fl">6.391714</span> <span class="fl">3.726963</span> <span class="fl">5.744328</span> <span class="fl">5.314164</span> <span class="fl">4.647955</span> <span class="fl">4.848313</span>
&gt;<span class="st"> </span>A =<span class="st"> </span><span class="kw">factor</span>(<span class="kw">rep</span>(<span class="dv">1</span>:<span class="dv">4</span>, <span class="dt">each=</span><span class="dv">10</span>)) <span class="co"># 產生標記 1, 2, 3, 4 各 10 份</span>
&gt;<span class="st"> </span>A
 [<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span>
[<span class="dv">37</span>] <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span> 
&gt;<span class="st"> </span>XA =<span class="st"> </span><span class="kw">data.frame</span>(X, A) <span class="co"># 建立框架變數 XA，為每個 X 樣本分別標上 1, 2, 3, 4 等標記。</span>
&gt;<span class="st"> </span>aov.XA =<span class="st"> </span><span class="kw">aov</span>(X~A, <span class="dt">data=</span>XA) <span class="co"># 進行「變異數分析」，看看 X 與 A 之間是否有相關。</span>
&gt;<span class="st"> </span><span class="kw">summary</span>(aov.XA) <span class="co"># 印出「變異數分析」的結果報表</span>
            Df Sum Sq Mean Sq F value <span class="kw">Pr</span>(&gt;F)
A            <span class="dv">3</span>  <span class="fl">5.015</span>  <span class="fl">1.6718</span>   <span class="fl">2.119</span>  <span class="fl">0.115</span>
Residuals   <span class="dv">36</span> <span class="fl">28.408</span>  <span class="fl">0.7891</span>               
&gt;<span class="st"> </span><span class="kw">plot</span>(XA$X~XA$A) <span class="co"># 繪出 X~A 的盒狀圖</span></code></pre>
<p>在上述操作中，我們用 X = rnorm(40, 5, 1) 產生四十個樣本，然後用 A = factor(rep(1:4, each=10)) 與 XA = data.frame(X, A) 這個指令將這四十個樣本分為四群，每群 10 個，分別標以 1, 2, 3, 4 的標記，成為 XA 這個框架 (frame) 變數，然後利用 `aov.XA = aov(X~A, data=XA)' 這個指令進行「變異數分析」，並用 summary(aov.XA) 指令印出分析結果。</p>
<p>您可以看到在分析結果中，Pr(&gt;F) = 0.115 ，並沒有低於 (1-95%) 的 0.05 範圍，因此各組的平均值間沒有明顯差異，我們無法否認 H0。</p>
<p>最後我們用 <code>plot(XA$X~XA$A)</code> 這個指令匯出盒狀圖，就可以大致看到四組分佈的情況。</p>
<div class="figure">
<img src="../img/aovXA.jpg" alt="圖、X 與 A 之間關係的盒狀圖" /><p class="caption">圖、X 與 A 之間關係的盒狀圖</p>
</div>
<p>但是、如果我們再用 rnorm(10, 4, 1) 這個指令產生一組樣本群加入上述資料 X 中，並將這組新產生的樣本群標示為編號 5 ，由於 此組新樣本群的母體平均值為 4 (而不是 5)，因此應該會有明顯不同，以下是我們的實驗操作過程。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>Y =<span class="st"> </span><span class="kw">c</span>(X, <span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dv">4</span>, <span class="dv">1</span>)) <span class="co"># 將 X 補上 10 個均值為 4 的隨機樣本，成為 Y</span>
&gt;<span class="st"> </span>Y
 [<span class="dv">1</span>] <span class="fl">5.584603</span> <span class="fl">4.052913</span> <span class="fl">4.434469</span> <span class="fl">5.844309</span> <span class="fl">5.286695</span> <span class="fl">5.188169</span> <span class="fl">4.796683</span> <span class="fl">3.913132</span>
 [<span class="dv">9</span>] <span class="fl">5.467150</span> <span class="fl">5.740397</span> <span class="fl">4.528423</span> <span class="fl">4.395270</span> <span class="fl">4.994147</span> <span class="fl">4.014513</span> <span class="fl">6.259213</span> <span class="fl">6.898331</span>
[<span class="dv">17</span>] <span class="fl">3.792135</span> <span class="fl">3.879688</span> <span class="fl">5.334643</span> <span class="fl">5.887895</span> <span class="fl">5.647250</span> <span class="fl">5.603816</span> <span class="fl">5.465186</span> <span class="fl">6.703394</span>
[<span class="dv">25</span>] <span class="fl">5.153999</span> <span class="fl">4.855386</span> <span class="fl">2.129850</span> <span class="fl">5.477026</span> <span class="fl">4.785934</span> <span class="fl">4.138114</span> <span class="fl">5.726216</span> <span class="fl">3.581281</span>
[<span class="dv">33</span>] <span class="fl">5.255695</span> <span class="fl">4.515353</span> <span class="fl">6.391714</span> <span class="fl">3.726963</span> <span class="fl">5.744328</span> <span class="fl">5.314164</span> <span class="fl">4.647955</span> <span class="fl">4.848313</span>
[<span class="dv">41</span>] <span class="fl">3.516310</span> <span class="fl">4.174873</span> <span class="fl">2.541251</span> <span class="fl">2.851404</span> <span class="fl">4.862902</span> <span class="fl">2.739729</span> <span class="fl">2.848565</span> <span class="fl">3.169462</span>
[<span class="dv">49</span>] <span class="fl">4.245488</span> <span class="fl">3.543660</span>
&gt;<span class="st"> </span>B =<span class="st"> </span><span class="kw">c</span>(A, <span class="kw">rep</span>(<span class="dv">5</span>, <span class="dv">10</span>)) <span class="co"># 產生 10 個編號 5 的標號，將 A 擴充為 B，為新的 10 個樣本標號。</span>
&gt;<span class="st"> </span>B
 [<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span>
[<span class="dv">37</span>] <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">5</span> <span class="dv">5</span> <span class="dv">5</span> <span class="dv">5</span> <span class="dv">5</span> <span class="dv">5</span> <span class="dv">5</span> <span class="dv">5</span> <span class="dv">5</span>
&gt;<span class="st"> </span>YB =<span class="st"> </span><span class="kw">data.frame</span>(Y, B) <span class="co"># 建立框架變數 YB，為 XA 補上 10 個新樣本的結果</span>
&gt;<span class="st"> </span>aov.YB =<span class="st"> </span><span class="kw">aov</span>(Y~B, <span class="dt">data=</span>YB)  <span class="co"># 進行「變異數分析」，看看 Y 與 B 之間是否有相關。</span>
&gt;<span class="st"> </span><span class="kw">summary</span>(aov.YB) <span class="co"># 印出「變異數分析」的結果報表</span>
            Df Sum Sq Mean Sq F value  <span class="kw">Pr</span>(&gt;F)   
B            <span class="dv">1</span>  <span class="fl">10.15</span>  <span class="fl">10.152</span>    <span class="fl">9.84</span> <span class="fl">0.00292</span> **
Residuals   <span class="dv">48</span>  <span class="fl">49.52</span>   <span class="fl">1.032</span>                   
---
Signif. codes:<span class="st">  </span><span class="dv">0</span> ‘**<span class="er">*</span>’ <span class="fl">0.001</span> ‘**’ <span class="fl">0.01</span> ‘*’ <span class="fl">0.05</span> ‘.’ <span class="fl">0.1</span> ‘ ’ <span class="dv">1</span>
&gt;<span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">plot</span>(YB$Y~YB$B) <span class="co"># 繪出 Y~B 的盒狀圖</span></code></pre>
<p>於是當我們用 aov.YB = aov(Y~B, data=YB) 這個指令去進行「變異數分析」時，就會發現 Pr(&gt;F) 為 0.00292，遠低於 0.05，所以我們可以否認假設 <img src="../timg/474abe12bfc3.jpg" /> ，也就是認為應該至少有一樣本群與其他樣本群的平均值有顯著的不同。</p>
<p>以下是我們用上述 <code>plot()</code> 指令所繪出的結果，您可以發現第五群樣本明顯的偏低。</p>
<div class="figure">
<img src="../img/aovYB.jpg" alt="圖、Y 與 B 之間關係的盒狀圖" /><p class="caption">圖、Y 與 B 之間關係的盒狀圖</p>
</div>
<p>這也是為何 aov(Y~B, data=YB) 的結果會認為應該否認虛無假設 H0 的原因。</p>
<p>那麼、以上變異數分析的數學原理是甚麼呢？為何一次的計算就可以檢定這麼多組的樣本的平均值是否相同呢？以下是其數學推論。</p>
<p>假如所有的樣本用 X 表示，則第一組樣本群用 <img src="../timg/0d5fa3f33533.jpg" /> 表示，第二組樣本群用 <img src="../timg/e209e24a3d42.jpg" /> 表示，....，第 k 組樣本群用 <img src="../timg/9ea3e18c1596.jpg" /> 表示。</p>
<p>那麼第一組的第一個樣本可用 <img src="../timg/da7ec511db3e.jpg" /> 表示， ... 弟 i 組的第 j 個樣本可用 <img src="../timg/b984431eec20.jpg" /> 表示。</p>
<p>如果我們用 <img src="../timg/c9faf6ead2cd.jpg" /> 代表所有 X 中樣本的平均值，<span class="math"><em>μ</em> + <em>α</em><sub><em>i</em></sub></span> 代表第 i 組樣本群的平均值，那麼我們可以寫出下列數學模型：</p>
<blockquote>
<p><img src="../timg/88b93b034ceb.jpg" /> ;</p>
<p><img src="../timg/bff2b0fb7587.jpg" /> ; 且各個 <img src="../timg/edf09c052893.jpg" /> 相互獨立。</p>
<p><img src="../timg/6c37d32d9c37.jpg" /> ;</p>
</blockquote>
<p>其中的 <img src="../timg/cd0f1069db14.jpg" /> 代表第 i 組平均與總平均的差異，而 <img src="../timg/edf09c052893.jpg" /> 則是每個樣本與組平均的差異。</p>
<p>我們想測試的是 <img src="../timg/0a55ffecc693.jpg" /> ，也可以改寫成 <img src="../timg/d8dbd110a81b.jpg" /> ， 檢定背後的數學想法是將「方差」(變異數) 分為兩部份如下：</p>
<blockquote>
<p><img src="../timg/924a4164e8bb.jpg" /> ;</p>
<p>其中</p>
<p><img src="../timg/a2ccd28677ab.jpg" /> ; 描述總差異。</p>
<p><img src="../timg/7f59fb08422e.jpg" /> ; 描述 <img src="../timg/cd0f1069db14.jpg" /> .</p>
<p><img src="../timg/f3949a42bfb1.jpg" /> ; 描述 <img src="../timg/edf09c052893.jpg" /> .</p>
</blockquote>
<p>數學上可以證明，當 H0 成立時，以下算式也會成立：</p>
<blockquote>
<p><img src="../timg/671fbbed1066.jpg" /> ;</p>
</blockquote>
<p>而且 SS_A 與 SS_E 之間有獨立性，於是得到：</p>
<blockquote>
<p><img src="../timg/91f410df24a5.jpg" /> ;</p>
</blockquote>
<p>因此就可以用 F 分布來進行變異數的檢定了，這就是「變異數分析」的數學原理。</p>
<h2 id="兩兩之間的均值比較"><a href="#兩兩之間的均值比較">兩兩之間的均值比較</a></h2>
<p>雖然在上述分析 Y~B 的過程當中，我們否認了 <img src="../timg/474abe12bfc3.jpg" /> 這個假設，但是從分析結果中卻無法得知到底哪一個樣本群有明顯的不同。</p>
<p>此時我們可以用 pairwise.t.test 這個函數，來比較兩兩間的不同，以下是我們的比較過程：</p>
<p>首先我們對 X~A 兩者之間進行兩兩比較，您可以看到下列結果。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">pairwise.t.test</span>(X, A)

        Pairwise comparisons using t tests with pooled SD 

data:<span class="st">  </span>X and A 

  <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>
<span class="dv">2</span> <span class="dv">1</span> -<span class="st"> </span>-
<span class="dv">3</span> <span class="dv">1</span> <span class="dv">1</span> -
<span class="dv">4</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span>

P value adjustment method:<span class="st"> </span>holm </code></pre>
<p>上述結果發現 (1, 2) (1,3), (1,4), (2,3), (2,4), (3,4) 之間是相同的，所以其矩陣內容值都是 1。</p>
<p>但是如果我們用 pairwise.t.test(Y, B) 指令來檢定 Y 與 B 之間的關係，那就會得到如下結果。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">pairwise.t.test</span>(Y, B)

        Pairwise comparisons using t tests with pooled SD 

data:<span class="st">  </span>Y and B 

  <span class="dv">1</span>      <span class="dv">2</span>      <span class="dv">3</span>      <span class="dv">4</span>     
<span class="dv">2</span> <span class="fl">1.0000</span> -<span class="st">      </span>-<span class="st">      </span>-<span class="st">     </span>
<span class="dv">3</span> <span class="fl">1.0000</span> <span class="fl">1.0000</span> -<span class="st">      </span>-<span class="st">     </span>
<span class="dv">4</span> <span class="fl">1.0000</span> <span class="fl">1.0000</span> <span class="fl">1.0000</span> -<span class="st">     </span>
<span class="dv">5</span> <span class="fl">0.0053</span> <span class="fl">0.0060</span> <span class="fl">0.0060</span> <span class="fl">0.0060</span>

P value adjustment method:<span class="st"> </span>holm </code></pre>
<p>從上述的結果中，您可以看到第 5 列的內容為「0.0053 0.0060 0.0060 0.0060」，明顯的較低，這代表第 5 列的平均值有顯著的不同。</p>
<p>不過、您看到的比較結果，是透過 holm 這個調整方法對顯著值 (P) 進行調整過的，如果沒有調整過，則 (X,A) 及 (Y,B) 的兩兩比較結果將會如下所示。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">pairwise.t.test</span>(X, A, <span class="dt">p.adjust.method=</span><span class="st">&quot;none&quot;</span>)

        Pairwise comparisons using t tests with pooled SD 

data:<span class="st">  </span>X and A 

  <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">3</span>   
<span class="dv">2</span> <span class="fl">0.94</span> -<span class="st">    </span>-<span class="st">   </span>
<span class="dv">3</span> <span class="fl">0.94</span> <span class="fl">1.00</span> -<span class="st">   </span>
<span class="dv">4</span> <span class="fl">0.90</span> <span class="fl">0.96</span> <span class="fl">0.96</span>

P value adjustment method:<span class="st"> </span>none 
&gt;<span class="st"> </span><span class="kw">pairwise.t.test</span>(Y, B, <span class="dt">p.adjust.method=</span><span class="st">&quot;none&quot;</span>)

        Pairwise comparisons using t tests with pooled SD 

data:<span class="st">  </span>Y and B 

  <span class="dv">1</span>       <span class="dv">2</span>       <span class="dv">3</span>       <span class="dv">4</span>      
<span class="dv">2</span> <span class="fl">0.93936</span> -<span class="st">       </span>-<span class="st">       </span>-<span class="st">      </span>
<span class="dv">3</span> <span class="fl">0.93482</span> <span class="fl">0.99545</span> -<span class="st">       </span>-<span class="st">      </span>
<span class="dv">4</span> <span class="fl">0.89612</span> <span class="fl">0.95654</span> <span class="fl">0.96108</span> -<span class="st">      </span>
<span class="dv">5</span> <span class="fl">0.00053</span> <span class="fl">0.00067</span> <span class="fl">0.00068</span> <span class="fl">0.00079</span>

P value adjustment method:<span class="st"> </span>none </code></pre>
<p>您仍然可以看到第 5 列的內容「0.00053 0.00067 0.00068 0.00079」明顯的較低，而且幾乎都低於 0.05，因此樣本群 5 的平均值明顯與其他四群有所不同。</p>
<h2 id="結語-5"><a href="#結語-5">結語</a></h2>
<p>在以上的實驗中，我們可以透過 R 軟體中的「變異數分析」函數 aov() 進行多組樣本的平均值比較，瞭解這些樣本的母體平均值是否相同。</p>
<p>假如「變異數分析」的結果認為有所不同，那麼我們就可以利用 pairwise.t.test() 函數，去檢驗看看到底哪些群體之間有所不同，以便找出明顯不同的樣本群。</p>
<p>這種方法在很多「自然科學與社會科學」的實驗當中，都會是很有用的，例如我們可以用「變異數分析」來檢驗「幾種銷售方式之間」是否有明顯的差異，「幾種農藥的除草效果」間是否有明顯差異等等，這些分析對我們進行多組樣本的統計實驗可以提供很好的指引效果。</p>
<h2 id="參考文獻-4"><a href="#參考文獻-4">參考文獻</a></h2>
<ul>
<li><a href="http://book.douban.com/subject/3337668/">R语言与统计分析</a>, 作者: 汤银才, ISBN: 9787040250626。</li>
</ul>
<h1 id="迴歸分析"><a href="#迴歸分析">迴歸分析</a></h1>
<h2 id="簡介-4"><a href="#簡介-4">簡介</a></h2>
<p>在「點估計」與「區間估計」當中，被估計的對象是一個點的座落點或區域。但是、如果我們想要找尋的是， 兩個以上變數之間的「運算式」關係，那麼就不能只用「估計」了，而必須採用「迴歸分析」的方法。</p>
<p>迴歸分析是在尋找這些變數之間的關係，通常是尋找「線性關係」，舉例而言，假如我們認為 y 與 x 之間具有線性關係，也就是 y 是 x 的線性函數，那麼我們可以將兩者之間的關係寫成 y= a + b * x ，其中 a 與 b 都是某個未知的常數。</p>
<p>當我們取得了很多組 (x,y) 的樣本 (x1, y1) (x2, y2) ..... (xk, yk) 時，我們就可以透過迴歸分析來尋找出這些未知的常數， 進而建立變數之間的線性方程關係式。</p>
<h2 id="r-軟體中的-lm-函數"><a href="#r-軟體中的-lm-函數">R 軟體中的 lm() 函數</a></h2>
<p>在 R 軟體當中，用來做迴歸分析的是 lm() 函數，其函數原型如下：</p>
<ul>
<li>lm(formula, data, subset, weights, na.action, method = &quot;qr&quot;, model = TRUE, x = FALSE, y = FALSE, qr = TRUE, singular.ok = TRUE, contrasts = NULL, offset, ...)</li>
</ul>
<p>通常，我們只要用到 formula 與 data 兩個參數就可以進行迴歸運算了，舉例而言，假如我們有 25 個樣本 xy = (x1, y1) (x2, y2) .... (x25, y25)，那麼我們就 可以用下列 lm 函數找出 x, y 之間的線性關係式。</p>
<ul>
<li>lm(y~x, xy)</li>
</ul>
<p>當然、如果自變數不只一個，例如我們想尋找的是 y = a + b1 * x1 + b2 * x2 的話，那麼就可以用下列函數去計算出 a, b1, b2 等係數，以建立迴歸模型。</p>
<ul>
<li>lm(y~x1+x2, xy)</li>
</ul>
<h2 id="單一自變數的迴歸分析完全線性無誤差值"><a href="#單一自變數的迴歸分析完全線性無誤差值">單一自變數的迴歸分析：完全線性，無誤差值</a></h2>
<p>現在、就讓我們用 R 軟體來示範「迴歸分析」的做法，</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dv">25</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>) <span class="co"># 從 1 到 10 之中可重複的隨機抽出 25 個樣本</span>
&gt;<span class="st"> </span>x
 [<span class="dv">1</span>]  <span class="dv">7</span>  <span class="dv">1</span>  <span class="dv">9</span>  <span class="dv">4</span>  <span class="dv">1</span>  <span class="dv">2</span> <span class="dv">10</span>  <span class="dv">6</span>  <span class="dv">3</span>  <span class="dv">3</span> <span class="dv">10</span>  <span class="dv">9</span>  <span class="dv">5</span>  <span class="dv">9</span>  <span class="dv">5</span> <span class="dv">10</span>  <span class="dv">2</span>  <span class="dv">1</span>  <span class="dv">8</span>  <span class="dv">4</span>  <span class="dv">8</span>  <span class="dv">7</span>  <span class="dv">4</span>  <span class="dv">6</span>
[<span class="dv">25</span>]  <span class="dv">9</span>
&gt;<span class="st"> </span>y =<span class="st"> </span><span class="dv">1+3</span>*x　 <span class="co"># 用這些 x 樣本透過線性關係式產生 y 樣本，這是完美的線性關係，完全沒有誤差。</span>
&gt;<span class="st"> </span>y
 [<span class="dv">1</span>] <span class="dv">22</span>  <span class="dv">4</span> <span class="dv">28</span> <span class="dv">13</span>  <span class="dv">4</span>  <span class="dv">7</span> <span class="dv">31</span> <span class="dv">19</span> <span class="dv">10</span> <span class="dv">10</span> <span class="dv">31</span> <span class="dv">28</span> <span class="dv">16</span> <span class="dv">28</span> <span class="dv">16</span> <span class="dv">31</span>  <span class="dv">7</span>  <span class="dv">4</span> <span class="dv">25</span> <span class="dv">13</span> <span class="dv">25</span> <span class="dv">22</span> <span class="dv">13</span> <span class="dv">19</span>
[<span class="dv">25</span>] <span class="dv">28</span>
&gt;<span class="st"> </span><span class="kw">plot</span>(x,y)　<span class="co"># 畫出 (x,y) 的圖形，您會發現所有點都分布在一條斜率為 3 的斜線上</span></code></pre>
<div class="figure">
<img src="../img/regression1.jpg" alt="圖、y=1+3*x 的完全線性 plot(x,y) 圖形結果" /><p class="caption">圖、y=1+3*x 的完全線性 plot(x,y) 圖形結果</p>
</div>
<pre><code>&gt; xy = data.frame(x, y)　# 讓 (x,y) 的配對形成 frame 變數，這樣才能做為 lm(formula, data) 中的 data 參數。
&gt; xy
    x  y
1   7 22
2   1  4
3   9 28
4   4 13
5   1  4
6   2  7
7  10 31
8   6 19
9   3 10
10  3 10
11 10 31
12  9 28
13  5 16
14  9 28
15  5 16
16 10 31
17  2  7
18  1  4
19  8 25
20  4 13
21  8 25
22  7 22
23  4 13
24  6 19
25  9 28
&gt; model = lm(y~x, data=xy) # 開始作線性迴歸分析
&gt; model

Call:
lm(formula = y ~ x, data = xy)

Coefficients:
(Intercept)            x  
          1            3  </code></pre>
<p>上述的線性回歸函數 lm，果真找到的原來的關係式，也就是「截距 =1、x 係數 =3 」的 「y=1+3*x」的算式，完整的還原了 y 與 x 之間的關係。</p>
<h2 id="單一自變數的迴歸分析有誤差值"><a href="#單一自變數的迴歸分析有誤差值">單一自變數的迴歸分析：有誤差值</a></h2>
<p>上述的範例雖然很完美，但是卻很不真實，因為在機率統計的世界中，通常有很多難以捕捉的「隨機性誤差」，反應在樣本上面。</p>
<p>現在、就讓我們再度進行一次迴歸分析，只不過這次我們將加入一些常態分布的誤差值進去。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dv">25</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>)  <span class="co"># 從 1 到 10 之中可重複的隨機抽出 25 個樣本</span>
&gt;<span class="st"> </span>x
 [<span class="dv">1</span>] <span class="dv">10</span>  <span class="dv">1</span>  <span class="dv">9</span>  <span class="dv">9</span>  <span class="dv">4</span>  <span class="dv">3</span>  <span class="dv">5</span>  <span class="dv">6</span>  <span class="dv">4</span>  <span class="dv">5</span>  <span class="dv">9</span>  <span class="dv">4</span>  <span class="dv">6</span>  <span class="dv">8</span>  <span class="dv">8</span>  <span class="dv">1</span>  <span class="dv">8</span>  <span class="dv">3</span>  <span class="dv">5</span>  <span class="dv">4</span>  <span class="dv">8</span>  <span class="dv">2</span>  <span class="dv">5</span>  <span class="dv">4</span>
[<span class="dv">25</span>]  <span class="dv">3</span>
&gt;<span class="st"> </span>y =<span class="st"> </span><span class="dv">1</span> +<span class="st"> </span><span class="dv">3</span>*x +<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">1</span>) <span class="co"># 用這些 x 樣本透過線性關係式產生 y 樣本，其中的誤差是用 rnorm() 產生的。</span>
&gt;<span class="st"> </span>y
 [<span class="dv">1</span>] <span class="fl">32.084945</span>  <span class="fl">2.594432</span> <span class="fl">26.981934</span> <span class="fl">29.395315</span> <span class="fl">11.737131</span> <span class="fl">11.347425</span> <span class="fl">14.292503</span>
 [<span class="dv">8</span>] <span class="fl">18.543848</span> <span class="fl">12.025822</span> <span class="fl">15.848780</span> <span class="fl">27.211809</span> <span class="fl">13.063985</span> <span class="fl">19.708064</span> <span class="fl">24.161863</span>
[<span class="dv">15</span>] <span class="fl">25.271777</span>  <span class="fl">4.317383</span> <span class="fl">25.694476</span>  <span class="fl">9.167196</span> <span class="fl">15.871665</span> <span class="fl">14.244046</span> <span class="fl">24.165393</span>
[<span class="dv">22</span>]  <span class="fl">5.994046</span> <span class="fl">16.639490</span> <span class="fl">12.682938</span> <span class="fl">10.978489</span>
&gt;<span class="st"> </span><span class="kw">plot</span>(x,y)</code></pre>
<div class="figure">
<img src="../img/regression2.jpg" alt="圖、y = 1 + 3*x + rnorm(25, mean=0, sd=1) 的有誤差 plot(x,y) 圖形結果" /><p class="caption">圖、y = 1 + 3*x + rnorm(25, mean=0, sd=1) 的有誤差 plot(x,y) 圖形結果</p>
</div>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>xy =<span class="st"> </span><span class="kw">data.frame</span>(x,y)　<span class="co"># 讓 (x,y) 的配對形成 frame 變數，這樣才能做為 lm(formula, data) 中的 data 參數。</span>
&gt;<span class="st"> </span>xy
    x         y
<span class="dv">1</span>  <span class="dv">10</span> <span class="fl">32.084945</span>
<span class="dv">2</span>   <span class="dv">1</span>  <span class="fl">2.594432</span>
<span class="dv">3</span>   <span class="dv">9</span> <span class="fl">26.981934</span>
<span class="dv">4</span>   <span class="dv">9</span> <span class="fl">29.395315</span>
<span class="dv">5</span>   <span class="dv">4</span> <span class="fl">11.737131</span>
<span class="dv">6</span>   <span class="dv">3</span> <span class="fl">11.347425</span>
<span class="dv">7</span>   <span class="dv">5</span> <span class="fl">14.292503</span>
<span class="dv">8</span>   <span class="dv">6</span> <span class="fl">18.543848</span>
<span class="dv">9</span>   <span class="dv">4</span> <span class="fl">12.025822</span>
<span class="dv">10</span>  <span class="dv">5</span> <span class="fl">15.848780</span>
<span class="dv">11</span>  <span class="dv">9</span> <span class="fl">27.211809</span>
<span class="dv">12</span>  <span class="dv">4</span> <span class="fl">13.063985</span>
<span class="dv">13</span>  <span class="dv">6</span> <span class="fl">19.708064</span>
<span class="dv">14</span>  <span class="dv">8</span> <span class="fl">24.161863</span>
<span class="dv">15</span>  <span class="dv">8</span> <span class="fl">25.271777</span>
<span class="dv">16</span>  <span class="dv">1</span>  <span class="fl">4.317383</span>
<span class="dv">17</span>  <span class="dv">8</span> <span class="fl">25.694476</span>
<span class="dv">18</span>  <span class="dv">3</span>  <span class="fl">9.167196</span>
<span class="dv">19</span>  <span class="dv">5</span> <span class="fl">15.871665</span>
<span class="dv">20</span>  <span class="dv">4</span> <span class="fl">14.244046</span>
<span class="dv">21</span>  <span class="dv">8</span> <span class="fl">24.165393</span>
<span class="dv">22</span>  <span class="dv">2</span>  <span class="fl">5.994046</span>
<span class="dv">23</span>  <span class="dv">5</span> <span class="fl">16.639490</span>
<span class="dv">24</span>  <span class="dv">4</span> <span class="fl">12.682938</span>
<span class="dv">25</span>  <span class="dv">3</span> <span class="fl">10.978489</span>
&gt;<span class="st"> </span>model2 =<span class="st"> </span><span class="kw">lm</span>(y~x, xy, <span class="dt">x=</span>T) <span class="co"># 開始作線性迴歸分析</span>
&gt;<span class="st"> </span>model2 <span class="co"># 顯示分析結果，發現 截距 intercept 為　0.5345, 且 x 的係數為 3.1447，也就是 y=0.5345+3.1447*x，這與原產生式「y = 1 + 3*x + 誤差」有些差異，但還不錯。</span>

Call:
<span class="kw">lm</span>(<span class="dt">formula =</span> y ~<span class="st"> </span>x, <span class="dt">data =</span> xy, <span class="dt">x =</span> T)

Coefficients:
(Intercept)            x  
     <span class="fl">0.5345</span>       <span class="fl">3.1447</span>  

&gt;<span class="st"> </span>model2$x
   (Intercept)  x
<span class="dv">1</span>            <span class="dv">1</span>  <span class="dv">5</span>
<span class="dv">2</span>            <span class="dv">1</span>  <span class="dv">7</span>
<span class="dv">3</span>            <span class="dv">1</span>  <span class="dv">8</span>
<span class="dv">4</span>            <span class="dv">1</span>  <span class="dv">4</span>
<span class="dv">5</span>            <span class="dv">1</span>  <span class="dv">3</span>
<span class="dv">6</span>            <span class="dv">1</span>  <span class="dv">2</span>
<span class="dv">7</span>            <span class="dv">1</span>  <span class="dv">3</span>
<span class="dv">8</span>            <span class="dv">1</span>  <span class="dv">4</span>
<span class="dv">9</span>            <span class="dv">1</span>  <span class="dv">5</span>
<span class="dv">10</span>           <span class="dv">1</span>  <span class="dv">4</span>
<span class="dv">11</span>           <span class="dv">1</span>  <span class="dv">7</span>
<span class="dv">12</span>           <span class="dv">1</span>  <span class="dv">7</span>
<span class="dv">13</span>           <span class="dv">1</span>  <span class="dv">2</span>
<span class="dv">14</span>           <span class="dv">1</span>  <span class="dv">4</span>
<span class="dv">15</span>           <span class="dv">1</span>  <span class="dv">2</span>
<span class="dv">16</span>           <span class="dv">1</span> <span class="dv">10</span>
<span class="dv">17</span>           <span class="dv">1</span>  <span class="dv">7</span>
<span class="dv">18</span>           <span class="dv">1</span>  <span class="dv">3</span>
<span class="dv">19</span>           <span class="dv">1</span>  <span class="dv">3</span>
<span class="dv">20</span>           <span class="dv">1</span>  <span class="dv">2</span>
<span class="dv">21</span>           <span class="dv">1</span>  <span class="dv">7</span>
<span class="dv">22</span>           <span class="dv">1</span>  <span class="dv">5</span>
<span class="dv">23</span>           <span class="dv">1</span> <span class="dv">10</span>
<span class="dv">24</span>           <span class="dv">1</span>  <span class="dv">7</span>
<span class="dv">25</span>           <span class="dv">1</span> <span class="dv">10</span>
<span class="kw">attr</span>(,<span class="st">&quot;assign&quot;</span>)
[<span class="dv">1</span>] <span class="dv">0</span> <span class="dv">1</span>
&gt;<span class="st"> </span></code></pre>
<h2 id="數學原理"><a href="#數學原理">數學原理</a></h2>
<p>那麼、這種迴歸分析到底是根據甚麼原理所設計出來的呢？讓我們從數學的角度看一下這個問題。</p>
<p>對於一組 (X,Y) 樣本而言，假如有 n 個樣本，則可以表示為 <img src="../timg/ba3b7f04270e.jpg" /> ， 如果我們想找出一組線性方程式描述 X, Y 之間的關係，那麼可以寫成如下公式：</p>
<p><img src="../timg/7944792516e7.jpg" /> ; 其中 i=1,2,....,n, 且 <img src="../timg/fdd4dcebc756.jpg" /></p>
<p>接著我們就必須從 (X,Y) 這組資料樣本中，進行 <img src="../timg/c6eb548bf732.jpg" /> 的估計，以便讓該線性函數能盡可能的逼近這些樣本。</p>
<p>我們可以採用「最小二乘法」來進行估計，也就是找出讓下方程式得到最小值的 <img src="../timg/c6eb548bf732.jpg" /> ：</p>
<div class="figure">
<img src="../timg/66b19b250e43.jpg" />
</div>
<p>要找上述方程式的最小值，我們可以對 <img src="../timg/c6eb548bf732.jpg" /> 分別進行微分，最小值會出現在導數為零的地方，推論如下：</p>
<div class="figure">
<img src="../timg/bff1e4058022.jpg" />
</div>
<div class="figure">
<img src="../timg/ae586991e720.jpg" />
</div>
<p>但必須注意的是，不管對於哪種 (X,Y) 樣本，最小二乘法都會找出迴歸線，但是如果 (X, Y) 兩者之間根本沒有線性關係， 此時找出線性迴歸也就沒有甚麼意義了。</p>
<p>那麼我們怎麼知道兩者之間有沒有線性關係呢？這可以採用下列檢定方法。</p>
<ol style="list-style-type: decimal">
<li>t 檢驗法</li>
<li>F 檢驗法</li>
<li>相關係數檢驗法。</li>
</ol>
<h2 id="兩組自變數的迴歸分析完全線性無誤差值"><a href="#兩組自變數的迴歸分析完全線性無誤差值">兩組自變數的迴歸分析：完全線性，無誤差值</a></h2>
<p>當然、我們不只可以做單一自變數的迴歸，也可以做多組自變數的迴歸，以下讓我們用 R 軟體來示範 <code>y=a + b1 * x1 + b2 * x2</code> 迴歸式的分析。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x1 =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dv">25</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>) <span class="co"># 產生第一個自變數的 25 個樣本值</span>
&gt;<span class="st"> </span>x2 =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">8</span>, <span class="dv">25</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>) <span class="co"># 產生第二個自變數的 25 個樣本值</span>
&gt;<span class="st"> </span>y =<span class="st"> </span><span class="dv">5</span> +<span class="st"> </span><span class="dv">3</span> *<span class="st"> </span>x1 -<span class="st"> </span><span class="dv">2</span> *<span class="st"> </span>x2 <span class="co"># 用這些 (x1, x2) 樣本透過線性關係式產生 y 樣本，這是完美的線性關係，完全沒有誤差。</span>
&gt;<span class="st"> </span>x1
 [<span class="dv">1</span>]  <span class="dv">8</span>  <span class="dv">8</span>  <span class="dv">8</span>  <span class="dv">2</span>  <span class="dv">6</span>  <span class="dv">3</span>  <span class="dv">4</span>  <span class="dv">1</span>  <span class="dv">5</span>  <span class="dv">4</span>  <span class="dv">2</span>  <span class="dv">1</span>  <span class="dv">6</span>  <span class="dv">4</span>  <span class="dv">2</span>  <span class="dv">4</span>  <span class="dv">1</span>  <span class="dv">5</span>  <span class="dv">7</span>  <span class="dv">2</span>  <span class="dv">9</span>  <span class="dv">2</span> <span class="dv">10</span>  <span class="dv">4</span>
[<span class="dv">25</span>]  <span class="dv">5</span>
&gt;<span class="st"> </span>x2
 [<span class="dv">1</span>] <span class="dv">7</span> <span class="dv">7</span> <span class="dv">1</span> <span class="dv">8</span> <span class="dv">5</span> <span class="dv">5</span> <span class="dv">5</span> <span class="dv">2</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">4</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">8</span> <span class="dv">2</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">2</span> <span class="dv">7</span> <span class="dv">6</span> <span class="dv">5</span>
&gt;<span class="st"> </span>y
 [<span class="dv">1</span>] <span class="dv">15</span> <span class="dv">15</span> <span class="dv">27</span> -<span class="dv">5</span> <span class="dv">13</span>  <span class="dv">4</span>  <span class="dv">7</span>  <span class="dv">4</span>  <span class="dv">8</span>  <span class="dv">1</span>  <span class="dv">1</span> -<span class="dv">6</span> <span class="dv">15</span>  <span class="dv">5</span> -<span class="dv">5</span>  <span class="dv">7</span> -<span class="dv">4</span>  <span class="dv">4</span> <span class="dv">22</span>  <span class="dv">1</span> <span class="dv">18</span>  <span class="dv">7</span> <span class="dv">21</span>  <span class="dv">5</span>
[<span class="dv">25</span>] <span class="dv">10</span>
&gt;<span class="st"> </span>yx12 =<span class="st"> </span><span class="kw">data.frame</span>(y, x1, x2)　<span class="co"># 讓 (y, x1, x2) 的配對形成 frame 變數，這樣才能做為 lm(formula, data) 中的 data 參數。</span>
&gt;<span class="st"> </span>yx12.model =<span class="st"> </span><span class="kw">lm</span>(y~x1+x2, yx12) <span class="co"># 開始作線性迴歸分析</span>
&gt;<span class="st"> </span>yx12.model <span class="co"># 顯示分析結果，發現 截距 intercept 為　5, 且 x1 的係數為 3，x2 的係數為 -2 也就是 y=5+3*x1-2*x2，正確找出我們產生資料用的算式。</span>

Call:
<span class="kw">lm</span>(<span class="dt">formula =</span> y ~<span class="st"> </span>x1 +<span class="st"> </span>x2, <span class="dt">data =</span> yx12)

Coefficients:
(Intercept)           x1           x2  
          <span class="dv">5</span>            <span class="dv">3</span>           -<span class="dv">2</span>  

&gt;<span class="st"> </span></code></pre>
<h2 id="兩組自變數的迴歸分析有誤差值"><a href="#兩組自變數的迴歸分析有誤差值">兩組自變數的迴歸分析：有誤差值</a></h2>
<p>同樣的，對於兩組或多組自變數的情況，我們也可以加入「隨機誤差值」，來讓整個資料集更有真實感，以下是我們的「資料產生」與「迴歸分析」的過程。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x1 =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">10</span>, <span class="dv">25</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>) <span class="co"># 產生第一個自變數的 25 個樣本值</span>
&gt;<span class="st"> </span>x2 =<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span>:<span class="dv">8</span>, <span class="dv">25</span>, <span class="dt">replace=</span><span class="ot">TRUE</span>) <span class="co"># 產生第二個自變數的 25 個樣本值</span>
&gt;<span class="st"> </span>y2 =<span class="st"> </span><span class="dv">5</span> +<span class="st"> </span><span class="dv">3</span>*x1<span class="dv">-2</span>*x2 +<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">5</span>)
&gt;<span class="st"> </span>y2x12 =<span class="st"> </span><span class="kw">data.frame</span>(y2, x1, x2)　<span class="co"># 讓 (y, x1, x2) 的配對形成 frame 變數，這樣才能做為 lm(formula, data) 中的 data 參數。</span>
&gt;<span class="st"> </span>y2x12
           y2 x1 x2
<span class="dv">1</span>  <span class="fl">10.2069412</span>  <span class="dv">8</span>  <span class="dv">7</span>
<span class="dv">2</span>  <span class="fl">11.5760467</span>  <span class="dv">8</span>  <span class="dv">7</span>
<span class="dv">3</span>  <span class="fl">24.8724883</span>  <span class="dv">8</span>  <span class="dv">1</span>
<span class="dv">4</span>  -<span class="fl">3.4406110</span>  <span class="dv">2</span>  <span class="dv">8</span>
<span class="dv">5</span>   <span class="fl">9.0650415</span>  <span class="dv">6</span>  <span class="dv">5</span>
<span class="dv">6</span>   <span class="fl">8.2621227</span>  <span class="dv">3</span>  <span class="dv">5</span>
<span class="dv">7</span>  <span class="fl">18.7755635</span>  <span class="dv">4</span>  <span class="dv">5</span>
<span class="dv">8</span>  -<span class="fl">5.1753518</span>  <span class="dv">1</span>  <span class="dv">2</span>
<span class="dv">9</span>  <span class="fl">14.1795708</span>  <span class="dv">5</span>  <span class="dv">6</span>
<span class="dv">10</span> -<span class="fl">2.9588236</span>  <span class="dv">4</span>  <span class="dv">8</span>
<span class="dv">11</span>  <span class="fl">4.4931402</span>  <span class="dv">2</span>  <span class="dv">5</span>
<span class="dv">12</span> -<span class="fl">9.1706740</span>  <span class="dv">1</span>  <span class="dv">7</span>
<span class="dv">13</span> <span class="fl">15.7826413</span>  <span class="dv">6</span>  <span class="dv">4</span>
<span class="dv">14</span> <span class="fl">11.1684672</span>  <span class="dv">4</span>  <span class="dv">6</span>
<span class="dv">15</span> -<span class="fl">4.2108325</span>  <span class="dv">2</span>  <span class="dv">8</span>
<span class="dv">16</span> <span class="fl">14.0557877</span>  <span class="dv">4</span>  <span class="dv">5</span>
<span class="dv">17</span>  <span class="fl">2.9787818</span>  <span class="dv">1</span>  <span class="dv">6</span>
<span class="dv">18</span>  <span class="fl">0.2277253</span>  <span class="dv">5</span>  <span class="dv">8</span>
<span class="dv">19</span> <span class="fl">31.3466157</span>  <span class="dv">7</span>  <span class="dv">2</span>
<span class="dv">20</span> <span class="fl">11.2311146</span>  <span class="dv">2</span>  <span class="dv">5</span>
<span class="dv">21</span> <span class="fl">17.9397316</span>  <span class="dv">9</span>  <span class="dv">7</span>
<span class="dv">22</span>  <span class="fl">6.1773147</span>  <span class="dv">2</span>  <span class="dv">2</span>
<span class="dv">23</span> <span class="fl">17.5177323</span> <span class="dv">10</span>  <span class="dv">7</span>
<span class="dv">24</span>  <span class="fl">1.1189083</span>  <span class="dv">4</span>  <span class="dv">6</span>
<span class="dv">25</span> <span class="fl">15.5696626</span>  <span class="dv">5</span>  <span class="dv">5</span>
&gt;<span class="st"> </span>y2x12.model =<span class="st"> </span><span class="kw">lm</span>(y~<span class="st"> </span>x1+x2, y2x12) <span class="co"># 開始作線性迴歸分析</span>
&gt;<span class="st"> </span>y2x12.model <span class="co"># 顯示分析結果，發現 截距 intercept 為　5.315, 且 x1 的係數為 2.886，x2 的係數為 -1.997，也就是 y=5.315+2.886*x1-1.997x2，這與原產生式 「y = 5 + 3*x1-2*x2+誤差」有些差異，但還不錯。</span>

Call:
<span class="kw">lm</span>(<span class="dt">formula =</span> y ~<span class="st"> </span>x1 +<span class="st"> </span>x2, <span class="dt">data =</span> y2x12)

Coefficients:
(Intercept)           x1           x2  
      <span class="fl">5.315</span>        <span class="fl">2.886</span>       -<span class="fl">1.997</span>  

&gt;<span class="st"> </span></code></pre>
<h2 id="結語-6"><a href="#結語-6">結語</a></h2>
<p>透過上述的實驗，我們可以發現在沒有誤差的情況下，線性迴歸函數 lm() 都可以找出正確的模型，得到正確的「截距」與「係數值」， 而在有隨機誤差的情況下，線性迴歸函數 lm() 雖然沒有辦法完全環原正確的模型，但是也找到還算不錯的結果，這正是「迴歸分析」 這個工具的威力之所在阿！</p>
<h2 id="參考文獻-5"><a href="#參考文獻-5">參考文獻</a></h2>
<ul>
<li><a href="https://dl.dropboxusercontent.com/u/101584453/pmag/201306/htm/article3.html">R 統計軟體(4) – 平均值的估計與檢定</a></li>
<li><a href="http://programmermagazine.github.io/201307/htm/article3.html">R 統計軟體(5) – 再探檢定</a></li>
<li>陳鍾誠的網站/免費電子書/R 統計軟體 -- <a href="http://ccckmit.wikidot.com/r:main">http://ccckmit.wikidot.com/r:main</a></li>
<li>陳鍾誠的網站/免費電子書/機率與統計 (使用 R 軟體) -- <a href="http://ccckmit.wikidot.com/st:main">http://ccckmit.wikidot.com/st:main</a></li>
</ul>
<h1 id="主成分分析與因子分析"><a href="#主成分分析與因子分析">主成分分析與因子分析</a></h1>
<h2 id="簡介-5"><a href="#簡介-5">簡介</a></h2>
<p>雖然「主成分分析」(Principle Component Analysis) 通常出現在機率統計的課本當中，但事實上要理解這個技術 的核心數學知識，卻是線性代數。</p>
<p>學過線性代數的朋友們通常會知道一個很重要但卻又難以理解的抽象概念，那就是「特徵值」與「特徵向量」， 其數學算式如下：</p>
<p>　 <img src="../timg/0010fa7e4e1c.jpg" /></p>
<p>符合這種條件的的 <img src="../timg/c6a6eb61fd9c.jpg" /> 就稱為特徵值，而 <img src="../timg/259132779c57.jpg" /> 則稱為特徵向量。</p>
<p>表面上來看，所謂的特徵向量 <img src="../timg/259132779c57.jpg" /> 就是矩陣 [A] 乘法運算上的一個方向不動點，乘完之後只會在該向量上進行常數倍的縮放，但方向不變。</p>
<p>不過、一個 n*n 矩陣的「特徵值」與「特徵向量」不止有一個，最大可以到達 n 個，假如共有 k 個特徵值，那我們可以列出下列運算式。</p>
<p>　 <img src="../timg/9b7f5816221d.jpg" /><br />　 <img src="../timg/9a70096eafac.jpg" /><br />　 ...<br />　 <img src="../timg/e086b0976a2b.jpg" /></p>
<p>基本上、特徵值 <img src="../timg/5614371f803f.jpg" /> 越大的，代表該特徵向量越能用來描述整個矩陣 (或者說越能代表該矩陣)，所以如果我們只用特徵值最大的幾個 代表整個矩陣，將特徵值小的去除，基本上不會對整個矩陣造成太大的失真。</p>
<p>或許這樣講也不太精確，不過如果您還記得線性代數裏的 Rank 這個慨念，假如一個 3*3 矩陣的 rank 只有 2，那麼就代表三行當中，有一行可以用 其他兩行的線性組合取代，也就是 <img src="../timg/34a578b55cf6.jpg" /> 。</p>
<p>在這種情況下，該矩陣只會有兩個不為零的特徵值 (也就是有一個特徵值為 0)，因此我們可以用兩組特徵值與特徵向量，就重建出整個矩陣。</p>
<p>而所謂的主成分，就是那些對重建矩陣有強大影響力，特徵值較大的那些向量。而那些特徵值很小的，基本上就可以被忽略了。</p>
<h2 id="主成分分析範例-1-rank2"><a href="#主成分分析範例-1-rank2">主成分分析範例 1 (Rank=2)</a></h2>
<p>為了展示上述的數學論點，我們用 R 軟體建構出 4 組樣本，每組有 25 個元素，其中第 3, 4 組是第 1, 2 組的線性組合，因此這個 4*25 矩陣的 rank 將只有 2，所以透過主成分分析，我們應該會看到只有兩個主成分。</p>
<p>以下是我們的範例程式。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x1=<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">1</span>) <span class="co"># x1 是常態分布隨機產生的 25 個樣本</span>
&gt;<span class="st"> </span>x2=<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">1</span>) <span class="co"># x2 是常態分布隨機產生的 25 個樣本</span>
&gt;<span class="st"> </span>x3=x1+x2                   <span class="co"># x3=x1+x2, 是 x1, x2 的線性組合</span>
&gt;<span class="st"> </span>x4=x1<span class="dv">+2</span>*x3                 <span class="co"># x4=x1+2*x3=x1+2*(x1+x2)=3x1+2x2, 因此也是 x1, x2 的線性組合。</span>
&gt;<span class="st"> </span>x14 =<span class="st"> </span><span class="kw">data.frame</span>(x1, x2, x3, x4) <span class="co"># 用這四組樣本建立一個 frame 變數 x14</span>
&gt;<span class="st"> </span>pr =<span class="st"> </span><span class="kw">princomp</span>(x14, <span class="dt">cor=</span><span class="ot">TRUE</span>) <span class="co"># 開始進行主成分分析</span>
&gt;<span class="st"> </span><span class="kw">summary</span>(pr, <span class="dt">loading=</span><span class="ot">TRUE</span>) <span class="co"># 顯示主成分分析的結果</span>
Importance of components:
<span class="st">                          </span>Comp<span class="fl">.1</span>    Comp<span class="fl">.2</span>       Comp<span class="fl">.3</span>       Comp<span class="fl">.4</span>
Standard deviation     <span class="fl">1.7281767</span> <span class="fl">1.0066803</span> <span class="fl">4.712161e-08</span> <span class="fl">8.339758e-09</span>
Proportion of Variance <span class="fl">0.7466487</span> <span class="fl">0.2533513</span> <span class="fl">5.551115e-16</span> <span class="fl">1.738789e-17</span>
Cumulative Proportion  <span class="fl">0.7466487</span> <span class="fl">1.0000000</span> <span class="fl">1.000000e+00</span> <span class="fl">1.000000e+00</span>

Loadings:
<span class="st">   </span>Comp<span class="fl">.1</span> Comp<span class="fl">.2</span> Comp<span class="fl">.3</span> Comp<span class="fl">.4</span>
x1 -<span class="fl">0.449</span>  <span class="fl">0.626</span>  <span class="fl">0.637</span>       
x2 -<span class="fl">0.367</span> -<span class="fl">0.768</span>  <span class="fl">0.495</span>  <span class="fl">0.176</span>
x3 -<span class="fl">0.576</span>        -<span class="fl">0.311</span> -<span class="fl">0.750</span>
x4 -<span class="fl">0.576</span>        -<span class="fl">0.502</span>  <span class="fl">0.638</span>
&gt;<span class="st"> </span></code></pre>
<p>在上述分析結果中，我們看到累積貢獻比率 (Cumulative Proportion) 在第一主成分 Comp.1 上為 0.7466487， 而累積到第二主成分 Comp.2 時就達到 1.0 了，這代表只要用兩個主成分就可以建構出整個樣本集合。</p>
<p>根據 Loadings 中的 Comp.1 那一列可知，第一主成分 Comp.1 = -0.449 x1 - 0.367 x2 - 0.576 x3 - 0.576 x4， 也就是我們用這個主成分就可以掌握整組資料的 7 成 (0.7466487)，而加上第二主成份 Comp.2 = 0.626 x1 - 0.768 x2 之後， 就可以掌握 100% 的資料，完全重建整個矩陣了。(因為這組資料的 rank 為 2)。</p>
<h2 id="主成分分析範例-2-rank3"><a href="#主成分分析範例-2-rank3">主成分分析範例 2 (Rank=3)</a></h2>
<p>為了驗證上述的「線性代數」想法，我們接著將 x3 改掉，成為獨立常態序列，然後讓 x4=3<em>x1+2</em>x2+x3，如下列程式所示。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x1=<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">1</span>) <span class="co"># x1 是常態分布隨機產生的 25 個樣本</span>
&gt;<span class="st"> </span>x2=<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">1</span>) <span class="co"># x2 是常態分布隨機產生的 25 個樣本</span>
&gt;<span class="st"> </span>x3=<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">1</span>) <span class="co"># x3 是常態分布隨機產生的 25 個樣本</span>
&gt;<span class="st"> </span>x4=<span class="dv">3</span>*x1<span class="dv">+2</span>*x2+x3            <span class="co"># x4=3*x1+2*x2+x3, 是 x1, x2, x3 的線性組合</span>
&gt;<span class="st"> </span>x14 =<span class="st"> </span><span class="kw">data.frame</span>(x1, x2, x3, x4) <span class="co"># 用這四組樣本建立一個 frame 變數 x14</span>
&gt;<span class="st"> </span>pr =<span class="st"> </span><span class="kw">princomp</span>(x14, <span class="dt">cor=</span><span class="ot">TRUE</span>) <span class="co"># 開始進行主成分分析</span>
&gt;<span class="st"> </span><span class="kw">summary</span>(pr, <span class="dt">loading=</span><span class="ot">TRUE</span>)<span class="er">)</span> <span class="co"># 顯示主成分分析的結果</span>
Importance of components:
<span class="st">                          </span>Comp<span class="fl">.1</span>    Comp<span class="fl">.2</span>   Comp<span class="fl">.3</span>       Comp<span class="fl">.4</span>
Standard deviation     <span class="fl">1.4659862</span> <span class="fl">1.1233489</span> <span class="fl">0.767445</span> <span class="fl">4.712161e-08</span>
Proportion of Variance <span class="fl">0.5372789</span> <span class="fl">0.3154782</span> <span class="fl">0.147243</span> <span class="fl">5.551115e-16</span>
Cumulative Proportion  <span class="fl">0.5372789</span> <span class="fl">0.8527570</span> <span class="fl">1.000000</span> <span class="fl">1.000000e+00</span>

Loadings:
<span class="st">   </span>Comp<span class="fl">.1</span> Comp<span class="fl">.2</span> Comp<span class="fl">.3</span> Comp<span class="fl">.4</span>
x1  <span class="fl">0.634</span>  <span class="fl">0.104</span>  <span class="fl">0.458</span>  <span class="fl">0.615</span>
x2  <span class="fl">0.310</span> -<span class="fl">0.669</span> -<span class="fl">0.625</span>  <span class="fl">0.259</span>
x3  <span class="fl">0.194</span>  <span class="fl">0.736</span> -<span class="fl">0.632</span>  <span class="fl">0.146</span>
x4  <span class="fl">0.682</span>               -<span class="fl">0.731</span></code></pre>
<p>您可以看到在下列的累積貢獻比率 (Cumulative Proportion) 當中，要到第三個主成分才到達 1.0，而非第二個主成分。</p>
<pre><code>Cumulative Proportion  0.5372789 0.8527570 1.000000 1.000000e+00</code></pre>
<p>而且在標準差 (Standard deviation) 與 變異比率 (Proportion of Variance) 上也反映了類似的情況，必須要到 Comp.4 的時候， 這兩個數值才會突然下降到幾近為 0 的程度 (4.712161e-08, 5.551115e-16)。</p>
<h2 id="主成分分析範例-3-rank3-加上隨機誤差"><a href="#主成分分析範例-3-rank3-加上隨機誤差">主成分分析範例 3 (Rank=3 加上隨機誤差)</a></h2>
<p>接著、讓我們為 x4 加上一點隨機誤差，看看主成分分析的結果會有何改變。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x1=<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">1</span>) <span class="co"># x1 是常態分布隨機產生的 25 個樣本</span>
&gt;<span class="st"> </span>x2=<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">1</span>) <span class="co"># x2 是常態分布隨機產生的 25 個樣本</span>
&gt;<span class="st"> </span>x3=<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">1</span>) <span class="co"># x3 是常態分布隨機產生的 25 個樣本</span>
&gt;<span class="st"> </span>x4=<span class="dv">3</span>*x1<span class="dv">+2</span>*x2+x3+<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">1</span>) <span class="co"># x4=3*x1+2*x2+x3, 是 x1, x2, x3 的線性組合加上常態隨機誤差</span>
&gt;<span class="st"> </span>x14 =<span class="st"> </span><span class="kw">data.frame</span>(x1, x2, x3, x4) <span class="co"># 用這四組樣本建立一個 frame 變數 x14</span>
&gt;<span class="st"> </span>pr =<span class="st"> </span><span class="kw">princomp</span>(x14, <span class="dt">cor=</span><span class="ot">TRUE</span>) <span class="co"># 開始進行主成分分析</span>
&gt;<span class="st"> </span><span class="kw">summary</span>(pr, <span class="dt">loading=</span><span class="ot">TRUE</span>)<span class="er">)</span> <span class="co"># 顯示主成分分析的結果</span>
Importance of components:
<span class="st">                          </span>Comp<span class="fl">.1</span>    Comp<span class="fl">.2</span>    Comp<span class="fl">.3</span>      Comp<span class="fl">.4</span>
Standard deviation     <span class="fl">1.4565751</span> <span class="fl">1.1233728</span> <span class="fl">0.7704314</span> <span class="fl">0.151189097</span>
Proportion of Variance <span class="fl">0.5304027</span> <span class="fl">0.3154916</span> <span class="fl">0.1483911</span> <span class="fl">0.005714536</span>
Cumulative Proportion  <span class="fl">0.5304027</span> <span class="fl">0.8458943</span> <span class="fl">0.9942855</span> <span class="fl">1.000000000</span>

Loadings:
<span class="st">   </span>Comp<span class="fl">.1</span> Comp<span class="fl">.2</span> Comp<span class="fl">.3</span> Comp<span class="fl">.4</span>
x1 -<span class="fl">0.642</span>  <span class="fl">0.117</span>  <span class="fl">0.410</span>  <span class="fl">0.637</span>
x2 -<span class="fl">0.306</span> -<span class="fl">0.662</span> -<span class="fl">0.645</span>  <span class="fl">0.228</span>
x3 -<span class="fl">0.173</span>  <span class="fl">0.740</span> -<span class="fl">0.641</span>  <span class="fl">0.103</span>
x4 -<span class="fl">0.681</span>               -<span class="fl">0.729</span>
&gt;<span class="st"> </span></code></pre>
<p>您可以看到在累積貢獻比率 (Cumulative Proportion) 當中，到了第三主成分時已經達到 99.4% (0.9942855)， 而到了第四主成分時才達到 100%，這代表若用前三個主成份重建仍然會有少許誤差。</p>
<pre><code>Cumulative Proportion  0.5304027 0.8458943 0.9942855 1.000000000</code></pre>
<p>上述的誤差量可以從標準差 (Standard deviation) 與 變異比率 (Proportion of Variance) 這兩組數字上看到。</p>
<pre><code>                          Comp.1    Comp.2    Comp.3      Comp.4
Standard deviation     1.4565751 1.1233728 0.7704314 0.151189097
Proportion of Variance 0.5304027 0.3154916 0.1483911 0.005714536</code></pre>
<h2 id="因子分析"><a href="#因子分析">因子分析</a></h2>
<p>另外、還有一個與主成分分析用法相當類似的方法，稱為因子分析 (Factor Analysis)，這種方法的使用與主成分分析 之差異點，在於必須指定要事先指定使用多少因子，如果使用的因子過多，則會導致失敗的結果。</p>
<p>以下是我們同樣針對上述範例所進行的因子分析結果，您可以發現在下列的分析中，只有指定一個因子的時候可以成功 的進行分析，而指定兩個以上的因子時，就會導致分析失敗的結果。</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x1=<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">1</span>) <span class="co"># x1 是常態分布隨機產生的 25 個樣本</span>
&gt;<span class="st"> </span>x2=<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">1</span>) <span class="co"># x2 是常態分布隨機產生的 25 個樣本</span>
&gt;<span class="st"> </span>x3=<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="dv">5</span>, <span class="dt">sd=</span><span class="dv">1</span>) <span class="co"># x3 是常態分布隨機產生的 25 個樣本</span>
&gt;<span class="st"> </span>x4=<span class="dv">3</span>*x1<span class="dv">+2</span>*x2+x3+<span class="kw">rnorm</span>(<span class="dv">25</span>, <span class="dt">mean=</span><span class="dv">0</span>, <span class="dt">sd=</span><span class="dv">1</span>) <span class="co"># x4=3*x1+2*x2+x3, 是 x1, x2, x3 的線性組合加上常態隨機誤差</span>
&gt;<span class="st"> </span>x14 =<span class="st"> </span><span class="kw">data.frame</span>(x1, x2, x3, x4) <span class="co"># 用這四組樣本建立一個 frame 變數 x14</span>
&gt;<span class="st"> </span>fa =<span class="st"> </span><span class="kw">factanal</span>(x14, <span class="dt">factors=</span><span class="dv">2</span>)
錯誤在<span class="kw">factanal</span>(x14, <span class="dt">factors =</span> <span class="dv">2</span>) :<span class="st"> </span>
<span class="st">  </span><span class="dv">2</span> factors is too many for <span class="dv">4</span> variables
&gt;<span class="st"> </span><span class="dt">fa =</span> <span class="kw">factanal</span>(x14, <span class="dt">factors=</span><span class="dv">1</span>)
&gt;<span class="st"> </span>fa

Call:
<span class="kw">factanal</span>(<span class="dt">x =</span> x14, <span class="dt">factors =</span> <span class="dv">1</span>)

Uniquenesses:
<span class="st">   </span>x1    x2    x3    x4 
<span class="fl">0.126</span> <span class="fl">0.834</span> <span class="fl">0.951</span> <span class="fl">0.005</span> 

Loadings:
<span class="st">   </span>Factor1
x1 <span class="fl">0.935</span>  
x2 <span class="fl">0.407</span>  
x3 <span class="fl">0.222</span>  
x4 <span class="fl">0.998</span>  

               Factor1
SS loadings      <span class="fl">2.084</span>
Proportion Var   <span class="fl">0.521</span>

Test of the hypothesis that <span class="dv">1</span> factor is sufficient.
The chi square statistic is <span class="fl">21.97</span> on <span class="dv">2</span> degrees of freedom.
The p-value is <span class="fl">1.7e-05</span> 
&gt;<span class="st"> </span><span class="dt">fa =</span> <span class="kw">factanal</span>(x14, <span class="dt">factors=</span><span class="dv">3</span>)
錯誤在<span class="kw">factanal</span>(x14, <span class="dt">factors =</span> <span class="dv">3</span>) :<span class="st"> </span>
<span class="st">  </span><span class="dv">3</span> factors is too many for <span class="dv">4</span> variables</code></pre>
<h2 id="結語-7"><a href="#結語-7">結語</a></h2>
<p>從主成分分析這個案例中，我們可以看到「機率統計」技術背後的原理，竟然是「線性代數」，數學果然是一門博大精深的學問啊！</p>
<p>事實上、上一期的「迴歸分析」主題，背後的原理乃是「最小平方法」，必須用到「微積分」與「線性代數」進行理論解釋。</p>
<p>我想、這也是為甚麼大學資工系的課程當中，「微積分、線性代數、離散數學、機率統計」通常是必修的原因啊！</p>
<h2 id="參考文獻-6"><a href="#參考文獻-6">參考文獻</a></h2>
<ul>
<li><a href="http://book.douban.com/subject/3337668/">R语言与统计分析</a>, 作者: 汤银才, ISBN: 9787040250626。</li>
</ul>
<h1 id="附錄-a常見的機率分布"><a href="#附錄-a常見的機率分布">附錄 A：常見的機率分布</a></h1>
<h2 id="二項分布-binomial-distribution-1"><a href="#二項分布-binomial-distribution-1">二項分布 (Binomial distribution)</a></h2>
<h3 id="伯努力試驗"><a href="#伯努力試驗">伯努力試驗</a></h3>
<p>伯努利試驗(Bernoulli trial) 一種只有兩種可能結果的隨機試驗，可以用下列機率分布描述：</p>
<div class="figure">
<img src="../timg/16a18c508788.jpg" />
</div>
<p>換句話說、伯努力試驗是一種 YES or NO (1 or 0) 的試驗。舉例而言，像是「丟銅版、生男生女、 一地區某天最高溫是否超過 30 度」等等，都可以用伯努力實驗描述。</p>
<h3 id="二項分布的意義"><a href="#二項分布的意義">二項分布的意義</a></h3>
<p>如果我們進行 n 次的伯努力試驗，而且這些試驗之間是獨立的，那麼我們就可以用二項分布來描述 n 次實驗的可能機率分布。</p>
<h3 id="二項分布公式"><a href="#二項分布公式">二項分布公式</a></h3>
<p>分布公式： <img src="../timg/7be6fde7a69a.jpg" /></p>
<p>意義：dbinom(x; n, p)：在 n 次柏努力試驗中有 x 次成功的機率 (已知單次試驗成功機率為 p)。</p>
<p>R 的公式：dbinom(x; n, p) = p(x) = choose(n,x) p^x (1-p)^(n-x)</p>
<ul>
<li>R 函數：binom(size=n:樣本數, prob=p:成功機率)</li>
<li><a href="http://stat.ethz.ch/R-manual/R-patched/library/stats/html/Binomial.html">http://stat.ethz.ch/R-manual/R-patched/library/stats/html/Binomial.html</a></li>
</ul>
<p>二項定理： <img src="../timg/ee857d255892.jpg" /></p>
<p>特性</p>
<ol style="list-style-type: decimal">
<li><img src="../timg/bc4e02b902b1.jpg" /></li>
<li><img src="../timg/b54416bd544b.jpg" title="fig:" /></li>
</ol>
<p>動差生成函數： <img src="../timg/526a680f0b7b.jpg" /></p>
<h3 id="習題-5"><a href="#習題-5">習題</a></h3>
<ol style="list-style-type: decimal">
<li>請問丟 10 個公平的銅板，有三個正面的機會是多少？</li>
<li>請問丟 n 個公平的銅板，正面次數 &lt;= k 的機率是多少？</li>
<li>請問丟 10 個公平的銅板，得到正面次數的期望值為何？</li>
</ol>
<h3 id="r-程式範例伯努力試驗"><a href="#r-程式範例伯努力試驗">R 程式範例：伯努力試驗</a></h3>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>y &lt;-<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">50</span>, <span class="dv">25</span>, .<span class="dv">4</span>)
&gt;<span class="st"> </span>m1 &lt;-<span class="st"> </span><span class="kw">mean</span>(y)
&gt;<span class="st"> </span>m2 &lt;-<span class="st"> </span><span class="kw">sum</span>(y) /<span class="st"> </span><span class="dv">25</span>
&gt;<span class="st"> </span>y
 [<span class="dv">1</span>] <span class="dv">12</span>  <span class="dv">9</span>  <span class="dv">9</span>  <span class="dv">9</span> <span class="dv">12</span> <span class="dv">11</span> <span class="dv">10</span> <span class="dv">11</span>  <span class="dv">5</span>  <span class="dv">7</span>  <span class="dv">8</span>  <span class="dv">7</span> <span class="dv">16</span>  <span class="dv">6</span> <span class="dv">12</span> <span class="dv">13</span>  <span class="dv">9</span> <span class="dv">12</span>  <span class="dv">9</span> <span class="dv">13</span>  <span class="dv">7</span> <span class="dv">12</span> <span class="dv">15</span>  <span class="dv">8</span>
[<span class="dv">25</span>]  <span class="dv">9</span>  <span class="dv">7</span> <span class="dv">10</span>  <span class="dv">4</span> <span class="dv">10</span> <span class="dv">10</span>  <span class="dv">9</span> <span class="dv">10</span> <span class="dv">13</span>  <span class="dv">8</span> <span class="dv">10</span> <span class="dv">14</span>  <span class="dv">8</span> <span class="dv">11</span> <span class="dv">11</span> <span class="dv">10</span> <span class="dv">10</span>  <span class="dv">9</span>  <span class="dv">7</span> <span class="dv">13</span>  <span class="dv">5</span>  <span class="dv">5</span> <span class="dv">11</span> <span class="dv">13</span>
[<span class="dv">49</span>]  <span class="dv">9</span>  <span class="dv">8</span>
&gt;<span class="st"> </span>m1
[<span class="dv">1</span>] <span class="fl">9.72</span>
&gt;<span class="st"> </span>m2
[<span class="dv">1</span>] <span class="fl">19.44</span>
&gt;<span class="st"> </span>m3 &lt;-<span class="st"> </span><span class="kw">sum</span> ( (y-m1)^<span class="dv">2</span> ) /<span class="st"> </span><span class="dv">50</span>
&gt;<span class="st"> </span>m3
[<span class="dv">1</span>] <span class="fl">6.8816</span>
&gt;<span class="st"> </span></code></pre>
<p>說明： y 中的每個數字，代表模擬投擲 25 次白努力試驗後，成功的次數有幾次。因此 rbinom(50, 25, .4) 總共進行了 50*25 次白努力試驗。</p>
<h3 id="r-程式範例二項分布曲線圖"><a href="#r-程式範例二項分布曲線圖">R 程式範例：二項分布曲線圖</a></h3>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>n=<span class="dv">10</span>; p=<span class="fl">0.3</span>; k=<span class="kw">seq</span>(<span class="dv">0</span>,n)
&gt;<span class="st"> </span><span class="kw">plot</span>(k, <span class="kw">dbinom</span>(k,n,p), <span class="dt">type=</span><span class="st">&#39;h&#39;</span>, <span class="dt">main=</span><span class="st">&#39;dbinom(0:20, n=10, p=0.3)&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;k&#39;</span>)
&gt;<span class="st"> </span></code></pre>
<div class="figure">
<img src="../img/dbinomPlot.jpg" alt="二項分布的圖形" /><p class="caption">二項分布的圖形</p>
</div>
<h3 id="r-程式範例定理-常態分配可用來逼近二項分布"><a href="#r-程式範例定理-常態分配可用來逼近二項分布">R 程式範例：(定理) 常態分配可用來逼近二項分布</a></h3>
<p>假如 n 夠大的話，通常只要 n*min(p, 1-p) &gt; 5 就可以採用下列逼近方式</p>
<div class="figure">
<img src="../timg/fb966d6547cb.jpg" />
</div>
<p>原始程式：</p>
<pre class="sourceCode R"><code class="sourceCode r">op=<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))
n=<span class="dv">3</span>; p=<span class="fl">0.3</span>; k=<span class="kw">seq</span>(<span class="dv">0</span>,n)
<span class="kw">plot</span>(k, <span class="kw">dbinom</span>(k,n,p), <span class="dt">type=</span><span class="st">&#39;h&#39;</span>, <span class="dt">main=</span><span class="st">&#39;dbinom(n=3, p=0.3)&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;k&#39;</span>)
<span class="kw">curve</span>(<span class="kw">dnorm</span>(x,n*p,<span class="kw">sqrt</span>(n*p*(<span class="dv">1</span>-p))), <span class="dt">add=</span>T, <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)

n=<span class="dv">5</span>; p=<span class="fl">0.3</span>; k=<span class="kw">seq</span>(<span class="dv">0</span>,n)
<span class="kw">plot</span>(k, <span class="kw">dbinom</span>(k,n,p), <span class="dt">type=</span><span class="st">&#39;h&#39;</span>, <span class="dt">main=</span><span class="st">&#39;dbinom(n=5, p=0.3)&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;k&#39;</span>)
<span class="kw">curve</span>(<span class="kw">dnorm</span>(x,n*p,<span class="kw">sqrt</span>(n*p*(<span class="dv">1</span>-p))), <span class="dt">add=</span>T, <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)

n=<span class="dv">10</span>; p=<span class="fl">0.3</span>; k=<span class="kw">seq</span>(<span class="dv">0</span>,n)
<span class="kw">plot</span>(k, <span class="kw">dbinom</span>(k,n,p), <span class="dt">type=</span><span class="st">&#39;h&#39;</span>, <span class="dt">main=</span><span class="st">&#39;dbinom(n=10, p=0.3)&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;k&#39;</span>)
<span class="kw">curve</span>(<span class="kw">dnorm</span>(x,n*p,<span class="kw">sqrt</span>(n*p*(<span class="dv">1</span>-p))), <span class="dt">add=</span>T, <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)

n=<span class="dv">100</span>; p=<span class="fl">0.3</span>; k=<span class="kw">seq</span>(<span class="dv">0</span>,n)
<span class="kw">plot</span>(k, <span class="kw">dbinom</span>(k,n,p), <span class="dt">type=</span><span class="st">&#39;h&#39;</span>, <span class="dt">main=</span><span class="st">&#39;dbinom(n=100, p=0.3)&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;k&#39;</span>)
<span class="kw">curve</span>(<span class="kw">dnorm</span>(x,n*p,<span class="kw">sqrt</span>(n*p*(<span class="dv">1</span>-p))), <span class="dt">add=</span>T, <span class="dt">col=</span><span class="st">&#39;blue&#39;</span>)</code></pre>
<p>輸出圖形：</p>
<div class="figure">
<img src="../img/dbinomPlot4.jpg" />
</div>
<h3 id="r-程式範例二項分布統計圖"><a href="#r-程式範例二項分布統計圖">R 程式範例：二項分布統計圖</a></h3>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x =<span class="st"> </span><span class="kw">rbinom</span>(<span class="dv">100000</span>, <span class="dv">100</span>, <span class="fl">0.8</span>)
&gt;<span class="st"> </span><span class="kw">hist</span>(x, <span class="dt">nclas=</span><span class="kw">max</span>(x)-<span class="kw">min</span>(x)+<span class="dv">1</span>)
&gt;<span class="st"> </span></code></pre>
<div class="figure">
<img src="../img/rbinomHist.jpg" />
</div>
<h3 id="參考文獻-7"><a href="#參考文獻-7">參考文獻</a></h3>
<ul>
<li>Distributions in the stats package -- <a href="http://stat.ethz.ch/R-manual/R-patched/library/stats/html/Distributions.html">http://stat.ethz.ch/R-manual/R-patched/library/stats/html/Distributions.html</a></li>
<li>Wikipedia:二項分佈 -- <a href="http://zh.wikipedia.org/wiki/%E4%BA%8C%E9%A0%85%E5%88%86%E4%BD%88">http://zh.wikipedia.org/wiki/%E4%BA%8C%E9%A0%85%E5%88%86%E4%BD%88</a></li>
<li>Wikipedia:Binomial_distribution -- <a href="http://en.wikipedia.org/wiki/Binomial_distribution">http://en.wikipedia.org/wiki/Binomial_distribution</a></li>
</ul>
<h2 id="負二項分布-netative-binomial-distribution"><a href="#負二項分布-netative-binomial-distribution">負二項分布 (Netative binomial distribution)</a></h2>
<p>公式： <img src="../timg/ac4a18c96a0b.jpg" /></p>
<p>範圍：r=1,2,3,.... ; x= r, r+1, r+2, ....</p>
<p>意義：要得到第 r 次成功所需要的試驗次數 x;</p>
<p>R 函數： nbinom(size, prob) ; r:size:成功數, p:prob:成功機率</p>
<ul>
<li><a href="http://stat.ethz.ch/R-manual/R-patched/library/stats/html/NegBinomial.html">http://stat.ethz.ch/R-manual/R-patched/library/stats/html/NegBinomial.html</a></li>
</ul>
<p>特性</p>
<ol style="list-style-type: decimal">
<li><img src="../timg/1ff0b1f39258.jpg" /></li>
<li><img src="../timg/933590aefdd6.jpg" title="fig:" /></li>
</ol>
<p>動差生成函數： <img src="../timg/bd10f9db1026.jpg" /></p>
<h3 id="習題-6"><a href="#習題-6">習題</a></h3>
<ol style="list-style-type: decimal">
<li><p>請問丟公平的銅板時，在得到第三次正面的要求下，其投擲次數 x 的機率分布為何？該分布的期望值為何？</p></li>
<li><p>請問丟公平的銅板時，在得到第 r 次正面的要求下，其投擲次數 x 的機率分布為何？該分布的期望值為何？</p></li>
</ol>
<h3 id="r-程式範例負二項分布曲線圖"><a href="#r-程式範例負二項分布曲線圖">R 程式範例：負二項分布曲線圖</a></h3>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>n=<span class="dv">20</span>; p=<span class="fl">0.4</span>; k=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">50</span>)
&gt;<span class="st"> </span><span class="kw">plot</span>(k, <span class="kw">dnbinom</span>(k,n,p), <span class="dt">type=</span><span class="st">&#39;h&#39;</span>, <span class="dt">main=</span><span class="st">&#39;dnbinom(k,n=20,p=0.4)&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;k&#39;</span>)
&gt;<span class="st">  </span></code></pre>
<div class="figure">
<img src="../img/dnbinomPlot.jpg" />
</div>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x =<span class="st"> </span><span class="kw">rnbinom</span>(<span class="dv">100000</span>, <span class="dv">100</span>, <span class="fl">0.8</span>)
&gt;<span class="st"> </span><span class="kw">hist</span>(x, <span class="dt">nclass=</span><span class="kw">max</span>(x)-<span class="kw">min</span>(x)+<span class="dv">1</span>)
&gt;<span class="st"> </span></code></pre>
<div class="figure">
<img src="../img/rnbinomHist.jpg" />
</div>
<h3 id="r-程式範例-進階"><a href="#r-程式範例-進階">R 程式範例 (進階)</a></h3>
<pre class="sourceCode R"><code class="sourceCode r"><span class="kw">require</span>(graphics)
x &lt;-<span class="st"> </span><span class="dv">0</span>:<span class="dv">11</span>
<span class="kw">dnbinom</span>(x, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="dv">1</span>/<span class="dv">2</span>) *<span class="st"> </span><span class="dv">2</span>^(<span class="dv">1</span> +<span class="st"> </span>x) <span class="co"># == 1</span>
<span class="dv">126</span> /<span class="st">  </span><span class="kw">dnbinom</span>(<span class="dv">0</span>:<span class="dv">8</span>, <span class="dt">size  =</span> <span class="dv">2</span>, <span class="dt">prob  =</span> <span class="dv">1</span>/<span class="dv">2</span>) <span class="co">#- theoretically integer</span>

## Cumulative (&#39;p&#39;) = Sum of discrete prob.s (&#39;d&#39;);  Relative error :
<span class="kw">summary</span>(<span class="dv">1</span> -<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">dnbinom</span>(x, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">prob =</span> <span class="dv">1</span>/<span class="dv">2</span>)) /
<span class="st">                  </span><span class="kw">pnbinom</span>(x, <span class="dt">size  =</span> <span class="dv">2</span>, <span class="dt">prob =</span> <span class="dv">1</span>/<span class="dv">2</span>))

x &lt;-<span class="st"> </span><span class="dv">0</span>:<span class="dv">15</span>
size &lt;-<span class="st"> </span>(<span class="dv">1</span>:<span class="dv">20</span>)/<span class="dv">4</span>
<span class="kw">persp</span>(x,size, dnb &lt;-<span class="st"> </span><span class="kw">outer</span>(x, size, function(x,s) <span class="kw">dnbinom</span>(x,s, <span class="dt">prob=</span> <span class="fl">0.4</span>)),
      <span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;s&quot;</span>, <span class="dt">zlab=</span><span class="st">&quot;density&quot;</span>, <span class="dt">theta =</span> <span class="dv">150</span>)
<span class="kw">title</span>(tit &lt;-<span class="st"> &quot;negative binomial density(x,s, pr = 0.4)  vs.  x &amp; s&quot;</span>)

<span class="kw">image</span>  (x,size, <span class="kw">log10</span>(dnb), <span class="dt">main=</span> <span class="kw">paste</span>(<span class="st">&quot;log [&quot;</span>,tit,<span class="st">&quot;]&quot;</span>))
<span class="kw">contour</span>(x,size, <span class="kw">log10</span>(dnb),<span class="dt">add=</span><span class="ot">TRUE</span>)

## Alternative parametrization
x1 &lt;-<span class="st"> </span><span class="kw">rnbinom</span>(<span class="dv">500</span>, <span class="dt">mu =</span> <span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">1</span>)
x2 &lt;-<span class="st"> </span><span class="kw">rnbinom</span>(<span class="dv">500</span>, <span class="dt">mu =</span> <span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">10</span>)
x3 &lt;-<span class="st"> </span><span class="kw">rnbinom</span>(<span class="dv">500</span>, <span class="dt">mu =</span> <span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">100</span>)
h1 &lt;-<span class="st"> </span><span class="kw">hist</span>(x1, <span class="dt">breaks =</span> <span class="dv">20</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>)
h2 &lt;-<span class="st"> </span><span class="kw">hist</span>(x2, <span class="dt">breaks =</span> h1$breaks, <span class="dt">plot =</span> <span class="ot">FALSE</span>)
h3 &lt;-<span class="st"> </span><span class="kw">hist</span>(x3, <span class="dt">breaks =</span> h1$breaks, <span class="dt">plot =</span> <span class="ot">FALSE</span>)
<span class="kw">barplot</span>(<span class="kw">rbind</span>(h1 ![](../timg/d7d2ac3ced7f.jpg) counts, h3$counts),
        <span class="dt">beside =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;cyan&quot;</span>),
        <span class="dt">names.arg =</span> <span class="kw">round</span>(h1 ![](../timg/728bbfdb9a46.jpg) breaks)])<span class="er">)</span></code></pre>
<p>執行結果：</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">require</span>(graphics)
&gt;<span class="st"> </span>x &lt;-<span class="st"> </span><span class="dv">0</span>:<span class="dv">11</span>
&gt;<span class="st"> </span><span class="kw">dnbinom</span>(x, <span class="dt">size =</span> <span class="dv">1</span>, <span class="dt">prob =</span> <span class="dv">1</span>/<span class="dv">2</span>) *<span class="st"> </span><span class="dv">2</span>^(<span class="dv">1</span> +<span class="st"> </span>x) <span class="co"># == 1</span>
 [<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span>
&gt;<span class="st"> </span><span class="dv">126</span> /<span class="st">  </span><span class="kw">dnbinom</span>(<span class="dv">0</span>:<span class="dv">8</span>, <span class="dt">size  =</span> <span class="dv">2</span>, <span class="dt">prob  =</span> <span class="dv">1</span>/<span class="dv">2</span>) <span class="co">#- theoretically integer</span>
[<span class="dv">1</span>]   <span class="fl">504.0</span>   <span class="fl">504.0</span>   <span class="fl">672.0</span>  <span class="fl">1008.0</span>  <span class="fl">1612.8</span>  <span class="fl">2688.0</span>  <span class="fl">4608.0</span>  <span class="fl">8064.0</span> <span class="fl">14336.0</span>
&gt;<span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>## Cumulative (&#39;p&#39;) = Sum of discrete prob.s (&#39;d&#39;);  Relative error :
<span class="er">&gt;</span><span class="st"> </span><span class="kw">summary</span>(<span class="dv">1</span> -<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">dnbinom</span>(x, <span class="dt">size =</span> <span class="dv">2</span>, <span class="dt">prob =</span> <span class="dv">1</span>/<span class="dv">2</span>)) /
+<span class="st">                   </span><span class="kw">pnbinom</span>(x, <span class="dt">size  =</span> <span class="dv">2</span>, <span class="dt">prob =</span> <span class="dv">1</span>/<span class="dv">2</span>))
     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. 
-<span class="fl">2.22e-16</span> -<span class="fl">2.22e-16</span> -<span class="fl">2.22e-16</span> -<span class="fl">1.48e-16</span>  <span class="fl">0.00e+00</span>  <span class="fl">0.00e+00</span> 
&gt;<span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>x &lt;-<span class="st"> </span><span class="dv">0</span>:<span class="dv">15</span>
&gt;<span class="st"> </span>size &lt;-<span class="st"> </span>(<span class="dv">1</span>:<span class="dv">20</span>)/<span class="dv">4</span>
&gt;<span class="st"> </span><span class="kw">persp</span>(x,size, dnb &lt;-<span class="st"> </span><span class="kw">outer</span>(x, size, function(x,s) <span class="kw">dnbinom</span>(x,s, <span class="dt">prob=</span> <span class="fl">0.4</span>)),
+<span class="st">       </span><span class="dt">xlab =</span> <span class="st">&quot;x&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;s&quot;</span>, <span class="dt">zlab=</span><span class="st">&quot;density&quot;</span>, <span class="dt">theta =</span> <span class="dv">150</span>)
&gt;<span class="st"> </span><span class="kw">title</span>(tit &lt;-<span class="st"> &quot;negative binomial density(x,s, pr = 0.4)  vs.  x &amp; s&quot;</span>)
&gt;<span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">image</span>  (x,size, <span class="kw">log10</span>(dnb), <span class="dt">main=</span> <span class="kw">paste</span>(<span class="st">&quot;log [&quot;</span>,tit,<span class="st">&quot;]&quot;</span>))
&gt;<span class="st"> </span><span class="kw">contour</span>(x,size, <span class="kw">log10</span>(dnb),<span class="dt">add=</span><span class="ot">TRUE</span>)
&gt;<span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>## Alternative parametrization
<span class="er">&gt;</span><span class="st"> </span>x1 &lt;-<span class="st"> </span><span class="kw">rnbinom</span>(<span class="dv">500</span>, <span class="dt">mu =</span> <span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">1</span>)
&gt;<span class="st"> </span>x2 &lt;-<span class="st"> </span><span class="kw">rnbinom</span>(<span class="dv">500</span>, <span class="dt">mu =</span> <span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">10</span>)
&gt;<span class="st"> </span>x3 &lt;-<span class="st"> </span><span class="kw">rnbinom</span>(<span class="dv">500</span>, <span class="dt">mu =</span> <span class="dv">4</span>, <span class="dt">size =</span> <span class="dv">100</span>)
&gt;<span class="st"> </span>h1 &lt;-<span class="st"> </span><span class="kw">hist</span>(x1, <span class="dt">breaks =</span> <span class="dv">20</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>)
&gt;<span class="st"> </span>h2 &lt;-<span class="st"> </span><span class="kw">hist</span>(x2, <span class="dt">breaks =</span> h1$breaks, <span class="dt">plot =</span> <span class="ot">FALSE</span>)
&gt;<span class="st"> </span>h3 &lt;-<span class="st"> </span><span class="kw">hist</span>(x3, <span class="dt">breaks =</span> h1$breaks, <span class="dt">plot =</span> <span class="ot">FALSE</span>)
&gt;<span class="st"> </span><span class="kw">barplot</span>(<span class="kw">rbind</span>(h1 ![](../timg/d7d2ac3ced7f.jpg) counts, h3$counts),
+<span class="st">         </span><span class="dt">beside =</span> <span class="ot">TRUE</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>,<span class="st">&quot;blue&quot;</span>,<span class="st">&quot;cyan&quot;</span>),
+<span class="st">         </span><span class="dt">names.arg =</span> <span class="kw">round</span>(h1 ![](../timg/728bbfdb9a46.jpg) breaks)])<span class="er">)</span></code></pre>
<p>繪圖結果：</p>
<div class="figure">
<img src="../img/nbinom.jpg" />
</div>
<h3 id="參考文獻-8"><a href="#參考文獻-8">參考文獻</a></h3>
<ul>
<li><a href="http://zh.wikipedia.org/wiki/%E8%B2%A0%E4%BA%8C%E9%A0%85%E5%88%86%E4%BD%88">Wikipedia:負二項分布</a></li>
<li><a href="http://en.wikipedia.org/wiki/Negative_binomial_distribution">Wikipedia:Negative_binomial_distribution</a></li>
</ul>
<h2 id="幾何分布-geometric-distribution-1"><a href="#幾何分布-geometric-distribution-1">幾何分布 (Geometric distribution)</a></h2>
<div class="figure">
<img src="../timg/4596a6c90794.jpg" />
</div>
<p>範圍：r=1,2,3,.... ; x= r, r+1, r+2, ....</p>
<p>意義：第一次成功所需要的試驗次數。</p>
<p>R 函數： geom(prob) ; p:prob:成功機率, x-1:size:失敗次數, q:失敗機率</p>
<ul>
<li>R 的公式： <img src="../timg/0d77b33676f5.jpg" /></li>
<li>R 當中的 x 代表失敗次數，而非第一次成功的次數，因此 R 當中的 x 相當於上式中的 (x-1)</li>
<li><a href="http://stat.ethz.ch/R-manual/R-patched/library/stats/html/Geometric.html">http://stat.ethz.ch/R-manual/R-patched/library/stats/html/Geometric.html</a></li>
</ul>
<p>特性：</p>
<ol style="list-style-type: decimal">
<li><img src="../timg/19aff995f75e.jpg" /></li>
<li><img src="../timg/9fb84c80d91d.jpg" title="fig:" /></li>
</ol>
<p>動差生成函數： <img src="../timg/e0090dd5a203.jpg" /></p>
<h3 id="習題-7"><a href="#習題-7">習題</a></h3>
<ol style="list-style-type: decimal">
<li><p>請問丟公平的銅板時，得到第 1 次正面時投擲次數 x 的機率分布為何？該分布的期望值為何？</p></li>
<li><p>請問丟公正的骰子時，得到第 1 次 6 點時投擲次數 x 的機率分布為何？該分布的期望值為何？</p></li>
</ol>
<h3 id="r-程式範例曲線圖"><a href="#r-程式範例曲線圖">R 程式範例：曲線圖</a></h3>
<pre class="sourceCode R"><code class="sourceCode r">p=<span class="fl">0.7</span>; k=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>)
<span class="kw">plot</span>(k, <span class="kw">dgeom</span>(k, p), <span class="dt">type=</span><span class="st">&#39;h&#39;</span>, <span class="dt">main=</span><span class="st">&#39;dgeom(p=0.5)&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;k&#39;</span>)</code></pre>
<p><a href="../img/dgeomPlot.jpg"></a></p>
<h3 id="r-程式範例"><a href="#r-程式範例">R 程式範例：</a></h3>
<pre class="sourceCode R"><code class="sourceCode r"><span class="kw">qgeom</span>((<span class="dv">1</span>:<span class="dv">9</span>)/<span class="dv">10</span>, <span class="dt">prob =</span> .<span class="dv">2</span>)
Ni &lt;-<span class="st"> </span><span class="kw">rgeom</span>(<span class="dv">20</span>, <span class="dt">prob =</span> <span class="dv">1</span>/<span class="dv">4</span>); <span class="kw">table</span>(<span class="kw">factor</span>(Ni, <span class="dv">0</span>:<span class="kw">max</span>(Ni)))</code></pre>
<p>執行結果：</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">qgeom</span>((<span class="dv">1</span>:<span class="dv">9</span>)/<span class="dv">10</span>, <span class="dt">prob =</span> .<span class="dv">2</span>)
[<span class="dv">1</span>]  <span class="dv">0</span>  <span class="dv">0</span>  <span class="dv">1</span>  <span class="dv">2</span>  <span class="dv">3</span>  <span class="dv">4</span>  <span class="dv">5</span>  <span class="dv">7</span> <span class="dv">10</span>
&gt;<span class="st"> </span>Ni &lt;-<span class="st"> </span><span class="kw">rgeom</span>(<span class="dv">20</span>, <span class="dt">prob =</span> <span class="dv">1</span>/<span class="dv">4</span>); <span class="kw">table</span>(<span class="kw">factor</span>(Ni, <span class="dv">0</span>:<span class="kw">max</span>(Ni)))

 <span class="dv">0</span>  <span class="dv">1</span>  <span class="dv">2</span>  <span class="dv">3</span>  <span class="dv">4</span>  <span class="dv">5</span>  <span class="dv">6</span>  <span class="dv">7</span>  <span class="dv">8</span>  <span class="dv">9</span> <span class="dv">10</span> <span class="dv">11</span> <span class="dv">12</span> <span class="dv">13</span> <span class="dv">14</span> <span class="dv">15</span> <span class="dv">16</span> <span class="dv">17</span> 
 <span class="dv">4</span>  <span class="dv">5</span>  <span class="dv">3</span>  <span class="dv">2</span>  <span class="dv">0</span>  <span class="dv">3</span>  <span class="dv">1</span>  <span class="dv">0</span>  <span class="dv">0</span>  <span class="dv">0</span>  <span class="dv">1</span>  <span class="dv">0</span>  <span class="dv">0</span>  <span class="dv">0</span>  <span class="dv">0</span>  <span class="dv">0</span>  <span class="dv">0</span>  <span class="dv">1</span> 
&gt;<span class="st"> </span></code></pre>
<h3 id="參考"><a href="#參考">參考</a></h3>
<ul>
<li><a href="http://zh.wikipedia.org/wiki/%E5%B9%BE%E4%BD%95%E5%88%86%E4%BD%88">Wikipedia:幾何分佈</a></li>
<li><a href="http://en.wikipedia.org/wiki/Geometric_distribution">Wikipedia:Geometric_distribution</a></li>
</ul>
<h2 id="超幾何分布-hypergeometric-distribution"><a href="#超幾何分布-hypergeometric-distribution">超幾何分布 (Hypergeometric distribution)</a></h2>
<div class="figure">
<img src="../timg/a6d8f069bf9d.jpg" />
</div>
<p>意義：N 個球中有白球有 r 個，黑球 N-r 個，取出 n 個球，其中有 x 個白球的機率; (取後不放回)</p>
<p>R 函數： hyper(m,n,k) = choose(m, x) choose(n, k-x) / choose(m+n, k)</p>
<ul>
<li>R 函數的意義：m+n 個球中有白球有 m 個，黑球 n 個，取出 k 個球，其中有 x 個白球的機率; (取後不放回)</li>
<li>R 的網址：http://stat.ethz.ch/R-manual/R-patched/library/stats/html/Hypergeometric.html</li>
<li>課本與 R 之間對應公式：N=&gt;m+n; n=&gt;k; r=&gt;m</li>
<li>R 的公式： <img src="../timg/f6f5ab119565.jpg" /></li>
</ul>
<p>特性</p>
<ol style="list-style-type: decimal">
<li><img src="../timg/dd9e9d127e70.jpg" /></li>
<li><img src="../timg/2256cd7515c8.jpg" title="fig:" /></li>
</ol>
<p>動差生成函數： <img src="../timg/7466dac38750.jpg" /></p>
<h3 id="r-程式範例曲線圖-1"><a href="#r-程式範例曲線圖-1">R 程式範例：曲線圖</a></h3>
<pre class="sourceCode R"><code class="sourceCode r">m=<span class="dv">10</span>; n=<span class="dv">5</span>; k=<span class="dv">8</span>
x=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">10</span>)
<span class="kw">plot</span>(x, <span class="kw">dhyper</span>(x, m, n, k), <span class="dt">type=</span><span class="st">&#39;h&#39;</span>, <span class="dt">main=</span><span class="st">&#39;dhyper(m=10,n=5,k=8)&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;x&#39;</span>)</code></pre>
<div class="figure">
<img src="../img/dhyperPlot.jpg" />
</div>
<h3 id="r-程式範例-1"><a href="#r-程式範例-1">R 程式範例：</a></h3>
<pre class="sourceCode R"><code class="sourceCode r">m &lt;-<span class="st"> </span><span class="dv">10</span>; n &lt;-<span class="st"> </span><span class="dv">7</span>; k &lt;-<span class="st"> </span><span class="dv">8</span>
x &lt;-<span class="st"> </span><span class="dv">0</span>:(k<span class="dv">+1</span>)
<span class="kw">rbind</span>(<span class="kw">phyper</span>(x, m, n, k), <span class="kw">dhyper</span>(x, m, n, k))
<span class="kw">all</span>(<span class="kw">phyper</span>(x, m, n, k) ==<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">dhyper</span>(x, m, n, k)))<span class="co"># FALSE</span>
## but error is very small:
<span class="kw">signif</span>(<span class="kw">phyper</span>(x, m, n, k) -<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">dhyper</span>(x, m, n, k)), <span class="dt">digits=</span><span class="dv">3</span>)</code></pre>
<p>執行結果：</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>m &lt;-<span class="st"> </span><span class="dv">10</span>; n &lt;-<span class="st"> </span><span class="dv">7</span>; k &lt;-<span class="st"> </span><span class="dv">8</span>
&gt;<span class="st"> </span>x &lt;-<span class="st"> </span><span class="dv">0</span>:(k<span class="dv">+1</span>)
&gt;<span class="st"> </span><span class="kw">rbind</span>(<span class="kw">phyper</span>(x, m, n, k), <span class="kw">dhyper</span>(x, m, n, k))
     [,<span class="dv">1</span>]         [,<span class="dv">2</span>]       [,<span class="dv">3</span>]     [,<span class="dv">4</span>]      [,<span class="dv">5</span>]      [,<span class="dv">6</span>]      [,<span class="dv">7</span>]
[<span class="dv">1</span>,]    <span class="dv">0</span> <span class="fl">0.0004113534</span> <span class="fl">0.01336898</span> <span class="fl">0.117030</span> <span class="fl">0.4193747</span> <span class="fl">0.7821884</span> <span class="fl">0.9635952</span>
[<span class="dv">2</span>,]    <span class="dv">0</span> <span class="fl">0.0004113534</span> <span class="fl">0.01295763</span> <span class="fl">0.103661</span> <span class="fl">0.3023447</span> <span class="fl">0.3628137</span> <span class="fl">0.1814068</span>
           [,<span class="dv">8</span>]       [,<span class="dv">9</span>] [,<span class="dv">10</span>]
[<span class="dv">1</span>,] <span class="fl">0.99814891</span> <span class="fl">1.00000000</span>     <span class="dv">1</span>
[<span class="dv">2</span>,] <span class="fl">0.03455368</span> <span class="fl">0.00185109</span>     <span class="dv">0</span>
&gt;<span class="st"> </span><span class="kw">all</span>(<span class="kw">phyper</span>(x, m, n, k) ==<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">dhyper</span>(x, m, n, k)))<span class="co"># FALSE</span>
[<span class="dv">1</span>] <span class="ot">FALSE</span>
&gt;<span class="st"> </span>## but error is very small:
<span class="er">&gt;</span><span class="st"> </span><span class="kw">signif</span>(<span class="kw">phyper</span>(x, m, n, k) -<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">dhyper</span>(x, m, n, k)), <span class="dt">digits=</span><span class="dv">3</span>)
 [<span class="dv">1</span>]  <span class="fl">0.00e+00</span>  <span class="fl">0.00e+00</span>  <span class="fl">1.73e-18</span>  <span class="fl">0.00e+00</span> -<span class="fl">5.55e-17</span>  <span class="fl">1.11e-16</span>  <span class="fl">2.22e-16</span>
 [<span class="dv">8</span>]  <span class="fl">2.22e-16</span>  <span class="fl">2.22e-16</span>  <span class="fl">2.22e-16</span>
&gt;<span class="st"> </span></code></pre>
<h3 id="參考文獻-9"><a href="#參考文獻-9">參考文獻</a></h3>
<ul>
<li><a href="http://zh.wikipedia.org/wiki/%E8%B6%85%E5%87%A0%E4%BD%95%E5%88%86%E5%B8%83">Wikipedia:超幾何分布</a></li>
<li><a href="http://en.wikipedia.org/wiki/Hypergeometric_distribution">Wikipedia:Hypergeometric_distribution</a></li>
</ul>
<h2 id="布瓦松分布-poisson-distribution-1"><a href="#布瓦松分布-poisson-distribution-1">布瓦松分布 (Poisson distribution)</a></h2>
<p>意義：在單位時間內，事件出現平均 λ 次的機率分布。</p>
<p>公式： <img src="../timg/0c930d2788b1.jpg" /></p>
<p>R 的公式： <img src="../timg/ca43e8b89676.jpg" /></p>
<p>R 函數：<a href="http://stat.ethz.ch/R-manual/R-patched/library/stats/html/Poisson.html">pois(λ:事件平均出現次數)</a></p>
<p>變數意義： <img src="../timg/c049e3fdcead.jpg" /></p>
<div class="figure">
<img src="../img/PoissonCurve.jpg" alt="圖、布瓦松分布來源：http://en.wikipedia.org/wiki/Poisson_distribution" /><p class="caption">圖、布瓦松分布<BR/>來源：<a href="http://en.wikipedia.org/wiki/Poisson_distribution">http://en.wikipedia.org/wiki/Poisson_distribution</a></p>
</div>
<p>特性：</p>
<p>布瓦松分布可以與泰勒展開式中的 Maclaurin 級數對映起來，所謂的 Maclaurin 級數就是泰勒展開式在 0 點的展開式。</p>
<blockquote>
<p>If the Taylor series is centered at zero, then that series is also called a Maclaurin series, named after the Scottish mathematician Colin Maclaurin, who made extensive use of this special case of Taylor series in the 18th century.</p>
</blockquote>
<div class="figure">
<img src="../timg/1ac4c638a017.jpg" />
</div>
<div class="figure">
<img src="../img/PoissonVsBinomial.jpg" alt="圖、布瓦松分布是二項分布 n 趨近無限大的極限情況來源：http://en.wikipedia.org/wiki/File:Binomial_versus_poisson.svg" /><p class="caption">圖、布瓦松分布是二項分布 n 趨近無限大的極限情況<BR/>來源：<a href="http://en.wikipedia.org/wiki/File:Binomial_versus_poisson.svg">http://en.wikipedia.org/wiki/File:Binomial_versus_poisson.svg</a></p>
</div>
<h3 id="布瓦松分配的公式來源"><a href="#布瓦松分配的公式來源">布瓦松分配的公式來源</a></h3>
<p>布瓦松分配可視為二項分配的極限形式，當 binom(n, p) 當中 n 趨近於無限大，而 p 非常小的時候，就會趨近布瓦松分配。</p>
<p>關鍵公式： <img src="../timg/f5c44c7b2ec9.jpg" /></p>
<p>證明過程：</p>
<p><img src="../timg/c1453b053b73.jpg" /> .</p>
<p><img src="../timg/6b58c105e8c3.jpg" /> .</p>
<p><img src="../timg/848edbaea265.jpg" /> .</p>
<p>其中的 An 趨近於 1 ，證明如下：</p>
<p><img src="../timg/08ef57551c17.jpg" /> .</p>
<p>期望值與變異數</p>
<ol style="list-style-type: decimal">
<li><img src="../timg/a7ee5299c8dd.jpg" /></li>
<li><img src="../timg/f6b3e210bca6.jpg" title="fig:" /></li>
</ol>
<p>動差生成函數： <img src="../timg/96fa85ea62fa.jpg" /></p>
<h3 id="習題-8"><a href="#習題-8">習題：</a></h3>
<p>習題：抽血時白血球數量的問題</p>
<blockquote>
<p>問題： 假如現在從你身上抽一滴血，請回答下列兩個問題。</p>
<ol style="list-style-type: decimal">
<li>請定義一個隨機變數 X 代表那滴血中的白血球數量。</li>
</ol>
<p>提示： 樣本空間 S = 此時此刻你身上的所有白血球 = {w1,w2,......,wn}</p>
<ol start="2" style="list-style-type: decimal">
<li>請算出一滴血液中有三顆白血球的機率，假設該滴血液占你總血量的 1/1000。</li>
</ol>
</blockquote>
<p>解答 1：</p>
<blockquote>
<p>X(A) = |A|</p>
<p>說明：</p>
<p>A 是一個事件，也就是白血球的樣本空間 S 的子集合，例如： A = {w1, w5, w9}</p>
<p>|A| 代表 A 集合的大小，也就是元素個數，舉例而言：</p>
<p>如果 A = {w1, w5, w9} ，那麼 |A| = 3</p>
<p>如果 B = {w2, w8}，那麼 |B| = 2</p>
<p>如果 C = {}，那麼 |C| = 0</p>
<p>如果 D = S，那麼 |D| = n</p>
</blockquote>
<p>解答 2：</p>
<blockquote>
<p>P(X=3) = P({A | X(A) = 3}) = P({{w1, w2, w3}) + P({w1, w2, w4}) + ......</p>
<p>假如任一顆白血球被抽到的機率等於該滴血液佔全身血液的比率，由於該滴血液佔總血量的 1/1000，所以給顆白血球被抽到的機率為 1/1000。</p>
<p>而且假設這些白血球沒有智慧，也不會聚合在一起，因此相互之間獨立，那麼由於每顆白血球被抽到的機率為 1/1000，因此 P(w1) = P(w2) = .... P(wn) = 1/1000。</p>
<p>那麼初步想法是 P(w1w3) = P(w1) * P(w3) = 1/1000 * 1/1000 。</p>
<p>但是上述的想法有個小問題，那就是該情況代表其它白血球都沒被抽到，因此所謂的 P(w1w3) 真正的意思應該是</p>
<div class="figure">
<img src="../timg/29e439b8a536.jpg" />
</div>
<p>所以 P(X=3) 應該算法如下：</p>
<div class="figure">
<img src="../timg/960d1fb7e15e.jpg" />
</div>
<p>推而廣之，P(X=k) 的機率之算法如下：</p>
<div class="figure">
<img src="../timg/c103f4ae13f5.jpg" />
</div>
<p>事實上，這個題目的機率分布就是下一章的二項分布，如下所示：</p>
<div class="figure">
<img src="../timg/c9c2c2819c48.jpg" />
</div>
<p>而且、當 n 趨近於無限大時，這個分布將會趨近於布瓦松分布，如下所示：</p>
<div class="figure">
<img src="../timg/9fde5316116c.jpg" />
</div>
<p>其中的 λ 之意義為，在單位時間 (或單位面積、體積) 內，事件的出現次數平均為 λ 次。</p>
</blockquote>
<p>習題：假設每 1CC 的血所含的白血球平均為 10 顆，那麼請問你抽 1CC 的血時，抽到 8 顆白血球的機率是多少。</p>
<p>解答：</p>
<blockquote>
<p>λ = 10，因此布瓦松分布為 <img src="../timg/ce3620ab8f85.jpg" /> ，將 x=8 代入，得到 <img src="../timg/bce69f5aeddf.jpg" /></p>
</blockquote>
<p>其數值可以用 R 軟體計算，如下所示：</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>?dpois
&gt;<span class="st"> </span><span class="kw">dpois</span>(<span class="dv">8</span>, <span class="dv">10</span>)
[<span class="dv">1</span>] <span class="fl">0.112599</span>
&gt;<span class="st"> </span><span class="dv">10</span>^<span class="dv">8</span>*<span class="kw">exp</span>(-<span class="dv">10</span>)/<span class="kw">prod</span>(<span class="dv">1</span>:<span class="dv">8</span>)
[<span class="dv">1</span>] <span class="fl">0.112599</span></code></pre>
<h3 id="r-程式範例曲線圖-2"><a href="#r-程式範例曲線圖-2">R 程式範例：曲線圖</a></h3>
<pre class="sourceCode R"><code class="sourceCode r">lambda=<span class="fl">5.0</span>; k=<span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>); 
<span class="kw">plot</span>(k, <span class="kw">dpois</span>(k, lambda), <span class="dt">type=</span><span class="st">&#39;h&#39;</span>, <span class="dt">main=</span><span class="st">&#39;dpois(lambda=4.0)&#39;</span>, <span class="dt">xlab=</span><span class="st">&#39;k&#39;</span>)</code></pre>
<div class="figure">
<img src="../img/dpoisPlot.jpg" />
</div>
<h3 id="r-程式範例-2"><a href="#r-程式範例-2">R 程式範例：</a></h3>
<pre class="sourceCode R"><code class="sourceCode r"><span class="kw">require</span>(graphics)

-<span class="kw">log</span>(<span class="kw">dpois</span>(<span class="dv">0</span>:<span class="dv">7</span>, <span class="dt">lambda=</span><span class="dv">1</span>) *<span class="st"> </span><span class="kw">gamma</span>(<span class="dv">1</span>+<span class="st"> </span><span class="dv">0</span>:<span class="dv">7</span>)) <span class="co"># == 1</span>
Ni &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dv">50</span>, <span class="dt">lambda =</span> <span class="dv">4</span>); <span class="kw">table</span>(<span class="kw">factor</span>(Ni, <span class="dv">0</span>:<span class="kw">max</span>(Ni)))

<span class="dv">1</span> -<span class="st"> </span><span class="kw">ppois</span>(<span class="dv">10</span>*(<span class="dv">15</span>:<span class="dv">25</span>), <span class="dt">lambda=</span><span class="dv">100</span>)  <span class="co"># becomes 0 (cancellation)</span>
    <span class="kw">ppois</span>(<span class="dv">10</span>*(<span class="dv">15</span>:<span class="dv">25</span>), <span class="dt">lambda=</span><span class="dv">100</span>, <span class="dt">lower.tail=</span><span class="ot">FALSE</span>)  <span class="co"># no cancellation</span>

<span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))
x &lt;-<span class="st"> </span><span class="kw">seq</span>(-<span class="fl">0.01</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)
<span class="kw">plot</span>(x, <span class="kw">ppois</span>(x, <span class="dv">1</span>), <span class="dt">type=</span><span class="st">&quot;s&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;F(x)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Poisson(1) CDF&quot;</span>)
<span class="kw">plot</span>(x, <span class="kw">pbinom</span>(x, <span class="dv">100</span>, <span class="fl">0.01</span>),<span class="dt">type=</span><span class="st">&quot;s&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;F(x)&quot;</span>,
     <span class="dt">main=</span><span class="st">&quot;Binomial(100, 0.01) CDF&quot;</span>)</code></pre>
<p>執行結果：</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">require</span>(graphics)
&gt;<span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span>-<span class="kw">log</span>(<span class="kw">dpois</span>(<span class="dv">0</span>:<span class="dv">7</span>, <span class="dt">lambda=</span><span class="dv">1</span>) *<span class="st"> </span><span class="kw">gamma</span>(<span class="dv">1</span>+<span class="st"> </span><span class="dv">0</span>:<span class="dv">7</span>)) <span class="co"># == 1</span>
[<span class="dv">1</span>] <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span> <span class="dv">1</span>
&gt;<span class="st"> </span>Ni &lt;-<span class="st"> </span><span class="kw">rpois</span>(<span class="dv">50</span>, <span class="dt">lambda =</span> <span class="dv">4</span>); <span class="kw">table</span>(<span class="kw">factor</span>(Ni, <span class="dv">0</span>:<span class="kw">max</span>(Ni)))

 <span class="dv">0</span>  <span class="dv">1</span>  <span class="dv">2</span>  <span class="dv">3</span>  <span class="dv">4</span>  <span class="dv">5</span>  <span class="dv">6</span>  <span class="dv">7</span>  <span class="dv">8</span> 
 <span class="dv">1</span>  <span class="dv">3</span>  <span class="dv">6</span>  <span class="dv">8</span> <span class="dv">11</span> <span class="dv">11</span>  <span class="dv">4</span>  <span class="dv">3</span>  <span class="dv">3</span> 
&gt;<span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="dv">1</span> -<span class="st"> </span><span class="kw">ppois</span>(<span class="dv">10</span>*(<span class="dv">15</span>:<span class="dv">25</span>), <span class="dt">lambda=</span><span class="dv">100</span>)  <span class="co"># becomes 0 (cancellation)</span>
 [<span class="dv">1</span>] <span class="fl">1.233094e-06</span> <span class="fl">1.261664e-08</span> <span class="fl">7.085799e-11</span> <span class="fl">2.252643e-13</span> <span class="fl">4.440892e-16</span>
 [<span class="dv">6</span>] <span class="fl">0.000000e+00</span> <span class="fl">0.000000e+00</span> <span class="fl">0.000000e+00</span> <span class="fl">0.000000e+00</span> <span class="fl">0.000000e+00</span>
[<span class="dv">11</span>] <span class="fl">0.000000e+00</span>
&gt;<span class="st">     </span><span class="kw">ppois</span>(<span class="dv">10</span>*(<span class="dv">15</span>:<span class="dv">25</span>), <span class="dt">lambda=</span><span class="dv">100</span>, <span class="dt">lower.tail=</span><span class="ot">FALSE</span>)  <span class="co"># no cancellation</span>
 [<span class="dv">1</span>] <span class="fl">1.233094e-06</span> <span class="fl">1.261664e-08</span> <span class="fl">7.085800e-11</span> <span class="fl">2.253110e-13</span> <span class="fl">4.174239e-16</span>
 [<span class="dv">6</span>] <span class="fl">4.626179e-19</span> <span class="fl">3.142097e-22</span> <span class="fl">1.337219e-25</span> <span class="fl">3.639328e-29</span> <span class="fl">6.453883e-33</span>
[<span class="dv">11</span>] <span class="fl">7.587807e-37</span>
&gt;<span class="st"> </span>
<span class="er">&gt;</span><span class="st"> </span><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">1</span>))
&gt;<span class="st"> </span>x &lt;-<span class="st"> </span><span class="kw">seq</span>(-<span class="fl">0.01</span>, <span class="dv">5</span>, <span class="fl">0.01</span>)
&gt;<span class="st"> </span><span class="kw">plot</span>(x, <span class="kw">ppois</span>(x, <span class="dv">1</span>), <span class="dt">type=</span><span class="st">&quot;s&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;F(x)&quot;</span>, <span class="dt">main=</span><span class="st">&quot;Poisson(1) CDF&quot;</span>)
&gt;<span class="st"> </span><span class="kw">plot</span>(x, <span class="kw">pbinom</span>(x, <span class="dv">100</span>, <span class="fl">0.01</span>),<span class="dt">type=</span><span class="st">&quot;s&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;F(x)&quot;</span>,
+<span class="st">      </span><span class="dt">main=</span><span class="st">&quot;Binomial(100, 0.01) CDF&quot;</span>)
&gt;<span class="st"> </span></code></pre>
<div class="figure">
<img src="../img/poisson.jpg" />
</div>
<h3 id="參考文獻-10"><a href="#參考文獻-10">參考文獻</a></h3>
<ul>
<li><a href="http://zh.wikipedia.org/wiki/%E5%8D%9C%E7%93%A6%E6%9D%BE%E5%88%86%E4%BD%88">Wikipedia:卜瓦松分佈</a></li>
<li><a href="http://en.wikipedia.org/wiki/Poisson_distribution">Wikipedia:Poisson_distribution</a></li>
</ul>
<h2 id="均勻分布-uniform-distribution-1"><a href="#均勻分布-uniform-distribution-1">均勻分布 (Uniform distribution)</a></h2>
<p>意義：在範圍 (a,b) 內的出現機會均等。</p>
<p>R 函數：<a href="http://sites.stat.psu.edu/~dhunter/R/html/stats/html/Uniform.html">unif(a:min, b:max)</a></p>
<p>課本公式： <img src="../timg/e8ca13ccc43f.jpg" /></p>
<p>R 的公式：f(x) = 1/(max-min)</p>
<p>變數意義：a:min 範圍下限, b:max 上限</p>
<h3 id="r-程式範例-3"><a href="#r-程式範例-3">R 程式範例</a></h3>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>op=<span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))
&gt;<span class="st"> </span><span class="kw">curve</span>(<span class="kw">dunif</span>(x, <span class="dv">0</span>, <span class="dv">1</span>), -<span class="dv">2</span>, <span class="dv">10</span>)
&gt;<span class="st"> </span><span class="kw">curve</span>(<span class="kw">dunif</span>(x, <span class="dv">1</span>, <span class="dv">5</span>), -<span class="dv">2</span>, <span class="dv">10</span>)
&gt;<span class="st"> </span><span class="kw">curve</span>(<span class="kw">dunif</span>(x, -<span class="dv">1</span>, <span class="dv">9</span>), -<span class="dv">2</span>, <span class="dv">10</span>)
&gt;<span class="st"> </span><span class="kw">curve</span>(<span class="kw">dunif</span>(x, <span class="dv">10</span>, <span class="dv">110</span>), <span class="dv">0</span>, <span class="dv">200</span>)
&gt;</code></pre>
<p><a href="../img/dunifCurve4.jpg"></a></p>
<h2 id="常態分布-normal-distribution-1"><a href="#常態分布-normal-distribution-1">常態分布 (Normal Distribution)</a></h2>
<p>意義：有誤差的對稱性分布形式，中央高兩邊低的形式。</p>
<p>繪圖：用 R 繪製標準差為 1, 2, 3, 的常態分布。</p>
<pre class="sourceCode R"><code class="sourceCode r"><span class="kw">curve</span>(<span class="kw">dnorm</span>(x), -<span class="dv">5</span>, <span class="dv">5</span>, <span class="dt">col=</span><span class="st">&quot;black&quot;</span>)
<span class="kw">curve</span>(<span class="kw">dnorm</span>(x, <span class="dt">sd=</span><span class="dv">2</span>), -<span class="dv">5</span>, <span class="dv">5</span>, <span class="dt">col=</span><span class="st">&quot;blue&quot;</span>, <span class="dt">add=</span>T)
<span class="kw">curve</span>(<span class="kw">dnorm</span>(x, <span class="dt">sd=</span><span class="dv">3</span>), -<span class="dv">5</span>, <span class="dv">5</span>, <span class="dt">col=</span><span class="st">&quot;green&quot;</span>, <span class="dt">add=</span>T)</code></pre>
<div class="figure">
<img src="../img/normal3.jpg" />
</div>
<p>R 函數：<a href="http://stat.ethz.ch/R-manual/R-patched/library/stats/html/Normal.html">norm(mean, sd)</a></p>
<p>公式： <img src="../timg/b0aca724e39e.jpg" /></p>
<p>R 的公式：f(x) = 1/(√(2 π) σ) e^-((x - μ)^2/(2 σ^2))</p>
<p>重要性：根據中央極限定理，任何 n 個獨立樣本的平均值趨近於常態分布。</p>
<p>中央極限定理： <img src="../timg/7c727498181a.jpg" /></p>
<h3 id="標準差"><a href="#標準差">標準差</a></h3>
<p>1 標準差： <img src="../timg/9c0690deaf54.jpg" /> .</p>
<p>2 標準差： <img src="../timg/318b64e6a167.jpg" /> .</p>
<p>3 標準差： <img src="../timg/2b9593bad9ca.jpg" /> .</p>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">1</span>)-<span class="kw">pnorm</span>(-<span class="dv">1</span>)
[<span class="dv">1</span>] <span class="fl">0.6826895</span>
&gt;<span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">2</span>)-<span class="kw">pnorm</span>(-<span class="dv">2</span>)
[<span class="dv">1</span>] <span class="fl">0.9544997</span>
&gt;<span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">3</span>)-<span class="kw">pnorm</span>(-<span class="dv">3</span>)
[<span class="dv">1</span>] <span class="fl">0.9973002</span>
&gt;<span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">4</span>)-<span class="kw">pnorm</span>(-<span class="dv">4</span>)
[<span class="dv">1</span>] <span class="fl">0.9999367</span>
&gt;<span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">5</span>)-<span class="kw">pnorm</span>(-<span class="dv">5</span>)
[<span class="dv">1</span>] <span class="fl">0.9999994</span>
&gt;<span class="st"> </span><span class="kw">pnorm</span>(<span class="dv">6</span>)-<span class="kw">pnorm</span>(-<span class="dv">6</span>)
[<span class="dv">1</span>] <span class="dv">1</span></code></pre>
<p>所以現在大家應該知道「工業管理學」上「六標準差」的要求，是很嚴苛的了吧！</p>
<h3 id="r-程式範例-4"><a href="#r-程式範例-4">R 程式範例</a></h3>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span><span class="kw">dnorm</span>(<span class="dv">0</span>)
[<span class="dv">1</span>] <span class="fl">0.3989423</span>
&gt;<span class="st"> </span><span class="kw">dnorm</span>(<span class="fl">0.5</span>)
[<span class="dv">1</span>] <span class="fl">0.3520653</span>
&gt;<span class="st"> </span><span class="kw">dnorm</span>(<span class="fl">2.5</span>)
[<span class="dv">1</span>] <span class="fl">0.0175283</span>
&gt;<span class="st"> </span><span class="kw">curve</span>(<span class="kw">dnorm</span>(x), <span class="dt">from =</span> -<span class="fl">3.5</span>, <span class="dt">to =</span> <span class="fl">3.5</span>, <span class="dt">ylab=</span><span class="st">&quot;pdf&quot;</span>, <span class="dt">main=</span><span class="st">&quot;N(0,1)&quot;</span>)
&gt;<span class="st"> </span></code></pre>
<div class="figure">
<img src="../img/norm_curve.jpg" />
</div>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)
&gt;<span class="st"> </span><span class="kw">hist</span>(x, <span class="dt">nclass=</span><span class="dv">8</span>)
&gt;<span class="st"> </span></code></pre>
<div class="figure">
<img src="../img/norm_hist.jpg" />
</div>
<pre class="sourceCode R"><code class="sourceCode r">&gt;<span class="st"> </span>x =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>)
&gt;<span class="st"> </span><span class="kw">hist</span>(x, <span class="dt">nclass=</span><span class="dv">50</span>)
&gt;<span class="st"> </span></code></pre>
<div class="figure">
<img src="../img/norm_hist2.jpg" />
</div>
</div>
<div id="footer">
<a href="http://ccckmit.wikidot.com">陳鍾誠</a>衍生自<a href="http://zh.wikipedia.org/">維基百科</a>之作品：採用 <a href="http://creativecommons.org/licenses/by-sa/3.0/tw/ ">創作共用：姓名標示、相同方式分享</a> 的 <a href="license.html">授權方式</a>。
</div>
</body>
</html>
